<!DOCTYPE html>
<html lang="" xml:lang="">
<head>

  <meta charset="utf-8" />
  <meta http-equiv="X-UA-Compatible" content="IE=edge" />
  <title>Chapter 17 Bayesian inference | Principles of Uncertainty – exercises</title>
  <meta name="description" content="Course notes" />
  <meta name="generator" content="bookdown 0.35 and GitBook 2.6.7" />

  <meta property="og:title" content="Chapter 17 Bayesian inference | Principles of Uncertainty – exercises" />
  <meta property="og:type" content="book" />
  
  <meta property="og:description" content="Course notes" />
  

  <meta name="twitter:card" content="summary" />
  <meta name="twitter:title" content="Chapter 17 Bayesian inference | Principles of Uncertainty – exercises" />
  
  <meta name="twitter:description" content="Course notes" />
  

<meta name="author" content="Gregor Pirš and Erik Štrumbelj" />


<meta name="date" content="2023-09-25" />

  <meta name="viewport" content="width=device-width, initial-scale=1" />
  <meta name="apple-mobile-web-app-capable" content="yes" />
  <meta name="apple-mobile-web-app-status-bar-style" content="black" />
  
  
<link rel="prev" href="nhst.html"/>
<link rel="next" href="distributions-intutition.html"/>
<script src="libs/jquery-3.6.0/jquery-3.6.0.min.js"></script>
<script src="https://cdn.jsdelivr.net/npm/fuse.js@6.4.6/dist/fuse.min.js"></script>
<link href="libs/gitbook-2.6.7/css/style.css" rel="stylesheet" />
<link href="libs/gitbook-2.6.7/css/plugin-table.css" rel="stylesheet" />
<link href="libs/gitbook-2.6.7/css/plugin-bookdown.css" rel="stylesheet" />
<link href="libs/gitbook-2.6.7/css/plugin-highlight.css" rel="stylesheet" />
<link href="libs/gitbook-2.6.7/css/plugin-search.css" rel="stylesheet" />
<link href="libs/gitbook-2.6.7/css/plugin-fontsettings.css" rel="stylesheet" />
<link href="libs/gitbook-2.6.7/css/plugin-clipboard.css" rel="stylesheet" />








<link href="libs/anchor-sections-1.1.0/anchor-sections.css" rel="stylesheet" />
<link href="libs/anchor-sections-1.1.0/anchor-sections-hash.css" rel="stylesheet" />
<script src="libs/anchor-sections-1.1.0/anchor-sections.js"></script>


<style type="text/css">
pre > code.sourceCode { white-space: pre; position: relative; }
pre > code.sourceCode > span { display: inline-block; line-height: 1.25; }
pre > code.sourceCode > span:empty { height: 1.2em; }
.sourceCode { overflow: visible; }
code.sourceCode > span { color: inherit; text-decoration: inherit; }
pre.sourceCode { margin: 0; }
@media screen {
div.sourceCode { overflow: auto; }
}
@media print {
pre > code.sourceCode { white-space: pre-wrap; }
pre > code.sourceCode > span { text-indent: -5em; padding-left: 5em; }
}
pre.numberSource code
  { counter-reset: source-line 0; }
pre.numberSource code > span
  { position: relative; left: -4em; counter-increment: source-line; }
pre.numberSource code > span > a:first-child::before
  { content: counter(source-line);
    position: relative; left: -1em; text-align: right; vertical-align: baseline;
    border: none; display: inline-block;
    -webkit-touch-callout: none; -webkit-user-select: none;
    -khtml-user-select: none; -moz-user-select: none;
    -ms-user-select: none; user-select: none;
    padding: 0 4px; width: 4em;
    color: #aaaaaa;
  }
pre.numberSource { margin-left: 3em; border-left: 1px solid #aaaaaa;  padding-left: 4px; }
div.sourceCode
  {   }
@media screen {
pre > code.sourceCode > span > a:first-child::before { text-decoration: underline; }
}
code span.al { color: #ff0000; font-weight: bold; } /* Alert */
code span.an { color: #60a0b0; font-weight: bold; font-style: italic; } /* Annotation */
code span.at { color: #7d9029; } /* Attribute */
code span.bn { color: #40a070; } /* BaseN */
code span.bu { color: #008000; } /* BuiltIn */
code span.cf { color: #007020; font-weight: bold; } /* ControlFlow */
code span.ch { color: #4070a0; } /* Char */
code span.cn { color: #880000; } /* Constant */
code span.co { color: #60a0b0; font-style: italic; } /* Comment */
code span.cv { color: #60a0b0; font-weight: bold; font-style: italic; } /* CommentVar */
code span.do { color: #ba2121; font-style: italic; } /* Documentation */
code span.dt { color: #902000; } /* DataType */
code span.dv { color: #40a070; } /* DecVal */
code span.er { color: #ff0000; font-weight: bold; } /* Error */
code span.ex { } /* Extension */
code span.fl { color: #40a070; } /* Float */
code span.fu { color: #06287e; } /* Function */
code span.im { color: #008000; font-weight: bold; } /* Import */
code span.in { color: #60a0b0; font-weight: bold; font-style: italic; } /* Information */
code span.kw { color: #007020; font-weight: bold; } /* Keyword */
code span.op { color: #666666; } /* Operator */
code span.ot { color: #007020; } /* Other */
code span.pp { color: #bc7a00; } /* Preprocessor */
code span.sc { color: #4070a0; } /* SpecialChar */
code span.ss { color: #bb6688; } /* SpecialString */
code span.st { color: #4070a0; } /* String */
code span.va { color: #19177c; } /* Variable */
code span.vs { color: #4070a0; } /* VerbatimString */
code span.wa { color: #60a0b0; font-weight: bold; font-style: italic; } /* Warning */
</style>

<style type="text/css">
  
  div.hanging-indent{margin-left: 1.5em; text-indent: -1.5em;}
</style>
<style type="text/css">
/* Used with Pandoc 2.11+ new --citeproc when CSL is used */
div.csl-bib-body { }
div.csl-entry {
  clear: both;
}
.hanging div.csl-entry {
  margin-left:2em;
  text-indent:-2em;
}
div.csl-left-margin {
  min-width:2em;
  float:left;
}
div.csl-right-inline {
  margin-left:2em;
  padding-left:1em;
}
div.csl-indent {
  margin-left: 2em;
}
</style>

<link rel="stylesheet" href="style.css" type="text/css" />
</head>

<body>



  <div class="book without-animation with-summary font-size-2 font-family-1" data-basepath=".">

    <div class="book-summary">
      <nav role="navigation">

<ul class="summary">
<li><a href="./">Principles of uncertainty</a></li>

<li class="divider"></li>
<li class="chapter" data-level="" data-path="index.html"><a href="index.html"><i class="fa fa-check"></i>Preface</a></li>
<li class="chapter" data-level="1" data-path="introduction.html"><a href="introduction.html"><i class="fa fa-check"></i><b>1</b> Probability spaces</a>
<ul>
<li class="chapter" data-level="1.1" data-path="introduction.html"><a href="introduction.html#measure-and-probability-spaces"><i class="fa fa-check"></i><b>1.1</b> Measure and probability spaces</a></li>
<li class="chapter" data-level="1.2" data-path="introduction.html"><a href="introduction.html#properties-of-probability-measures"><i class="fa fa-check"></i><b>1.2</b> Properties of probability measures</a></li>
<li class="chapter" data-level="1.3" data-path="introduction.html"><a href="introduction.html#discrete-probability-spaces"><i class="fa fa-check"></i><b>1.3</b> Discrete probability spaces</a></li>
</ul></li>
<li class="chapter" data-level="2" data-path="uprobspaces.html"><a href="uprobspaces.html"><i class="fa fa-check"></i><b>2</b> Uncountable probability spaces</a>
<ul>
<li class="chapter" data-level="2.1" data-path="uprobspaces.html"><a href="uprobspaces.html#bset"><i class="fa fa-check"></i><b>2.1</b> Borel sets</a></li>
<li class="chapter" data-level="2.2" data-path="uprobspaces.html"><a href="uprobspaces.html#lebesgue-measure"><i class="fa fa-check"></i><b>2.2</b> Lebesgue measure</a></li>
</ul></li>
<li class="chapter" data-level="3" data-path="condprob.html"><a href="condprob.html"><i class="fa fa-check"></i><b>3</b> Conditional probability</a>
<ul>
<li class="chapter" data-level="3.1" data-path="condprob.html"><a href="condprob.html#calculating-conditional-probabilities"><i class="fa fa-check"></i><b>3.1</b> Calculating conditional probabilities</a></li>
<li class="chapter" data-level="3.2" data-path="condprob.html"><a href="condprob.html#conditional-independence"><i class="fa fa-check"></i><b>3.2</b> Conditional independence</a></li>
<li class="chapter" data-level="3.3" data-path="condprob.html"><a href="condprob.html#monty-hall-problem"><i class="fa fa-check"></i><b>3.3</b> Monty Hall problem</a></li>
</ul></li>
<li class="chapter" data-level="4" data-path="rvs.html"><a href="rvs.html"><i class="fa fa-check"></i><b>4</b> Random variables</a>
<ul>
<li class="chapter" data-level="4.1" data-path="rvs.html"><a href="rvs.html#general-properties-and-calculations"><i class="fa fa-check"></i><b>4.1</b> General properties and calculations</a></li>
<li class="chapter" data-level="4.2" data-path="rvs.html"><a href="rvs.html#discrete-random-variables"><i class="fa fa-check"></i><b>4.2</b> Discrete random variables</a></li>
<li class="chapter" data-level="4.3" data-path="rvs.html"><a href="rvs.html#continuous-random-variables"><i class="fa fa-check"></i><b>4.3</b> Continuous random variables</a></li>
<li class="chapter" data-level="4.4" data-path="rvs.html"><a href="rvs.html#singular-random-variables"><i class="fa fa-check"></i><b>4.4</b> Singular random variables</a></li>
<li class="chapter" data-level="4.5" data-path="rvs.html"><a href="rvs.html#transformations"><i class="fa fa-check"></i><b>4.5</b> Transformations</a></li>
</ul></li>
<li class="chapter" data-level="5" data-path="mrvs.html"><a href="mrvs.html"><i class="fa fa-check"></i><b>5</b> Multiple random variables</a>
<ul>
<li class="chapter" data-level="5.1" data-path="mrvs.html"><a href="mrvs.html#general"><i class="fa fa-check"></i><b>5.1</b> General</a></li>
<li class="chapter" data-level="5.2" data-path="mrvs.html"><a href="mrvs.html#bivariate-distribution-examples"><i class="fa fa-check"></i><b>5.2</b> Bivariate distribution examples</a></li>
<li class="chapter" data-level="5.3" data-path="mrvs.html"><a href="mrvs.html#transformations-1"><i class="fa fa-check"></i><b>5.3</b> Transformations</a></li>
</ul></li>
<li class="chapter" data-level="6" data-path="integ.html"><a href="integ.html"><i class="fa fa-check"></i><b>6</b> Integration</a>
<ul>
<li class="chapter" data-level="6.1" data-path="integ.html"><a href="integ.html#monte-carlo-integration"><i class="fa fa-check"></i><b>6.1</b> Monte Carlo integration</a></li>
<li class="chapter" data-level="6.2" data-path="integ.html"><a href="integ.html#lebesgue-integrals"><i class="fa fa-check"></i><b>6.2</b> Lebesgue integrals</a></li>
</ul></li>
<li class="chapter" data-level="7" data-path="ev.html"><a href="ev.html"><i class="fa fa-check"></i><b>7</b> Expected value</a>
<ul>
<li class="chapter" data-level="7.1" data-path="ev.html"><a href="ev.html#discrete-random-variables-1"><i class="fa fa-check"></i><b>7.1</b> Discrete random variables</a></li>
<li class="chapter" data-level="7.2" data-path="ev.html"><a href="ev.html#continuous-random-variables-1"><i class="fa fa-check"></i><b>7.2</b> Continuous random variables</a></li>
<li class="chapter" data-level="7.3" data-path="ev.html"><a href="ev.html#sums-functions-conditional-expectations"><i class="fa fa-check"></i><b>7.3</b> Sums, functions, conditional expectations</a></li>
<li class="chapter" data-level="7.4" data-path="ev.html"><a href="ev.html#covariance"><i class="fa fa-check"></i><b>7.4</b> Covariance</a></li>
</ul></li>
<li class="chapter" data-level="8" data-path="mrv.html"><a href="mrv.html"><i class="fa fa-check"></i><b>8</b> Multivariate random variables</a>
<ul>
<li class="chapter" data-level="8.1" data-path="mrv.html"><a href="mrv.html#multinomial-random-variables"><i class="fa fa-check"></i><b>8.1</b> Multinomial random variables</a></li>
<li class="chapter" data-level="8.2" data-path="mrv.html"><a href="mrv.html#multivariate-normal-random-variables"><i class="fa fa-check"></i><b>8.2</b> Multivariate normal random variables</a></li>
<li class="chapter" data-level="8.3" data-path="mrv.html"><a href="mrv.html#transformations-2"><i class="fa fa-check"></i><b>8.3</b> Transformations</a></li>
</ul></li>
<li class="chapter" data-level="9" data-path="ard.html"><a href="ard.html"><i class="fa fa-check"></i><b>9</b> Alternative representation of distributions</a>
<ul>
<li class="chapter" data-level="9.1" data-path="ard.html"><a href="ard.html#probability-generating-functions-pgfs"><i class="fa fa-check"></i><b>9.1</b> Probability generating functions (PGFs)</a></li>
<li class="chapter" data-level="9.2" data-path="ard.html"><a href="ard.html#moment-generating-functions-mgfs"><i class="fa fa-check"></i><b>9.2</b> Moment generating functions (MGFs)</a></li>
</ul></li>
<li class="chapter" data-level="10" data-path="ci.html"><a href="ci.html"><i class="fa fa-check"></i><b>10</b> Concentration inequalities</a>
<ul>
<li class="chapter" data-level="10.1" data-path="ci.html"><a href="ci.html#comparison"><i class="fa fa-check"></i><b>10.1</b> Comparison</a></li>
<li class="chapter" data-level="10.2" data-path="ci.html"><a href="ci.html#practical"><i class="fa fa-check"></i><b>10.2</b> Practical</a></li>
</ul></li>
<li class="chapter" data-level="11" data-path="crv.html"><a href="crv.html"><i class="fa fa-check"></i><b>11</b> Convergence of random variables</a></li>
<li class="chapter" data-level="12" data-path="lt.html"><a href="lt.html"><i class="fa fa-check"></i><b>12</b> Limit theorems</a></li>
<li class="chapter" data-level="13" data-path="eb.html"><a href="eb.html"><i class="fa fa-check"></i><b>13</b> Estimation basics</a>
<ul>
<li class="chapter" data-level="13.1" data-path="eb.html"><a href="eb.html#ecdf"><i class="fa fa-check"></i><b>13.1</b> ECDF</a></li>
<li class="chapter" data-level="13.2" data-path="eb.html"><a href="eb.html#properties-of-estimators"><i class="fa fa-check"></i><b>13.2</b> Properties of estimators</a></li>
</ul></li>
<li class="chapter" data-level="14" data-path="boot.html"><a href="boot.html"><i class="fa fa-check"></i><b>14</b> Bootstrap</a></li>
<li class="chapter" data-level="15" data-path="ml.html"><a href="ml.html"><i class="fa fa-check"></i><b>15</b> Maximum likelihood</a>
<ul>
<li class="chapter" data-level="15.1" data-path="ml.html"><a href="ml.html#deriving-mle"><i class="fa fa-check"></i><b>15.1</b> Deriving MLE</a></li>
<li class="chapter" data-level="15.2" data-path="ml.html"><a href="ml.html#fisher-information"><i class="fa fa-check"></i><b>15.2</b> Fisher information</a></li>
<li class="chapter" data-level="15.3" data-path="ml.html"><a href="ml.html#the-german-tank-problem"><i class="fa fa-check"></i><b>15.3</b> The German tank problem</a></li>
</ul></li>
<li class="chapter" data-level="16" data-path="nhst.html"><a href="nhst.html"><i class="fa fa-check"></i><b>16</b> Null hypothesis significance testing</a></li>
<li class="chapter" data-level="17" data-path="bi.html"><a href="bi.html"><i class="fa fa-check"></i><b>17</b> Bayesian inference</a>
<ul>
<li class="chapter" data-level="17.1" data-path="bi.html"><a href="bi.html#conjugate-priors"><i class="fa fa-check"></i><b>17.1</b> Conjugate priors</a></li>
<li class="chapter" data-level="17.2" data-path="bi.html"><a href="bi.html#posterior-sampling"><i class="fa fa-check"></i><b>17.2</b> Posterior sampling</a></li>
</ul></li>
<li class="chapter" data-level="18" data-path="distributions-intutition.html"><a href="distributions-intutition.html"><i class="fa fa-check"></i><b>18</b> Distributions intutition</a>
<ul>
<li class="chapter" data-level="18.1" data-path="distributions-intutition.html"><a href="distributions-intutition.html#discrete-distributions"><i class="fa fa-check"></i><b>18.1</b> Discrete distributions</a></li>
<li class="chapter" data-level="18.2" data-path="distributions-intutition.html"><a href="distributions-intutition.html#continuous-distributions"><i class="fa fa-check"></i><b>18.2</b> Continuous distributions</a></li>
</ul></li>
<li class="appendix"><span><b>Appendix</b></span></li>
<li class="chapter" data-level="A" data-path="A1.html"><a href="A1.html"><i class="fa fa-check"></i><b>A</b> R programming language</a>
<ul>
<li class="chapter" data-level="A.1" data-path="A1.html"><a href="A1.html#basic-characteristics"><i class="fa fa-check"></i><b>A.1</b> Basic characteristics</a></li>
<li class="chapter" data-level="A.2" data-path="A1.html"><a href="A1.html#why-r"><i class="fa fa-check"></i><b>A.2</b> Why R?</a></li>
<li class="chapter" data-level="A.3" data-path="A1.html"><a href="A1.html#setting-up"><i class="fa fa-check"></i><b>A.3</b> Setting up</a>
<ul>
<li class="chapter" data-level="A.3.1" data-path="A1.html"><a href="A1.html#rstudio"><i class="fa fa-check"></i><b>A.3.1</b> RStudio</a></li>
<li class="chapter" data-level="A.3.2" data-path="A1.html"><a href="A1.html#libraries-for-data-science"><i class="fa fa-check"></i><b>A.3.2</b> Libraries for data science</a></li>
</ul></li>
<li class="chapter" data-level="A.4" data-path="A1.html"><a href="A1.html#r-basics"><i class="fa fa-check"></i><b>A.4</b> R basics</a>
<ul>
<li class="chapter" data-level="A.4.1" data-path="A1.html"><a href="A1.html#variables-and-types"><i class="fa fa-check"></i><b>A.4.1</b> Variables and types</a></li>
<li class="chapter" data-level="A.4.2" data-path="A1.html"><a href="A1.html#basic-operations"><i class="fa fa-check"></i><b>A.4.2</b> Basic operations</a></li>
<li class="chapter" data-level="A.4.3" data-path="A1.html"><a href="A1.html#vectors"><i class="fa fa-check"></i><b>A.4.3</b> Vectors</a></li>
<li class="chapter" data-level="A.4.4" data-path="A1.html"><a href="A1.html#factors"><i class="fa fa-check"></i><b>A.4.4</b> Factors</a></li>
<li class="chapter" data-level="A.4.5" data-path="A1.html"><a href="A1.html#matrices"><i class="fa fa-check"></i><b>A.4.5</b> Matrices</a></li>
<li class="chapter" data-level="A.4.6" data-path="A1.html"><a href="A1.html#arrays"><i class="fa fa-check"></i><b>A.4.6</b> Arrays</a></li>
<li class="chapter" data-level="A.4.7" data-path="A1.html"><a href="A1.html#data-frames"><i class="fa fa-check"></i><b>A.4.7</b> Data frames</a></li>
<li class="chapter" data-level="A.4.8" data-path="A1.html"><a href="A1.html#lists"><i class="fa fa-check"></i><b>A.4.8</b> Lists</a></li>
<li class="chapter" data-level="A.4.9" data-path="A1.html"><a href="A1.html#loops"><i class="fa fa-check"></i><b>A.4.9</b> Loops</a></li>
</ul></li>
<li class="chapter" data-level="A.5" data-path="A1.html"><a href="A1.html#functions"><i class="fa fa-check"></i><b>A.5</b> Functions</a>
<ul>
<li class="chapter" data-level="A.5.1" data-path="A1.html"><a href="A1.html#writing-functions"><i class="fa fa-check"></i><b>A.5.1</b> Writing functions</a></li>
</ul></li>
<li class="chapter" data-level="A.6" data-path="A1.html"><a href="A1.html#other-tips"><i class="fa fa-check"></i><b>A.6</b> Other tips</a></li>
<li class="chapter" data-level="A.7" data-path="A1.html"><a href="A1.html#further-reading-and-references"><i class="fa fa-check"></i><b>A.7</b> Further reading and references</a></li>
</ul></li>
<li class="chapter" data-level="B" data-path="distributions.html"><a href="distributions.html"><i class="fa fa-check"></i><b>B</b> Probability distributions</a></li>
<li class="chapter" data-level="" data-path="references.html"><a href="references.html"><i class="fa fa-check"></i>References</a></li>
<li class="divider"></li>
<li><a href="https://github.com/rstudio/bookdown" target="blank">Published with bookdown</a></li>      
</ul>

      </nav>
    </div>

    <div class="book-body">
      <div class="body-inner">
        <div class="book-header" role="navigation">
          <h1>
            <i class="fa fa-circle-o-notch fa-spin"></i><a href="./">Principles of Uncertainty – exercises</a>
          </h1>
        </div>

        <div class="page-wrapper" tabindex="-1" role="main">
          <div class="page-inner">

            <section class="normal" id="section-">
<div id="bi" class="section level1 hasAnchor" number="17">
<h1><span class="header-section-number">Chapter 17</span> Bayesian inference<a href="bi.html#bi" class="anchor-section" aria-label="Anchor link to header"></a></h1>
<p>This chapter deals with Bayesian inference.</p>
<p>The students are expected to acquire the following knowledge:</p>
<ul>
<li>How to set prior distribution.</li>
<li>Compute posterior distribution.</li>
<li>Compute posterior predictive distribution.</li>
<li>Use sampling for inference.</li>
</ul>
<style>
.fold-btn { 
  float: right; 
  margin: 5px 5px 0 0;
}
.fold { 
  border: 1px solid black;
  min-height: 40px;
}
</style>
<script type="text/javascript">
$(document).ready(function() {
  $folds = $(".fold");
  $folds.wrapInner("<div class=\"fold-blck\">"); // wrap a div container around content
  $folds.prepend("<button class=\"fold-btn\">Unfold</button>");  // add a button
  $(".fold-blck").toggle();  // fold all blocks
  $(".fold-btn").on("click", function() {  // add onClick event
    $(this).text($(this).text() === "Fold" ? "Unfold" : "Fold");  // if the text equals "Fold", change it to "Unfold"or else to "Fold" 
    $(this).next(".fold-blck").toggle("linear");  // "swing" is the default easing function. This can be further customized in its speed or the overall animation itself.
  })
});
</script>
<div id="conjugate-priors" class="section level2 hasAnchor" number="17.1">
<h2><span class="header-section-number">17.1</span> Conjugate priors<a href="bi.html#conjugate-priors" class="anchor-section" aria-label="Anchor link to header"></a></h2>
<div class="exercise">
<p><span id="exr:unnamed-chunk-269" class="exercise"><strong>Exercise 17.1  (Poisson-gamma model) </strong></span>Let us assume a Poisson likelihood and a gamma prior on the Poisson mean parameter (this is a <a href="https://en.wikipedia.org/wiki/Conjugate_prior">conjugate prior</a>).</p>
<ol style="list-style-type: lower-alpha">
<li>Derive posterior</li>
<li>Below we have some data, which represents number of goals in a football match. Choose sensible prior for this data (draw the gamma density if necessary), justify it. Compute the posterior. <span style="color:blue">Compute an interval such that the probability that the true mean is in there is 95%. What is the probability that the true mean is greater than 2.5?</span></li>
<li>Back to theory: Compute prior predictive and posterior predictive. Discuss why the posterior predictive is overdispersed and not Poisson?</li>
<li><span style="color:blue">Draw a histogram of the prior predictive and posterior predictive for the data from (b). Discuss.</span></li>
<li><span style="color:blue">Generate 10 and 100 random samples from a Poisson distribution and compare the posteriors with a flat prior, and a prior concentrated away from the truth.</span></li>
</ol>
</div>
<div class="sourceCode" id="cb313"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb313-1"><a href="bi.html#cb313-1" tabindex="-1"></a>x <span class="ot">&lt;-</span> <span class="fu">c</span>(<span class="dv">3</span>, <span class="dv">2</span>, <span class="dv">1</span>, <span class="dv">1</span>, <span class="dv">5</span>, <span class="dv">4</span>, <span class="dv">0</span>, <span class="dv">0</span>, <span class="dv">4</span>, <span class="dv">3</span>)</span></code></pre></div>
<div class="fold">
<div class="solution">
<p><span id="unlabeled-div-95" class="solution"><em>Solution</em>. </span></p>
<ol style="list-style-type: lower-alpha">
<li><p><span class="math display">\[\begin{align*}
  p(\lambda | X) &amp;= \frac{p(X | \lambda) p(\lambda)}{\int_0^\infty p(X | \lambda) p(\lambda) d\lambda} \\
  &amp;\propto p(X | \lambda) p(\lambda) \\
  &amp;= \Big(\prod_{i=1}^n \frac{1}{x_i!} \lambda^{x_i} e^{-\lambda}\Big) \frac{\beta^\alpha}{\Gamma(\alpha)} \lambda^{\alpha - 1} e^{-\beta \lambda} \\
  &amp;\propto \lambda^{\sum_{i=1}^n x_i + \alpha - 1} e^{- \lambda (n + \beta)} \\
\end{align*}\]</span>
We recognize this as the shape of a gamma distribution, therefore
<span class="math display">\[\begin{align*}
  \lambda | X \sim \text{gamma}(\alpha + \sum_{i=1}^n x_i, \beta + n)
\end{align*}\]</span></p></li>
<li><p>For the prior predictive, we have
<span class="math display">\[\begin{align*}
  p(x^*) &amp;= \int_0^\infty p(x^*, \lambda) d\lambda \\
  &amp;= \int_0^\infty p(x^* | \lambda) p(\lambda) d\lambda \\
  &amp;= \int_0^\infty \frac{1}{x^*!} \lambda^{x^*} e^{-\lambda} \frac{\beta^\alpha}{\Gamma(\alpha)} \lambda^{\alpha - 1} e^{-\beta \lambda} d\lambda \\
  &amp;= \frac{\beta^\alpha}{\Gamma(x^* + 1)\Gamma(\alpha)} \int_0^\infty \lambda^{x^* + \alpha - 1} e^{-\lambda (1 + \beta)} d\lambda \\
  &amp;= \frac{\beta^\alpha}{\Gamma(x^* + 1)\Gamma(\alpha)}  \frac{\Gamma(x^* + \alpha)}{(1 + \beta)^{x^* + \alpha}} \int_0^\infty \frac{(1 + \beta)^{x^* + \alpha}}{\Gamma(x^* + \alpha)} \lambda^{x^* + \alpha - 1} e^{-\lambda (1 + \beta)} d\lambda \\
  &amp;= \frac{\beta^\alpha}{\Gamma(x^* + 1)\Gamma(\alpha)}  \frac{\Gamma(x^* + \alpha)}{(1 + \beta)^{x^* + \alpha}} \\
  &amp;= \frac{\Gamma(x^* + \alpha)}{\Gamma(x^* + 1)\Gamma(\alpha)} (\frac{\beta}{1 + \beta})^\alpha (\frac{1}{1 + \beta})^{x^*},
\end{align*}\]</span>
which we recognize as the negative binomial distribution with <span class="math inline">\(r = \alpha\)</span> and <span class="math inline">\(p = \frac{1}{\beta + 1}\)</span>. For the posterior predictive, the calculation is the same, only now the parameters are <span class="math inline">\(r = \alpha + \sum_{i=1}^n x_i\)</span> and <span class="math inline">\(p = \frac{1}{\beta + n + 1}\)</span>.
There are two sources of uncertainty in the predictive distribution. First is the uncertainty about the population. Second is the variability in sampling from the population. When <span class="math inline">\(n\)</span> is large, the latter is going to be very small. But when <span class="math inline">\(n\)</span> is small, the latter is going to be higher, resulting in an overdispersed predictive distribution.</p></li>
</ol>
</div>
<div class="sourceCode" id="cb314"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb314-1"><a href="bi.html#cb314-1" tabindex="-1"></a>x <span class="ot">&lt;-</span> <span class="fu">c</span>(<span class="dv">3</span>, <span class="dv">2</span>, <span class="dv">1</span>, <span class="dv">1</span>, <span class="dv">5</span>, <span class="dv">4</span>, <span class="dv">0</span>, <span class="dv">0</span>, <span class="dv">4</span>, <span class="dv">3</span>)</span>
<span id="cb314-2"><a href="bi.html#cb314-2" tabindex="-1"></a></span>
<span id="cb314-3"><a href="bi.html#cb314-3" tabindex="-1"></a><span class="co"># b</span></span>
<span id="cb314-4"><a href="bi.html#cb314-4" tabindex="-1"></a><span class="co"># quick visual check of the prior</span></span>
<span id="cb314-5"><a href="bi.html#cb314-5" tabindex="-1"></a><span class="fu">ggplot</span>(<span class="at">data =</span> <span class="fu">data.frame</span>(<span class="at">x =</span> <span class="fu">seq</span>(<span class="dv">0</span>, <span class="dv">5</span>, <span class="at">by =</span> <span class="fl">0.01</span>)), <span class="fu">aes</span>(<span class="at">x =</span> x)) <span class="sc">+</span></span>
<span id="cb314-6"><a href="bi.html#cb314-6" tabindex="-1"></a>  <span class="fu">stat_function</span>(<span class="at">fun =</span> dgamma, <span class="at">args =</span> <span class="fu">list</span>(<span class="at">shape =</span> <span class="dv">1</span>, <span class="at">rate =</span> <span class="dv">1</span>))</span></code></pre></div>
<p><img src="bookdown-pou_files/figure-html/unnamed-chunk-272-1.png" width="672" /></p>
<div class="sourceCode" id="cb315"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb315-1"><a href="bi.html#cb315-1" tabindex="-1"></a>palpha <span class="ot">&lt;-</span> <span class="dv">1</span></span>
<span id="cb315-2"><a href="bi.html#cb315-2" tabindex="-1"></a>pbeta  <span class="ot">&lt;-</span> <span class="dv">1</span></span>
<span id="cb315-3"><a href="bi.html#cb315-3" tabindex="-1"></a>alpha_post <span class="ot">&lt;-</span> palpha <span class="sc">+</span> <span class="fu">sum</span>(x)</span>
<span id="cb315-4"><a href="bi.html#cb315-4" tabindex="-1"></a>beta_post  <span class="ot">&lt;-</span> pbeta <span class="sc">+</span> <span class="fu">length</span>(x)</span>
<span id="cb315-5"><a href="bi.html#cb315-5" tabindex="-1"></a><span class="fu">ggplot</span>(<span class="at">data =</span> <span class="fu">data.frame</span>(<span class="at">x =</span> <span class="fu">seq</span>(<span class="dv">0</span>, <span class="dv">5</span>, <span class="at">by =</span> <span class="fl">0.01</span>)), <span class="fu">aes</span>(<span class="at">x =</span> x)) <span class="sc">+</span></span>
<span id="cb315-6"><a href="bi.html#cb315-6" tabindex="-1"></a>  <span class="fu">stat_function</span>(<span class="at">fun =</span> dgamma, <span class="at">args =</span> <span class="fu">list</span>(<span class="at">shape =</span> alpha_post, <span class="at">rate =</span> beta_post))</span></code></pre></div>
<p><img src="bookdown-pou_files/figure-html/unnamed-chunk-272-2.png" width="672" /></p>
<div class="sourceCode" id="cb316"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb316-1"><a href="bi.html#cb316-1" tabindex="-1"></a><span class="co"># probability of being higher than 2.5</span></span>
<span id="cb316-2"><a href="bi.html#cb316-2" tabindex="-1"></a><span class="dv">1</span> <span class="sc">-</span> <span class="fu">pgamma</span>(<span class="fl">2.5</span>, alpha_post, beta_post)</span></code></pre></div>
<pre><code>## [1] 0.2267148</code></pre>
<div class="sourceCode" id="cb318"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb318-1"><a href="bi.html#cb318-1" tabindex="-1"></a><span class="co"># interval</span></span>
<span id="cb318-2"><a href="bi.html#cb318-2" tabindex="-1"></a><span class="fu">qgamma</span>(<span class="fu">c</span>(<span class="fl">0.025</span>, <span class="fl">0.975</span>), alpha_post, beta_post)</span></code></pre></div>
<pre><code>## [1] 1.397932 3.137390</code></pre>
<div class="sourceCode" id="cb320"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb320-1"><a href="bi.html#cb320-1" tabindex="-1"></a><span class="co"># d</span></span>
<span id="cb320-2"><a href="bi.html#cb320-2" tabindex="-1"></a>prior_pred <span class="ot">&lt;-</span> <span class="fu">rnbinom</span>(<span class="dv">1000</span>, <span class="at">size =</span> palpha, <span class="at">prob =</span> <span class="dv">1</span> <span class="sc">-</span> <span class="dv">1</span> <span class="sc">/</span> (pbeta <span class="sc">+</span> <span class="dv">1</span>))</span>
<span id="cb320-3"><a href="bi.html#cb320-3" tabindex="-1"></a>post_pred  <span class="ot">&lt;-</span> <span class="fu">rnbinom</span>(<span class="dv">1000</span>, <span class="at">size =</span> palpha <span class="sc">+</span> <span class="fu">sum</span>(x), <span class="at">prob =</span> <span class="dv">1</span> <span class="sc">-</span> <span class="dv">1</span> <span class="sc">/</span> (pbeta <span class="sc">+</span> <span class="dv">10</span> <span class="sc">+</span> <span class="dv">1</span>))</span>
<span id="cb320-4"><a href="bi.html#cb320-4" tabindex="-1"></a>df         <span class="ot">&lt;-</span> <span class="fu">data.frame</span>(<span class="at">prior =</span> prior_pred, <span class="at">posterior =</span> post_pred)</span>
<span id="cb320-5"><a href="bi.html#cb320-5" tabindex="-1"></a>df         <span class="ot">&lt;-</span> <span class="fu">gather</span>(df)</span>
<span id="cb320-6"><a href="bi.html#cb320-6" tabindex="-1"></a><span class="fu">ggplot</span>(df, <span class="fu">aes</span>(<span class="at">x =</span> value, <span class="at">fill =</span> key)) <span class="sc">+</span></span>
<span id="cb320-7"><a href="bi.html#cb320-7" tabindex="-1"></a>  <span class="fu">geom_histogram</span>(<span class="at">position =</span> <span class="st">&quot;dodge&quot;</span>)</span></code></pre></div>
<p><img src="bookdown-pou_files/figure-html/unnamed-chunk-272-3.png" width="672" /></p>
<div class="sourceCode" id="cb321"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb321-1"><a href="bi.html#cb321-1" tabindex="-1"></a><span class="co"># e</span></span>
<span id="cb321-2"><a href="bi.html#cb321-2" tabindex="-1"></a><span class="fu">set.seed</span>(<span class="dv">1</span>)</span>
<span id="cb321-3"><a href="bi.html#cb321-3" tabindex="-1"></a>x1 <span class="ot">&lt;-</span> <span class="fu">rpois</span>(<span class="dv">10</span>, <span class="fl">2.5</span>)</span>
<span id="cb321-4"><a href="bi.html#cb321-4" tabindex="-1"></a>x2 <span class="ot">&lt;-</span> <span class="fu">rpois</span>(<span class="dv">100</span>, <span class="fl">2.5</span>)</span>
<span id="cb321-5"><a href="bi.html#cb321-5" tabindex="-1"></a>alpha_flat <span class="ot">&lt;-</span> <span class="dv">1</span></span>
<span id="cb321-6"><a href="bi.html#cb321-6" tabindex="-1"></a>beta_flat  <span class="ot">&lt;-</span> <span class="fl">0.1</span></span>
<span id="cb321-7"><a href="bi.html#cb321-7" tabindex="-1"></a>alpha_conc <span class="ot">&lt;-</span> <span class="dv">50</span></span>
<span id="cb321-8"><a href="bi.html#cb321-8" tabindex="-1"></a>beta_conc  <span class="ot">&lt;-</span> <span class="dv">10</span></span>
<span id="cb321-9"><a href="bi.html#cb321-9" tabindex="-1"></a>n          <span class="ot">&lt;-</span> <span class="dv">10000</span></span>
<span id="cb321-10"><a href="bi.html#cb321-10" tabindex="-1"></a>df_flat    <span class="ot">&lt;-</span> <span class="fu">data.frame</span>(<span class="at">x1 =</span> <span class="fu">rgamma</span>(n, alpha_flat <span class="sc">+</span> <span class="fu">sum</span>(x1), beta_flat <span class="sc">+</span> <span class="dv">10</span>), </span>
<span id="cb321-11"><a href="bi.html#cb321-11" tabindex="-1"></a>                         <span class="at">x2 =</span> <span class="fu">rgamma</span>(n, alpha_flat <span class="sc">+</span> <span class="fu">sum</span>(x2), beta_flat <span class="sc">+</span> <span class="dv">100</span>), </span>
<span id="cb321-12"><a href="bi.html#cb321-12" tabindex="-1"></a>                         <span class="at">type =</span> <span class="st">&quot;flat&quot;</span>)</span>
<span id="cb321-13"><a href="bi.html#cb321-13" tabindex="-1"></a>df_flat    <span class="ot">&lt;-</span> tidyr<span class="sc">::</span><span class="fu">gather</span>(df_flat, <span class="at">key =</span> <span class="st">&quot;key&quot;</span>, <span class="at">value =</span> <span class="st">&quot;value&quot;</span>, <span class="sc">-</span> type)</span>
<span id="cb321-14"><a href="bi.html#cb321-14" tabindex="-1"></a>df_conc    <span class="ot">&lt;-</span> <span class="fu">data.frame</span>(<span class="at">x1 =</span> <span class="fu">rgamma</span>(n, alpha_conc <span class="sc">+</span> <span class="fu">sum</span>(x1), beta_conc <span class="sc">+</span> <span class="dv">10</span>), </span>
<span id="cb321-15"><a href="bi.html#cb321-15" tabindex="-1"></a>                         <span class="at">x2 =</span> <span class="fu">rgamma</span>(n, alpha_conc <span class="sc">+</span> <span class="fu">sum</span>(x2), beta_conc <span class="sc">+</span> <span class="dv">100</span>), </span>
<span id="cb321-16"><a href="bi.html#cb321-16" tabindex="-1"></a>                         <span class="at">type =</span> <span class="st">&quot;conc&quot;</span>)</span>
<span id="cb321-17"><a href="bi.html#cb321-17" tabindex="-1"></a>df_conc    <span class="ot">&lt;-</span> tidyr<span class="sc">::</span><span class="fu">gather</span>(df_conc, <span class="at">key =</span> <span class="st">&quot;key&quot;</span>, <span class="at">value =</span> <span class="st">&quot;value&quot;</span>, <span class="sc">-</span> type)</span>
<span id="cb321-18"><a href="bi.html#cb321-18" tabindex="-1"></a>df         <span class="ot">&lt;-</span> <span class="fu">rbind</span>(df_flat, df_conc)</span>
<span id="cb321-19"><a href="bi.html#cb321-19" tabindex="-1"></a><span class="fu">ggplot</span>(<span class="at">data =</span> df, <span class="fu">aes</span>(<span class="at">x =</span> value, <span class="at">color =</span> type)) <span class="sc">+</span></span>
<span id="cb321-20"><a href="bi.html#cb321-20" tabindex="-1"></a>  <span class="fu">facet_wrap</span>(<span class="sc">~</span> key) <span class="sc">+</span></span>
<span id="cb321-21"><a href="bi.html#cb321-21" tabindex="-1"></a>  <span class="fu">geom_density</span>()</span></code></pre></div>
<p><img src="bookdown-pou_files/figure-html/unnamed-chunk-272-4.png" width="672" /></p>
</div>
</div>
<div id="posterior-sampling" class="section level2 hasAnchor" number="17.2">
<h2><span class="header-section-number">17.2</span> Posterior sampling<a href="bi.html#posterior-sampling" class="anchor-section" aria-label="Anchor link to header"></a></h2>
<div class="exercise">
<p><span id="exr:unnamed-chunk-273" class="exercise"><strong>Exercise 17.2  (Bayesian logistic regression) </strong></span>In Chapter 15 we implemented a MLE for logistic regression (see the code below). For this model, conjugate priors do not exist, which complicates the calculation of the posterior. However, we can use sampling from the numerator of the posterior, using rejection sampling.</p>
<ol style="list-style-type: lower-alpha">
<li><span style="color:blue">Set a sensible prior distribution on <span class="math inline">\(\beta\)</span> and use rejection sampling to find the posterior distribution.</span></li>
<li><span style="color:blue">In a) you will get a distribution of parameter <span class="math inline">\(\beta\)</span>. Plot the probabilities (as in exercise <a href="ml.html#exr:logisticmle">15.3</a>) for each sample of <span class="math inline">\(\beta\)</span> and compare to the truth.</span></li>
</ol>
<p>Hint: We can use rejection sampling even for functions which are not PDFs – they do not have to sum/integrate to 1. We just need to use a suitable envelope that we know how to sample from. For example, here we could use a uniform distribution and scale it suitably.</p>
</div>
<div class="sourceCode" id="cb322"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb322-1"><a href="bi.html#cb322-1" tabindex="-1"></a><span class="fu">set.seed</span>(<span class="dv">1</span>)</span>
<span id="cb322-2"><a href="bi.html#cb322-2" tabindex="-1"></a>inv_log <span class="ot">&lt;-</span> <span class="cf">function</span> (z) {</span>
<span id="cb322-3"><a href="bi.html#cb322-3" tabindex="-1"></a>  <span class="fu">return</span> (<span class="dv">1</span> <span class="sc">/</span> (<span class="dv">1</span> <span class="sc">+</span> <span class="fu">exp</span>(<span class="sc">-</span>z)))</span>
<span id="cb322-4"><a href="bi.html#cb322-4" tabindex="-1"></a>}</span>
<span id="cb322-5"><a href="bi.html#cb322-5" tabindex="-1"></a>x <span class="ot">&lt;-</span> <span class="fu">rnorm</span>(<span class="dv">100</span>)</span>
<span id="cb322-6"><a href="bi.html#cb322-6" tabindex="-1"></a>y <span class="ot">&lt;-</span> x</span>
<span id="cb322-7"><a href="bi.html#cb322-7" tabindex="-1"></a>y <span class="ot">&lt;-</span> <span class="fu">rbinom</span>(<span class="dv">100</span>, <span class="at">size =</span> <span class="dv">1</span>, <span class="at">prob =</span> <span class="fu">inv_log</span>(<span class="fl">1.2</span> <span class="sc">*</span> x))</span>
<span id="cb322-8"><a href="bi.html#cb322-8" tabindex="-1"></a></span>
<span id="cb322-9"><a href="bi.html#cb322-9" tabindex="-1"></a>l_logistic <span class="ot">&lt;-</span> <span class="cf">function</span> (beta, X, y) {</span>
<span id="cb322-10"><a href="bi.html#cb322-10" tabindex="-1"></a>  logl <span class="ot">&lt;-</span> <span class="sc">-</span><span class="fu">sum</span>(y <span class="sc">*</span> <span class="fu">log</span>(<span class="fu">inv_log</span>(<span class="fu">as.vector</span>(beta <span class="sc">%*%</span> X))) <span class="sc">+</span> (<span class="dv">1</span> <span class="sc">-</span> y) <span class="sc">*</span> <span class="fu">log</span>((<span class="dv">1</span> <span class="sc">-</span> <span class="fu">inv_log</span>(<span class="fu">as.vector</span>(beta <span class="sc">%*%</span> X)))))</span>
<span id="cb322-11"><a href="bi.html#cb322-11" tabindex="-1"></a>  <span class="fu">return</span>(logl)</span>
<span id="cb322-12"><a href="bi.html#cb322-12" tabindex="-1"></a>}</span>
<span id="cb322-13"><a href="bi.html#cb322-13" tabindex="-1"></a>my_optim <span class="ot">&lt;-</span> <span class="fu">optim</span>(<span class="at">par =</span> <span class="fl">0.5</span>, <span class="at">fn =</span> l_logistic, <span class="at">method =</span> <span class="st">&quot;L-BFGS-B&quot;</span>,</span>
<span id="cb322-14"><a href="bi.html#cb322-14" tabindex="-1"></a>                  <span class="at">lower =</span> <span class="dv">0</span>, <span class="at">upper =</span> <span class="dv">10</span>, <span class="at">X =</span> x, <span class="at">y =</span> y)</span>
<span id="cb322-15"><a href="bi.html#cb322-15" tabindex="-1"></a>my_optim<span class="sc">$</span>par</span></code></pre></div>
<div class="fold">
<div class="sourceCode" id="cb323"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb323-1"><a href="bi.html#cb323-1" tabindex="-1"></a><span class="co"># Let&#39;s say we believe that the mean of beta is 0.5. Since we are not very sure </span></span>
<span id="cb323-2"><a href="bi.html#cb323-2" tabindex="-1"></a><span class="co"># about this, we will give it a relatively high variance. So a normal prior with </span></span>
<span id="cb323-3"><a href="bi.html#cb323-3" tabindex="-1"></a><span class="co"># mean 0.5 and standard deviation 5. But there is no right solution to this,</span></span>
<span id="cb323-4"><a href="bi.html#cb323-4" tabindex="-1"></a><span class="co"># this is basically us expressing our prior belief in the parameter values.</span></span>
<span id="cb323-5"><a href="bi.html#cb323-5" tabindex="-1"></a><span class="fu">set.seed</span>(<span class="dv">1</span>)</span>
<span id="cb323-6"><a href="bi.html#cb323-6" tabindex="-1"></a>inv_log <span class="ot">&lt;-</span> <span class="cf">function</span> (z) {</span>
<span id="cb323-7"><a href="bi.html#cb323-7" tabindex="-1"></a>  <span class="fu">return</span> (<span class="dv">1</span> <span class="sc">/</span> (<span class="dv">1</span> <span class="sc">+</span> <span class="fu">exp</span>(<span class="sc">-</span>z)))</span>
<span id="cb323-8"><a href="bi.html#cb323-8" tabindex="-1"></a>}</span>
<span id="cb323-9"><a href="bi.html#cb323-9" tabindex="-1"></a></span>
<span id="cb323-10"><a href="bi.html#cb323-10" tabindex="-1"></a>x <span class="ot">&lt;-</span> <span class="fu">rnorm</span>(<span class="dv">100</span>)</span>
<span id="cb323-11"><a href="bi.html#cb323-11" tabindex="-1"></a>y <span class="ot">&lt;-</span> x</span>
<span id="cb323-12"><a href="bi.html#cb323-12" tabindex="-1"></a>y <span class="ot">&lt;-</span> <span class="fu">rbinom</span>(<span class="dv">100</span>, <span class="at">size =</span> <span class="dv">1</span>, <span class="at">prob =</span> <span class="fu">inv_log</span>(<span class="fl">1.2</span> <span class="sc">*</span> x))</span>
<span id="cb323-13"><a href="bi.html#cb323-13" tabindex="-1"></a></span>
<span id="cb323-14"><a href="bi.html#cb323-14" tabindex="-1"></a>l_logistic <span class="ot">&lt;-</span> <span class="cf">function</span> (beta, X, y) {</span>
<span id="cb323-15"><a href="bi.html#cb323-15" tabindex="-1"></a>  logl <span class="ot">&lt;-</span> <span class="sc">-</span><span class="fu">sum</span>(y <span class="sc">*</span> <span class="fu">log</span>(<span class="fu">inv_log</span>(<span class="fu">as.vector</span>(beta <span class="sc">%*%</span> X))) <span class="sc">+</span> (<span class="dv">1</span> <span class="sc">-</span> y) <span class="sc">*</span> <span class="fu">log</span>((<span class="dv">1</span> <span class="sc">-</span> <span class="fu">inv_log</span>(<span class="fu">as.vector</span>(beta <span class="sc">%*%</span> X)))))</span>
<span id="cb323-16"><a href="bi.html#cb323-16" tabindex="-1"></a>  <span class="cf">if</span> (<span class="fu">is.nan</span>(logl)) logl <span class="ot">&lt;-</span> <span class="cn">Inf</span></span>
<span id="cb323-17"><a href="bi.html#cb323-17" tabindex="-1"></a>  <span class="fu">return</span>(logl)</span>
<span id="cb323-18"><a href="bi.html#cb323-18" tabindex="-1"></a>}</span>
<span id="cb323-19"><a href="bi.html#cb323-19" tabindex="-1"></a></span>
<span id="cb323-20"><a href="bi.html#cb323-20" tabindex="-1"></a>my_optim <span class="ot">&lt;-</span> <span class="fu">optim</span>(<span class="at">par =</span> <span class="fl">0.5</span>, <span class="at">fn =</span> l_logistic, <span class="at">method =</span> <span class="st">&quot;L-BFGS-B&quot;</span>,</span>
<span id="cb323-21"><a href="bi.html#cb323-21" tabindex="-1"></a>                  <span class="at">lower =</span> <span class="dv">0</span>, <span class="at">upper =</span> <span class="dv">10</span>, <span class="at">X =</span> x, <span class="at">y =</span> y)</span>
<span id="cb323-22"><a href="bi.html#cb323-22" tabindex="-1"></a>my_optim<span class="sc">$</span>par</span></code></pre></div>
<pre><code>## [1] 1.166558</code></pre>
<div class="sourceCode" id="cb325"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb325-1"><a href="bi.html#cb325-1" tabindex="-1"></a>f_logistic <span class="ot">&lt;-</span> <span class="cf">function</span> (beta, X, y) {</span>
<span id="cb325-2"><a href="bi.html#cb325-2" tabindex="-1"></a>  logl <span class="ot">&lt;-</span> <span class="fu">prod</span>(<span class="fu">inv_log</span>(<span class="fu">as.vector</span>(beta <span class="sc">%*%</span> X))<span class="sc">^</span>y <span class="sc">*</span> (<span class="dv">1</span> <span class="sc">-</span> <span class="fu">inv_log</span>(<span class="fu">as.vector</span>(beta <span class="sc">%*%</span> X)))<span class="sc">^</span>(<span class="dv">1</span> <span class="sc">-</span> y))</span>
<span id="cb325-3"><a href="bi.html#cb325-3" tabindex="-1"></a>  <span class="fu">return</span>(logl)</span>
<span id="cb325-4"><a href="bi.html#cb325-4" tabindex="-1"></a>}</span>
<span id="cb325-5"><a href="bi.html#cb325-5" tabindex="-1"></a></span>
<span id="cb325-6"><a href="bi.html#cb325-6" tabindex="-1"></a>a <span class="ot">&lt;-</span> <span class="fu">seq</span>(<span class="dv">0</span>, <span class="dv">3</span>, <span class="at">by =</span> <span class="fl">0.01</span>)</span>
<span id="cb325-7"><a href="bi.html#cb325-7" tabindex="-1"></a>my_l <span class="ot">&lt;-</span> <span class="fu">c</span>()</span>
<span id="cb325-8"><a href="bi.html#cb325-8" tabindex="-1"></a><span class="cf">for</span> (i <span class="cf">in</span> a) {</span>
<span id="cb325-9"><a href="bi.html#cb325-9" tabindex="-1"></a>  my_l <span class="ot">&lt;-</span> <span class="fu">c</span>(my_l, <span class="fu">f_logistic</span>(i, x, y) <span class="sc">*</span> <span class="fu">dnorm</span>(i, <span class="fl">0.5</span>, <span class="dv">5</span>))</span>
<span id="cb325-10"><a href="bi.html#cb325-10" tabindex="-1"></a>}</span>
<span id="cb325-11"><a href="bi.html#cb325-11" tabindex="-1"></a><span class="fu">plot</span>(my_l)</span></code></pre></div>
<p><img src="bookdown-pou_files/figure-html/unnamed-chunk-275-1.png" width="672" /></p>
<div class="sourceCode" id="cb326"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb326-1"><a href="bi.html#cb326-1" tabindex="-1"></a>envlp <span class="ot">&lt;-</span> <span class="dv">10</span><span class="sc">^</span>(<span class="sc">-</span><span class="fl">25.8</span>) <span class="sc">*</span> <span class="fu">dunif</span>(a, <span class="sc">-</span><span class="dv">5</span>, <span class="dv">5</span>) <span class="co"># found by trial and error</span></span>
<span id="cb326-2"><a href="bi.html#cb326-2" tabindex="-1"></a></span>
<span id="cb326-3"><a href="bi.html#cb326-3" tabindex="-1"></a>tmp <span class="ot">&lt;-</span> <span class="fu">data.frame</span>(<span class="at">envel =</span> envlp, <span class="at">l =</span> my_l, <span class="at">t =</span> a)</span>
<span id="cb326-4"><a href="bi.html#cb326-4" tabindex="-1"></a>tmp <span class="ot">&lt;-</span> <span class="fu">gather</span>(tmp, <span class="at">key =</span> <span class="st">&quot;key&quot;</span>, <span class="at">value =</span> <span class="st">&quot;value&quot;</span>, <span class="sc">-</span> t)</span>
<span id="cb326-5"><a href="bi.html#cb326-5" tabindex="-1"></a><span class="fu">ggplot</span>(tmp, <span class="fu">aes</span>(<span class="at">x =</span> t, <span class="at">y =</span> value, <span class="at">color =</span> key)) <span class="sc">+</span></span>
<span id="cb326-6"><a href="bi.html#cb326-6" tabindex="-1"></a>  <span class="fu">geom_line</span>() <span class="co"># envelope OK</span></span></code></pre></div>
<p><img src="bookdown-pou_files/figure-html/unnamed-chunk-275-2.png" width="672" /></p>
<div class="sourceCode" id="cb327"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb327-1"><a href="bi.html#cb327-1" tabindex="-1"></a><span class="fu">set.seed</span>(<span class="dv">1</span>)</span>
<span id="cb327-2"><a href="bi.html#cb327-2" tabindex="-1"></a>nsamps <span class="ot">&lt;-</span> <span class="dv">1000</span></span>
<span id="cb327-3"><a href="bi.html#cb327-3" tabindex="-1"></a>samps  <span class="ot">&lt;-</span> <span class="fu">c</span>()</span>
<span id="cb327-4"><a href="bi.html#cb327-4" tabindex="-1"></a><span class="cf">for</span> (i <span class="cf">in</span> <span class="dv">1</span><span class="sc">:</span>nsamps) {</span>
<span id="cb327-5"><a href="bi.html#cb327-5" tabindex="-1"></a>  tmp <span class="ot">&lt;-</span> <span class="fu">runif</span>(<span class="dv">1</span>, <span class="sc">-</span><span class="dv">5</span>, <span class="dv">5</span>)</span>
<span id="cb327-6"><a href="bi.html#cb327-6" tabindex="-1"></a>  u   <span class="ot">&lt;-</span> <span class="fu">runif</span>(<span class="dv">1</span>, <span class="dv">0</span>, <span class="dv">1</span>)</span>
<span id="cb327-7"><a href="bi.html#cb327-7" tabindex="-1"></a>  <span class="cf">if</span> (u <span class="sc">&lt;</span> (<span class="fu">f_logistic</span>(tmp, x, y) <span class="sc">*</span> <span class="fu">dnorm</span>(tmp, <span class="fl">0.5</span>, <span class="dv">5</span>)) <span class="sc">/</span> </span>
<span id="cb327-8"><a href="bi.html#cb327-8" tabindex="-1"></a>      (<span class="dv">10</span><span class="sc">^</span>(<span class="sc">-</span><span class="fl">25.8</span>) <span class="sc">*</span> <span class="fu">dunif</span>(tmp, <span class="sc">-</span><span class="dv">5</span>, <span class="dv">5</span>))) {</span>
<span id="cb327-9"><a href="bi.html#cb327-9" tabindex="-1"></a>    samps <span class="ot">&lt;-</span> <span class="fu">c</span>(samps, tmp)</span>
<span id="cb327-10"><a href="bi.html#cb327-10" tabindex="-1"></a>  }</span>
<span id="cb327-11"><a href="bi.html#cb327-11" tabindex="-1"></a>}</span>
<span id="cb327-12"><a href="bi.html#cb327-12" tabindex="-1"></a><span class="fu">plot</span>(<span class="fu">density</span>(samps))</span></code></pre></div>
<p><img src="bookdown-pou_files/figure-html/unnamed-chunk-275-3.png" width="672" /></p>
<div class="sourceCode" id="cb328"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb328-1"><a href="bi.html#cb328-1" tabindex="-1"></a><span class="fu">mean</span>(samps)</span></code></pre></div>
<pre><code>## [1] 1.211578</code></pre>
<div class="sourceCode" id="cb330"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb330-1"><a href="bi.html#cb330-1" tabindex="-1"></a><span class="fu">median</span>(samps)</span></code></pre></div>
<pre><code>## [1] 1.204279</code></pre>
<div class="sourceCode" id="cb332"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb332-1"><a href="bi.html#cb332-1" tabindex="-1"></a>truth_p <span class="ot">&lt;-</span> <span class="fu">data.frame</span>(<span class="at">x =</span> x, <span class="at">prob =</span> <span class="fu">inv_log</span>(<span class="fl">1.2</span> <span class="sc">*</span> x), <span class="at">type =</span> <span class="st">&quot;truth&quot;</span>)</span>
<span id="cb332-2"><a href="bi.html#cb332-2" tabindex="-1"></a>preds   <span class="ot">&lt;-</span> <span class="fu">inv_log</span>(x <span class="sc">%*%</span> <span class="fu">t</span>(samps))</span>
<span id="cb332-3"><a href="bi.html#cb332-3" tabindex="-1"></a>preds   <span class="ot">&lt;-</span> <span class="fu">gather</span>(<span class="fu">cbind</span>(<span class="fu">as.data.frame</span>(preds), <span class="at">x =</span> x), <span class="at">key =</span> <span class="st">&quot;key&quot;</span>, </span>
<span id="cb332-4"><a href="bi.html#cb332-4" tabindex="-1"></a>                  <span class="st">&quot;value&quot;</span> <span class="ot">=</span> value, <span class="sc">-</span> x)</span>
<span id="cb332-5"><a href="bi.html#cb332-5" tabindex="-1"></a></span>
<span id="cb332-6"><a href="bi.html#cb332-6" tabindex="-1"></a><span class="fu">ggplot</span>(preds, <span class="fu">aes</span>(<span class="at">x =</span> x, <span class="at">y =</span> value)) <span class="sc">+</span></span>
<span id="cb332-7"><a href="bi.html#cb332-7" tabindex="-1"></a>  <span class="fu">geom_line</span>(<span class="fu">aes</span>(<span class="at">group =</span> key), <span class="at">color =</span> <span class="st">&quot;gray&quot;</span>, <span class="at">alpha =</span> <span class="fl">0.7</span>) <span class="sc">+</span></span>
<span id="cb332-8"><a href="bi.html#cb332-8" tabindex="-1"></a>  <span class="fu">geom_point</span>(<span class="at">data =</span> truth_p, <span class="fu">aes</span>(<span class="at">y =</span> prob), <span class="at">color =</span> <span class="st">&quot;red&quot;</span>, <span class="at">alpha =</span> <span class="fl">0.7</span>) <span class="sc">+</span></span>
<span id="cb332-9"><a href="bi.html#cb332-9" tabindex="-1"></a>  <span class="fu">theme_bw</span>()</span></code></pre></div>
<p><img src="bookdown-pou_files/figure-html/unnamed-chunk-275-4.png" width="672" /></p>
</div>

</div>
</div>
            </section>

          </div>
        </div>
      </div>
<a href="nhst.html" class="navigation navigation-prev " aria-label="Previous page"><i class="fa fa-angle-left"></i></a>
<a href="distributions-intutition.html" class="navigation navigation-next " aria-label="Next page"><i class="fa fa-angle-right"></i></a>
    </div>
  </div>
<script src="libs/gitbook-2.6.7/js/app.min.js"></script>
<script src="libs/gitbook-2.6.7/js/clipboard.min.js"></script>
<script src="libs/gitbook-2.6.7/js/plugin-search.js"></script>
<script src="libs/gitbook-2.6.7/js/plugin-sharing.js"></script>
<script src="libs/gitbook-2.6.7/js/plugin-fontsettings.js"></script>
<script src="libs/gitbook-2.6.7/js/plugin-bookdown.js"></script>
<script src="libs/gitbook-2.6.7/js/jquery.highlight.js"></script>
<script src="libs/gitbook-2.6.7/js/plugin-clipboard.js"></script>
<script>
gitbook.require(["gitbook"], function(gitbook) {
gitbook.start({
"sharing": {
"github": false,
"facebook": true,
"twitter": true,
"linkedin": false,
"weibo": false,
"instapaper": false,
"vk": false,
"whatsapp": false,
"all": ["facebook", "twitter", "linkedin", "weibo", "instapaper"]
},
"fontsettings": {
"theme": "white",
"family": "sans",
"size": 2
},
"edit": {
"link": null,
"text": null
},
"history": {
"link": null,
"text": null
},
"view": {
"link": null,
"text": null
},
"download": null,
"search": {
"engine": "fuse",
"options": null
},
"toc": {
"collapse": "subsection"
}
});
});
</script>

<!-- dynamically load mathjax for compatibility with self-contained -->
<script>
  (function () {
    var script = document.createElement("script");
    script.type = "text/javascript";
    var src = "true";
    if (src === "" || src === "true") src = "https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.9/latest.js?config=TeX-MML-AM_CHTML";
    if (location.protocol !== "file:")
      if (/^https?:/.test(src))
        src = src.replace(/^https?:/, '');
    script.src = src;
    document.getElementsByTagName("head")[0].appendChild(script);
  })();
</script>
</body>

</html>
