<!DOCTYPE html>
<html >

<head>

  <meta charset="UTF-8">
  <meta http-equiv="X-UA-Compatible" content="IE=edge">
  <title>Chapter 4 Random variables | Principles of Uncertainty – exercises</title>
  <meta name="description" content="Course notes">
  <meta name="generator" content="bookdown  and GitBook 2.6.7">

  <meta property="og:title" content="Chapter 4 Random variables | Principles of Uncertainty – exercises" />
  <meta property="og:type" content="book" />
  <meta property="og:url" content="https://fri-datascience.github.io/course_pou/" />
  
  <meta property="og:description" content="Course notes" />
  

  <meta name="twitter:card" content="summary" />
  <meta name="twitter:title" content="Chapter 4 Random variables | Principles of Uncertainty – exercises" />
  
  <meta name="twitter:description" content="Course notes" />
  

<meta name="author" content="Gregor Pirš and Erik Štrumbelj">


<meta name="date" content="2019-11-05">

  <meta name="viewport" content="width=device-width, initial-scale=1">
  <meta name="apple-mobile-web-app-capable" content="yes">
  <meta name="apple-mobile-web-app-status-bar-style" content="black">
  
  
<link rel="prev" href="condprob.html">
<link rel="next" href="A1.html">
<script src="libs/jquery-2.2.3/jquery.min.js"></script>
<link href="libs/gitbook-2.6.7/css/style.css" rel="stylesheet" />
<link href="libs/gitbook-2.6.7/css/plugin-table.css" rel="stylesheet" />
<link href="libs/gitbook-2.6.7/css/plugin-bookdown.css" rel="stylesheet" />
<link href="libs/gitbook-2.6.7/css/plugin-highlight.css" rel="stylesheet" />
<link href="libs/gitbook-2.6.7/css/plugin-search.css" rel="stylesheet" />
<link href="libs/gitbook-2.6.7/css/plugin-fontsettings.css" rel="stylesheet" />









<style type="text/css">
a.sourceLine { display: inline-block; line-height: 1.25; }
a.sourceLine { pointer-events: none; color: inherit; text-decoration: inherit; }
a.sourceLine:empty { height: 1.2em; }
.sourceCode { overflow: visible; }
code.sourceCode { white-space: pre; position: relative; }
div.sourceCode { margin: 1em 0; }
pre.sourceCode { margin: 0; }
@media screen {
div.sourceCode { overflow: auto; }
}
@media print {
code.sourceCode { white-space: pre-wrap; }
a.sourceLine { text-indent: -1em; padding-left: 1em; }
}
pre.numberSource a.sourceLine
  { position: relative; left: -4em; }
pre.numberSource a.sourceLine::before
  { content: attr(title);
    position: relative; left: -1em; text-align: right; vertical-align: baseline;
    border: none; pointer-events: all; display: inline-block;
    -webkit-touch-callout: none; -webkit-user-select: none;
    -khtml-user-select: none; -moz-user-select: none;
    -ms-user-select: none; user-select: none;
    padding: 0 4px; width: 4em;
    color: #aaaaaa;
  }
pre.numberSource { margin-left: 3em; border-left: 1px solid #aaaaaa;  padding-left: 4px; }
div.sourceCode
  {  }
@media screen {
a.sourceLine::before { text-decoration: underline; }
}
code span.al { color: #ff0000; font-weight: bold; } /* Alert */
code span.an { color: #60a0b0; font-weight: bold; font-style: italic; } /* Annotation */
code span.at { color: #7d9029; } /* Attribute */
code span.bn { color: #40a070; } /* BaseN */
code span.bu { } /* BuiltIn */
code span.cf { color: #007020; font-weight: bold; } /* ControlFlow */
code span.ch { color: #4070a0; } /* Char */
code span.cn { color: #880000; } /* Constant */
code span.co { color: #60a0b0; font-style: italic; } /* Comment */
code span.cv { color: #60a0b0; font-weight: bold; font-style: italic; } /* CommentVar */
code span.do { color: #ba2121; font-style: italic; } /* Documentation */
code span.dt { color: #902000; } /* DataType */
code span.dv { color: #40a070; } /* DecVal */
code span.er { color: #ff0000; font-weight: bold; } /* Error */
code span.ex { } /* Extension */
code span.fl { color: #40a070; } /* Float */
code span.fu { color: #06287e; } /* Function */
code span.im { } /* Import */
code span.in { color: #60a0b0; font-weight: bold; font-style: italic; } /* Information */
code span.kw { color: #007020; font-weight: bold; } /* Keyword */
code span.op { color: #666666; } /* Operator */
code span.ot { color: #007020; } /* Other */
code span.pp { color: #bc7a00; } /* Preprocessor */
code span.sc { color: #4070a0; } /* SpecialChar */
code span.ss { color: #bb6688; } /* SpecialString */
code span.st { color: #4070a0; } /* String */
code span.va { color: #19177c; } /* Variable */
code span.vs { color: #4070a0; } /* VerbatimString */
code span.wa { color: #60a0b0; font-weight: bold; font-style: italic; } /* Warning */
</style>

<link rel="stylesheet" href="style.css" type="text/css" />
</head>

<body>



  <div class="book without-animation with-summary font-size-2 font-family-1" data-basepath=".">

    <div class="book-summary">
      <nav role="navigation">

<ul class="summary">
<li><a href="./">Principles of uncertainty</a></li>

<li class="divider"></li>
<li class="chapter" data-level="" data-path="index.html"><a href="index.html"><i class="fa fa-check"></i>Preface</a></li>
<li class="chapter" data-level="1" data-path="introduction.html"><a href="introduction.html"><i class="fa fa-check"></i><b>1</b> Probability spaces</a><ul>
<li class="chapter" data-level="1.1" data-path="introduction.html"><a href="introduction.html#measure-and-probability-spaces"><i class="fa fa-check"></i><b>1.1</b> Measure and probability spaces</a></li>
<li class="chapter" data-level="1.2" data-path="introduction.html"><a href="introduction.html#properties-of-probability-measures"><i class="fa fa-check"></i><b>1.2</b> Properties of probability measures</a></li>
<li class="chapter" data-level="1.3" data-path="introduction.html"><a href="introduction.html#discrete-probability-spaces"><i class="fa fa-check"></i><b>1.3</b> Discrete probability spaces</a></li>
</ul></li>
<li class="chapter" data-level="2" data-path="uprobspaces.html"><a href="uprobspaces.html"><i class="fa fa-check"></i><b>2</b> Uncountable probability spaces</a><ul>
<li class="chapter" data-level="2.1" data-path="uprobspaces.html"><a href="uprobspaces.html#bset"><i class="fa fa-check"></i><b>2.1</b> Borel sets</a></li>
<li class="chapter" data-level="2.2" data-path="uprobspaces.html"><a href="uprobspaces.html#lebesgue-measure"><i class="fa fa-check"></i><b>2.2</b> Lebesgue measure</a></li>
</ul></li>
<li class="chapter" data-level="3" data-path="condprob.html"><a href="condprob.html"><i class="fa fa-check"></i><b>3</b> Conditional probability</a><ul>
<li class="chapter" data-level="3.1" data-path="condprob.html"><a href="condprob.html#calculating-conditional-probabilities"><i class="fa fa-check"></i><b>3.1</b> Calculating conditional probabilities</a></li>
<li class="chapter" data-level="3.2" data-path="condprob.html"><a href="condprob.html#conditional-independence"><i class="fa fa-check"></i><b>3.2</b> Conditional independence</a></li>
<li class="chapter" data-level="3.3" data-path="condprob.html"><a href="condprob.html#monty-hall-problem"><i class="fa fa-check"></i><b>3.3</b> Monty Hall problem</a></li>
</ul></li>
<li class="chapter" data-level="4" data-path="rvs.html"><a href="rvs.html"><i class="fa fa-check"></i><b>4</b> Random variables</a><ul>
<li class="chapter" data-level="4.1" data-path="rvs.html"><a href="rvs.html#general-properties-and-calculations"><i class="fa fa-check"></i><b>4.1</b> General properties and calculations</a></li>
<li class="chapter" data-level="4.2" data-path="rvs.html"><a href="rvs.html#discrete-random-variables"><i class="fa fa-check"></i><b>4.2</b> Discrete random variables</a></li>
<li class="chapter" data-level="4.3" data-path="rvs.html"><a href="rvs.html#continuous-random-variables"><i class="fa fa-check"></i><b>4.3</b> Continuous random variables</a></li>
<li class="chapter" data-level="4.4" data-path="rvs.html"><a href="rvs.html#singular-random-variables"><i class="fa fa-check"></i><b>4.4</b> Singular random variables</a></li>
<li class="chapter" data-level="4.5" data-path="rvs.html"><a href="rvs.html#transformations"><i class="fa fa-check"></i><b>4.5</b> Transformations</a></li>
</ul></li>
<li class="appendix"><span><b>Appendix</b></span></li>
<li class="chapter" data-level="A" data-path="A1.html"><a href="A1.html"><i class="fa fa-check"></i><b>A</b> R programming language</a><ul>
<li class="chapter" data-level="A.1" data-path="A1.html"><a href="A1.html#basic-characteristics"><i class="fa fa-check"></i><b>A.1</b> Basic characteristics</a></li>
<li class="chapter" data-level="A.2" data-path="A1.html"><a href="A1.html#why-r"><i class="fa fa-check"></i><b>A.2</b> Why R?</a></li>
<li class="chapter" data-level="A.3" data-path="A1.html"><a href="A1.html#setting-up"><i class="fa fa-check"></i><b>A.3</b> Setting up</a><ul>
<li class="chapter" data-level="A.3.1" data-path="A1.html"><a href="A1.html#rstudio"><i class="fa fa-check"></i><b>A.3.1</b> RStudio</a></li>
<li class="chapter" data-level="A.3.2" data-path="A1.html"><a href="A1.html#libraries-for-data-science"><i class="fa fa-check"></i><b>A.3.2</b> Libraries for data science</a></li>
</ul></li>
<li class="chapter" data-level="A.4" data-path="A1.html"><a href="A1.html#r-basics"><i class="fa fa-check"></i><b>A.4</b> R basics</a><ul>
<li class="chapter" data-level="A.4.1" data-path="A1.html"><a href="A1.html#variables-and-types"><i class="fa fa-check"></i><b>A.4.1</b> Variables and types</a></li>
<li class="chapter" data-level="A.4.2" data-path="A1.html"><a href="A1.html#basic-operations"><i class="fa fa-check"></i><b>A.4.2</b> Basic operations</a></li>
<li class="chapter" data-level="A.4.3" data-path="A1.html"><a href="A1.html#vectors"><i class="fa fa-check"></i><b>A.4.3</b> Vectors</a></li>
<li class="chapter" data-level="A.4.4" data-path="A1.html"><a href="A1.html#factors"><i class="fa fa-check"></i><b>A.4.4</b> Factors</a></li>
<li class="chapter" data-level="A.4.5" data-path="A1.html"><a href="A1.html#matrices"><i class="fa fa-check"></i><b>A.4.5</b> Matrices</a></li>
<li class="chapter" data-level="A.4.6" data-path="A1.html"><a href="A1.html#arrays"><i class="fa fa-check"></i><b>A.4.6</b> Arrays</a></li>
<li class="chapter" data-level="A.4.7" data-path="A1.html"><a href="A1.html#data-frames"><i class="fa fa-check"></i><b>A.4.7</b> Data frames</a></li>
<li class="chapter" data-level="A.4.8" data-path="A1.html"><a href="A1.html#lists"><i class="fa fa-check"></i><b>A.4.8</b> Lists</a></li>
<li class="chapter" data-level="A.4.9" data-path="A1.html"><a href="A1.html#loops"><i class="fa fa-check"></i><b>A.4.9</b> Loops</a></li>
</ul></li>
<li class="chapter" data-level="A.5" data-path="A1.html"><a href="A1.html#functions"><i class="fa fa-check"></i><b>A.5</b> Functions</a><ul>
<li class="chapter" data-level="A.5.1" data-path="A1.html"><a href="A1.html#writing-functions"><i class="fa fa-check"></i><b>A.5.1</b> Writing functions</a></li>
</ul></li>
<li class="chapter" data-level="A.6" data-path="A1.html"><a href="A1.html#other-tips"><i class="fa fa-check"></i><b>A.6</b> Other tips</a></li>
<li class="chapter" data-level="A.7" data-path="A1.html"><a href="A1.html#further-reading-and-references"><i class="fa fa-check"></i><b>A.7</b> Further reading and references</a></li>
</ul></li>
<li class="chapter" data-level="B" data-path="probability-distributions.html"><a href="probability-distributions.html"><i class="fa fa-check"></i><b>B</b> Probability distributions</a></li>
<li class="chapter" data-level="" data-path="references.html"><a href="references.html"><i class="fa fa-check"></i>References</a></li>
<li class="divider"></li>
<li><a href="https://github.com/rstudio/bookdown" target="blank">Published with bookdown</a></li>      
</ul>

      </nav>
    </div>

    <div class="book-body">
      <div class="body-inner">
        <div class="book-header" role="navigation">
          <h1>
            <i class="fa fa-circle-o-notch fa-spin"></i><a href="./">Principles of Uncertainty – exercises</a>
          </h1>
        </div>

        <div class="page-wrapper" tabindex="-1" role="main">
          <div class="page-inner">

            <section class="normal" id="section-">
<div id="rvs" class="section level1">
<h1><span class="header-section-number">Chapter 4</span> Random variables</h1>
<p>This chapter deals with random variables and their distributions.</p>
<p>The students are expected to acquire the following knowledge:</p>
<p><strong>Theoretical</strong></p>
<ul>
<li>Identification of random variables.</li>
<li>Convolutions of random variables.</li>
<li>Derivation of PDF, PMF, CDF, and quantile function.</li>
<li>Definitions and properties of common discrete random variables.</li>
<li>Definitions and properties of common continuous random variables.</li>
<li>Transforming univariate random variables.</li>
</ul>
<p><strong>R</strong></p>
<ul>
<li>Familiarize with PDF, PMF, CDF, and quantile functions for several distributions.</li>
<li>Visual inspection of probability distributions.</li>
<li>Analytical and empirical calculation of probabilities based on distributions.</li>
<li>New R functions for plotting (for example, <em>facet_wrap</em>).</li>
<li>Creating random number generators based on the Uniform distribution.</li>
</ul>
<style>
.fold-btn { 
  float: right; 
  margin: 5px 5px 0 0;
}
.fold { 
  border: 1px solid black;
  min-height: 40px;
}
</style>
<script type="text/javascript">
$(document).ready(function() {
  $folds = $(".fold");
  $folds.wrapInner("<div class=\"fold-blck\">"); // wrap a div container around content
  $folds.prepend("<button class=\"fold-btn\">Unfold</button>");  // add a button
  $(".fold-blck").toggle();  // fold all blocks
  $(".fold-btn").on("click", function() {  // add onClick event
    $(this).text($(this).text() === "Fold" ? "Unfold" : "Fold");  // if the text equals "Fold", change it to "Unfold"or else to "Fold" 
    $(this).next(".fold-blck").toggle("linear");  // "swing" is the default easing function. This can be further customized in its speed or the overall animation itself.
  })
});
</script>
<div id="general-properties-and-calculations" class="section level2">
<h2><span class="header-section-number">4.1</span> General properties and calculations</h2>

<div class="exercise">
<p><span id="exr:unnamed-chunk-77" class="exercise"><strong>Exercise 4.1  </strong></span>Which of the functions below are valid CDFs? Find their respective densities.
<span style="color:blue">R: Plot the three functions.</span></p>
<ol style="list-style-type: lower-alpha">
<li><p><span class="math display">\[\begin{equation}
  F(x) = \begin{cases}
         1 - e^{-x^2} &amp; x \geq 0    \\
         0 &amp; x &lt; 0.
       \end{cases}
\end{equation}\]</span></p></li>
<li><p><span class="math display">\[\begin{equation}
  F(x) = \begin{cases}
        e^{-\frac{1}{x}} &amp; x &gt; 0    \\
         0 &amp; x \leq 0.
       \end{cases}
\end{equation}\]</span></p></li>
<li><p><span class="math display">\[\begin{equation}
  F(x) = \begin{cases}
        0 &amp; x \leq 0 \\
        \frac{1}{3} &amp; 0 &lt; x \leq \frac{1}{2} \\
        1 &amp; x &gt; \frac{1}{2}.
      \end{cases}
\end{equation}\]</span></p></li>
</ol>
</div>

<div class="fold">

<div class="solution">
<p> <span class="solution"><em>Solution. </em></span> </p>
<ol style="list-style-type: lower-alpha">
<li>Yes.</li>
</ol>
<ul>
<li>First, let us check the limits.
<span class="math inline">\(\lim_{x \rightarrow -\infty} (0) = 0\)</span>.
<span class="math inline">\(\lim_{x \rightarrow \infty} (1 - e^{-x^2}) = 1 - \lim_{x \rightarrow \infty} e^{-x^2} = 1 - 0 = 1\)</span>.</li>
<li>Second, let us check whether the function is increasing. Let <span class="math inline">\(x &gt; y \geq 0\)</span>.
Then <span class="math inline">\(1 - e^{-x^2} \geq 1 - e^{-y^2}\)</span>.</li>
<li>We only have to check right continuity for the point zero. <span class="math inline">\(F(0) = 0\)</span> and
<span class="math inline">\(\lim_{\epsilon \downarrow 0}F (0 + \epsilon) =  \lim_{\epsilon \downarrow 0} 1 - e^{-\epsilon^2} =  1 - \lim_{\epsilon \downarrow 0} e^{-\epsilon^2} =  1 - 1 = 0\)</span>.</li>
<li>We get the density by differentiating the CDF.
<span class="math inline">\(p(x) = \frac{d}{dx} 1 - e^{-x^2} = 2xe^{-x^2}.\)</span> Students are encouraged to
check that this is a proper PDF.</li>
</ul>
<ol start="2" style="list-style-type: lower-alpha">
<li>Yes.</li>
</ol>
<ul>
<li>First, let us check the limits.
$_{x -} (0) = 0 and
<span class="math inline">\(\lim_{x \rightarrow \infty} (e^{-\frac{1}{x}}) = 1\)</span>.</li>
<li>Second, let us check whether the function is increasing. Let <span class="math inline">\(x &gt; y \geq 0\)</span>.
Then <span class="math inline">\(e^{-\frac{1}{x}} \geq e^{-\frac{1}{y}}\)</span>.</li>
<li>We only have to check right continuity for the point zero. <span class="math inline">\(F(0) = 0\)</span> and
<span class="math inline">\(\lim_{\epsilon \downarrow 0}F (0 + \epsilon) =  \lim_{\epsilon \downarrow 0} e^{-\frac{1}{\epsilon}} = 0\)</span>.</li>
<li>We get the density by differentiating the CDF.
<span class="math inline">\(p(x) = \frac{d}{dx} e^{-\frac{1}{x}} = \frac{1}{x^2}e^{-\frac{1}{x}}.\)</span>
Students are encouraged to
check that this is a proper PDF.</li>
</ul>
<ol start="3" style="list-style-type: lower-alpha">
<li>No. The function is not right continuous as <span class="math inline">\(F(\frac{1}{2}) = \frac{1}{3}\)</span>,
but <span class="math inline">\(\lim_{\epsilon \downarrow 0} F(\frac{1}{2} + \epsilon) = 1\)</span>.</li>
</ol>
</div>
<pre class="sourceCode r"><code class="sourceCode r">f1 &lt;-<span class="st"> </span><span class="cf">function</span> (x) {
  tmp        &lt;-<span class="st"> </span><span class="dv">1</span> <span class="op">-</span><span class="st"> </span><span class="kw">exp</span>(<span class="op">-</span>x<span class="op">^</span><span class="dv">2</span>)
  tmp[x <span class="op">&lt;</span><span class="st"> </span><span class="dv">0</span>] &lt;-<span class="st"> </span><span class="dv">0</span>
  <span class="kw">return</span>(tmp)
}

f2 &lt;-<span class="st"> </span><span class="cf">function</span> (x) {
  tmp         &lt;-<span class="st"> </span><span class="kw">exp</span>(<span class="op">-</span>(<span class="dv">1</span> <span class="op">/</span><span class="st"> </span>x))
  tmp[x <span class="op">&lt;=</span><span class="st"> </span><span class="dv">0</span>] &lt;-<span class="st"> </span><span class="dv">0</span>
  <span class="kw">return</span>(tmp)
}

f3 &lt;-<span class="st"> </span><span class="cf">function</span> (x) {
  tmp           &lt;-<span class="st"> </span>x
  tmp[x <span class="op">==</span><span class="st"> </span>x]   &lt;-<span class="st"> </span><span class="dv">1</span>
  tmp[x <span class="op">&lt;=</span><span class="st"> </span><span class="fl">0.5</span>] &lt;-<span class="st"> </span><span class="dv">1</span><span class="op">/</span><span class="dv">3</span>
  tmp[x <span class="op">&lt;=</span><span class="st"> </span><span class="dv">0</span>]   &lt;-<span class="st"> </span><span class="dv">0</span>
  <span class="kw">return</span>(tmp)
}

cdf_data &lt;-<span class="st"> </span><span class="kw">tibble</span>(<span class="dt">x  =</span> <span class="kw">seq</span>(<span class="op">-</span><span class="dv">1</span>, <span class="dv">20</span>, <span class="dt">by =</span> <span class="fl">0.001</span>),
                   <span class="dt">f1 =</span> <span class="kw">f1</span>(x),
                   <span class="dt">f2 =</span> <span class="kw">f2</span>(x),
                   <span class="dt">f3 =</span> <span class="kw">f3</span>(x)) <span class="op">%&gt;%</span>
<span class="st">  </span><span class="kw">melt</span>(<span class="dt">id.vars =</span> <span class="st">&quot;x&quot;</span>)


cdf_plot &lt;-<span class="st"> </span><span class="kw">ggplot</span>(<span class="dt">data =</span> cdf_data, <span class="kw">aes</span>(<span class="dt">x =</span> x, <span class="dt">y =</span> value, <span class="dt">color =</span> variable)) <span class="op">+</span>
<span class="st">  </span><span class="kw">geom_hline</span>(<span class="dt">yintercept =</span> <span class="dv">1</span>) <span class="op">+</span>
<span class="st">  </span><span class="kw">geom_line</span>()
<span class="kw">plot</span>(cdf_plot)</code></pre>
<p><img src="bookdown-pou_files/figure-html/unnamed-chunk-79-1.png" width="672" /></p>
</div>

<div class="exercise">
<p><span id="exr:unnamed-chunk-80" class="exercise"><strong>Exercise 4.2  </strong></span>Let <span class="math inline">\(X\)</span> be a random variable with CDF
<span class="math display">\[\begin{equation}
  F(x) = \begin{cases}
            0 &amp; x &lt; 0 \\
            \frac{x^2}{2} &amp; 0 \leq x &lt; 1 \\
            \frac{1}{2} + \frac{p}{2} &amp; 1 \leq x &lt; 2 \\
            \frac{1}{2} + \frac{p}{2} + \frac{1 - p}{2} &amp; x \geq 2
          \end{cases}
\end{equation}\]</span></p>
<ol style="list-style-type: lower-alpha">
<li><p><span style="color:blue">R: Plot this CDF for <span class="math inline">\(p = 0.3\)</span>. Is it a discrete,
continuous, or mixed random
varible?</span></p></li>
<li><p>Find the probability density/mass of <span class="math inline">\(X\)</span>.</p></li>
</ol>
</div>

<div class="fold">

<pre class="sourceCode r"><code class="sourceCode r">f1 &lt;-<span class="st"> </span><span class="cf">function</span> (x, p) {
  tmp          &lt;-<span class="st"> </span>x
  tmp[x <span class="op">&gt;=</span><span class="st"> </span><span class="dv">2</span>]  &lt;-<span class="st"> </span><span class="fl">0.5</span> <span class="op">+</span><span class="st"> </span>(p <span class="op">*</span><span class="st"> </span><span class="fl">0.5</span>) <span class="op">+</span><span class="st"> </span>((<span class="dv">1</span><span class="op">-</span>p) <span class="op">*</span><span class="st"> </span><span class="fl">0.5</span>)
  tmp[x <span class="op">&lt;</span><span class="st"> </span><span class="dv">2</span>]   &lt;-<span class="st"> </span><span class="fl">0.5</span> <span class="op">+</span><span class="st"> </span>(p <span class="op">*</span><span class="st"> </span><span class="fl">0.5</span>) 
  tmp[x <span class="op">&lt;</span><span class="st"> </span><span class="dv">1</span>]   &lt;-<span class="st"> </span>(x[x <span class="op">&lt;</span><span class="st"> </span><span class="dv">1</span>])<span class="op">^</span><span class="dv">2</span> <span class="op">/</span><span class="st"> </span><span class="dv">2</span>
  tmp[x <span class="op">&lt;</span><span class="st"> </span><span class="dv">0</span>]   &lt;-<span class="st"> </span><span class="dv">0</span>
  <span class="kw">return</span>(tmp)
}

cdf_data &lt;-<span class="st"> </span><span class="kw">tibble</span>(<span class="dt">x =</span> <span class="kw">seq</span>(<span class="op">-</span><span class="dv">1</span>, <span class="dv">5</span>, <span class="dt">by =</span> <span class="fl">0.001</span>), <span class="dt">y =</span> <span class="kw">f1</span>(x, <span class="fl">0.3</span>))
cdf_plot &lt;-<span class="st"> </span><span class="kw">ggplot</span>(<span class="dt">data =</span> cdf_data, <span class="kw">aes</span>(<span class="dt">x =</span> x, <span class="dt">y =</span> y)) <span class="op">+</span>
<span class="st">  </span><span class="kw">geom_hline</span>(<span class="dt">yintercept =</span> <span class="dv">1</span>) <span class="op">+</span>
<span class="st">  </span><span class="kw">geom_line</span>(<span class="dt">color =</span> <span class="st">&quot;blue&quot;</span>)
<span class="kw">plot</span>(cdf_plot)</code></pre>
<img src="bookdown-pou_files/figure-html/unnamed-chunk-81-1.png" width="672" />

<div class="solution">
<p> <span class="solution"><em>Solution. </em></span> </p>
<ol style="list-style-type: lower-alpha">
<li><p><span class="math inline">\(X\)</span> is a mixed random variable.</p></li>
<li><p>Since <span class="math inline">\(X\)</span> is a mixed random variable, we have to find the PDF of the
continuous part and the PMF of the discrete part. We get the continuous
part by differentiating the corresponding CDF, <span class="math inline">\(\frac{d}{dx}\frac{x^2}{2} = x\)</span>.
So the PDF, when <span class="math inline">\(0 \leq x &lt; 1\)</span>, is <span class="math inline">\(p(x) = x\)</span>. Let us look at the discrete
part now. It has two steps, so this is a discrete distribution with two
outcomes – numbers 1 and 2. The first happens with probability
<span class="math inline">\(\frac{p}{2}\)</span>, and the second with probability <span class="math inline">\(\frac{1 - p}{2}\)</span>. This reminds
us of the Bernoulli distribution. The PMF
for the discrete part is <span class="math inline">\(P(X = x) = (\frac{p}{2})^{2 - x} (\frac{1 - p}{2})^{x - 1}\)</span>.</p>
</div></li>
</ol>
</div>

<div class="exercise">
<p><span id="exr:conv" class="exercise"><strong>Exercise 4.3  (Convolutions)  </strong></span>Convolutions are probability distributions that correspond to sums of
independent random variables.</p>
<ol style="list-style-type: lower-alpha">
<li><p>Let <span class="math inline">\(X\)</span> and <span class="math inline">\(Y\)</span> be independent discrete variables.
Find the PMF of <span class="math inline">\(Z = X + Y\)</span>. Hint: Use the law of
total probability.</p></li>
<li><p>Let <span class="math inline">\(X\)</span> and <span class="math inline">\(Y\)</span> be independent continuous variables.
Find the PDF of <span class="math inline">\(Z = X + Y\)</span>.
Hint: Start with the CDF.</p></li>
</ol>
</div>

<div class="fold">

<div class="solution">
<p> <span class="solution"><em>Solution. </em></span> </p>
<ol style="list-style-type: lower-alpha">
<li><p><span class="math display">\[\begin{align}
P(Z = z) &amp;= P(X + Y = z) &amp; \\ 
         &amp;= \sum_{k = -\infty}^\infty P(X + Y = z | Y = k) P(Y = k) &amp; \text{ (law of total probability)} \\
         &amp;= \sum_{k = -\infty}^\infty P(X + k = z | Y = k) P(Y = k) &amp; \\
         &amp;= \sum_{k = -\infty}^\infty P(X + k = z) P(Y = k) &amp; \text{ (independence of $X$ and $Y$)} \\
         &amp;= \sum_{k = -\infty}^\infty P(X = z - k) P(Y = k). &amp;
\end{align}\]</span></p></li>
<li><p>Let <span class="math inline">\(f\)</span> and <span class="math inline">\(g\)</span> be the PDFs of <span class="math inline">\(X\)</span> and <span class="math inline">\(Y\)</span> respectively.
<span class="math display">\[\begin{align}
  F(z)     &amp;= P(Z &lt; z) \\ 
        &amp;= P(X + Y &lt; z) \\ 
        &amp;= \int_{-\infty}^{\infty} P(X + Y &lt; z | Y = y)P(Y = y)dy \\
        &amp;= \int_{-\infty}^{\infty} P(X + y &lt; z | Y = y)P(Y = y)dy \\
        &amp;= \int_{-\infty}^{\infty} P(X + y &lt; z)P(Y = y)dy \\
        &amp;= \int_{-\infty}^{\infty} P(X &lt; z - y)P(Y = y)dy \\
        &amp;= \int_{-\infty}^{\infty} (\int_{-\infty}^{z - y} f(x) dx) g(y) dy
\end{align}\]</span>
Now
<span class="math display">\[\begin{align}
  p(z) &amp;= \frac{d}{dz} F(z) &amp; \\
    &amp;= \int_{-\infty}^{\infty} (\frac{d}{dz}\int_{-\infty}^{z - y} f(x) dx) g(y) dy &amp; \\
    &amp;= \int_{-\infty}^{\infty} f(z - y) g(y) dy &amp; \text{ (fundamental theorem of calculus)}.
\end{align}\]</span></p>
</div></li>
</ol>
</div>
</div>
<div id="discrete-random-variables" class="section level2">
<h2><span class="header-section-number">4.2</span> Discrete random variables</h2>

<div class="exercise">
<p><span id="exr:bincdf" class="exercise"><strong>Exercise 4.4  (Binomial random variable)  </strong></span>Let <span class="math inline">\(X_k\)</span>, <span class="math inline">\(k = 1,...,n\)</span>, be random variables with the Bernoulli measure as the
PMF. Let <span class="math inline">\(X = \sum_{k=1}^n X_k\)</span>.</p>
<ol style="list-style-type: lower-alpha">
<li><p>We call <span class="math inline">\(X_k\)</span> a Bernoulli random variable with parameter <span class="math inline">\(p \in (0,1)\)</span>.
Find the CDF of <span class="math inline">\(X_k\)</span>.</p></li>
<li><p>Find PMF of <span class="math inline">\(X\)</span>.
This is a Binomial random variable with support in <span class="math inline">\(\{0,1,2,...,n\}\)</span> and
parameters <span class="math inline">\(p \in (0,1)\)</span> and <span class="math inline">\(n \in \mathbb{N}_0\)</span>. We denote
<span class="math display">\[\begin{equation}
  X | n,p \sim \text{binomial}(n,p).
\end{equation}\]</span></p></li>
<li><p>Find CDF of <span class="math inline">\(X\)</span>.</p></li>
<li><p><span style="color:blue">R: Simulate from the binomial distribution
with <span class="math inline">\(n = 10\)</span> and <span class="math inline">\(p = 0.5\)</span>, and from <span class="math inline">\(n\)</span> Bernoulli distributions with
<span class="math inline">\(p = 0.5\)</span>. Visually compare the sum of Bernoullis and the binomial. Hint:
there is no standard function like <em>rpois</em> for a Bernoulli random
variable. Check exercise <a href="introduction.html#exr:binomialpmf">1.11</a> to find out how to sample
from a Bernoulli
distribution.</span></p></li>
</ol>
</div>

<div class="fold">

<div class="solution">
<p> <span class="solution"><em>Solution. </em></span> </p>
<ol style="list-style-type: lower-alpha">
<li><p>There are two outcomes – zero and one. Zero happens with probability
<span class="math inline">\(1 - p\)</span>. Therefore
<span class="math display">\[\begin{equation}
  F(k) = \begin{cases}
         0 &amp; k &lt; 0 \\
         1 - p &amp; 0 \leq k &lt; 1 \\
         1 &amp; k \geq 1.
       \end{cases}
\end{equation}\]</span></p></li>
<li><p>For the probability of <span class="math inline">\(X\)</span> to be equal to some <span class="math inline">\(k \leq n\)</span>, exactly <span class="math inline">\(k\)</span>
Bernoulli variables need to be one, and the others zero. So <span class="math inline">\(p^k(1-p)^{n-k}\)</span>.
There are <span class="math inline">\(\binom{n}{k}\)</span> such possible arrangements. Therefore
<span class="math display">\[\begin{align}
  P(X = k) = \binom{n}{k} p^k (1 - p)^{n-k}.
\end{align}\]</span></p></li>
<li><p><span class="math display">\[\begin{equation}
  F(k) = \sum_{i = 0}^{\lfloor k \rfloor} \binom{n}{i} p^i (1 - p)^{n - i}
\end{equation}\]</span><br />
</p>
</div></li>
</ol>
<pre class="sourceCode r"><code class="sourceCode r"><span class="kw">set.seed</span>(<span class="dv">1</span>)
nsamps        &lt;-<span class="st"> </span><span class="dv">10000</span>
binom_samp    &lt;-<span class="st"> </span><span class="kw">rbinom</span>(nsamps, <span class="dt">size =</span> <span class="dv">10</span>, <span class="dt">prob =</span> <span class="fl">0.5</span>)
bernoulli_mat &lt;-<span class="st"> </span><span class="kw">matrix</span>(<span class="dt">data =</span> <span class="ot">NA</span>, <span class="dt">nrow =</span> nsamps, <span class="dt">ncol =</span> <span class="dv">10</span>)
<span class="cf">for</span> (i <span class="cf">in</span> <span class="dv">1</span><span class="op">:</span>nsamps) {
  bernoulli_mat[i, ] &lt;-<span class="st"> </span><span class="kw">rbinom</span>(<span class="dv">10</span>, <span class="dt">size =</span> <span class="dv">1</span>, <span class="dt">prob =</span> <span class="fl">0.5</span>)
}
bern_samp &lt;-<span class="st"> </span><span class="kw">apply</span>(bernoulli_mat, <span class="dv">1</span>, sum)
b_data    &lt;-<span class="st"> </span><span class="kw">tibble</span>(<span class="dt">x    =</span> <span class="kw">c</span>(binom_samp, bern_samp), 
                    <span class="dt">type =</span> <span class="kw">c</span>(<span class="kw">rep</span>(<span class="st">&quot;binomial&quot;</span>, <span class="dv">10000</span>), <span class="kw">rep</span>(<span class="st">&quot;Bernoulli_sum&quot;</span>, <span class="dv">10000</span>)))
b_plot    &lt;-<span class="st"> </span><span class="kw">ggplot</span>(<span class="dt">data =</span> b_data, <span class="kw">aes</span>(<span class="dt">x =</span> x, <span class="dt">fill =</span> type)) <span class="op">+</span>
<span class="st">  </span><span class="kw">geom_bar</span>(<span class="dt">position =</span> <span class="st">&quot;dodge&quot;</span>)
<span class="kw">plot</span>(b_plot)</code></pre>
<p><img src="bookdown-pou_files/figure-html/unnamed-chunk-85-1.png" width="672" /></p>
</div>

<div class="exercise">
<p><span id="exr:geocdf" class="exercise"><strong>Exercise 4.5  (Geometric random variable)  </strong></span>A variable with PMF
<span class="math display">\[\begin{equation}
  P(k) = p(1-p)^k
\end{equation}\]</span>
is a geometric random
variable with support in non-negative
integers. It has one parameter
<span class="math inline">\(p \in (0,1]\)</span>. We denote
<span class="math display">\[\begin{equation}
  X | p \sim \text{geometric}(p)
\end{equation}\]</span></p>
<ol style="list-style-type: lower-alpha">
<li><p>Derive the CDF of a geometric random variable.</p></li>
<li><p><span style="color:blue">R: Draw 1000 samples from the geometric
distribution with <span class="math inline">\(p = 0.3\)</span> and compare their frequencies to
theoretical values.</span></p></li>
</ol>
</div>

<div class="fold">

<div class="solution">
<p> <span class="solution"><em>Solution. </em></span> </p>
<ol style="list-style-type: lower-alpha">
<li><span class="math display">\[\begin{align}
P(X \leq k) &amp;= \sum_{i = 0}^k p(1-p)^i \\
          &amp;= p \sum_{i = 0}^k (1-p)^i \\
          &amp;= p \frac{1 - (1-p)^{k+1}}{1 - (1 - p)} \\
          &amp;= 1 - (1-p)^{k + 1}
\end{align}\]</span></li>
</ol>
</div>
<pre class="sourceCode r"><code class="sourceCode r"><span class="kw">set.seed</span>(<span class="dv">1</span>)
geo_samp &lt;-<span class="st"> </span><span class="kw">rgeom</span>(<span class="dt">n =</span> <span class="dv">1000</span>, <span class="dt">prob =</span> <span class="fl">0.3</span>)
geo_samp &lt;-<span class="st"> </span><span class="kw">data.frame</span>(<span class="dt">x =</span> geo_samp) <span class="op">%&gt;%</span>
<span class="st">  </span><span class="kw">count</span>(x) <span class="op">%&gt;%</span>
<span class="st">  </span><span class="kw">mutate</span>(<span class="dt">n =</span> n <span class="op">/</span><span class="st"> </span><span class="dv">1000</span>, <span class="dt">type =</span> <span class="st">&quot;empirical_frequencies&quot;</span>) <span class="op">%&gt;%</span>
<span class="st">  </span><span class="kw">bind_rows</span>(<span class="kw">data.frame</span>(<span class="dt">x =</span> <span class="dv">0</span><span class="op">:</span><span class="dv">20</span>, <span class="dt">n =</span> <span class="kw">dgeom</span>(<span class="dv">0</span><span class="op">:</span><span class="dv">20</span>, <span class="dt">prob =</span> <span class="fl">0.3</span>), <span class="dt">type =</span> <span class="st">&quot;theoretical_measure&quot;</span>))

geo_plot &lt;-<span class="st"> </span><span class="kw">ggplot</span>(<span class="dt">data =</span> geo_samp, <span class="kw">aes</span>(<span class="dt">x =</span> x, <span class="dt">y =</span> n, <span class="dt">fill =</span> type)) <span class="op">+</span>
<span class="st">  </span><span class="kw">geom_bar</span>(<span class="dt">stat=</span><span class="st">&quot;identity&quot;</span>, <span class="dt">position =</span> <span class="st">&quot;dodge&quot;</span>)
<span class="kw">plot</span>(geo_plot)</code></pre>
<p><img src="bookdown-pou_files/figure-html/unnamed-chunk-87-1.png" width="672" /></p>
</div>

<div class="exercise">
<p><span id="exr:poisex" class="exercise"><strong>Exercise 4.6  (Poisson random variable)  </strong></span>A variable with PMF
<span class="math display">\[\begin{equation}
  P(k) = \frac{\lambda^k e^{-\lambda}}{k!}
\end{equation}\]</span>
is a Poisson random
variable with support in non-negative integers. It has one positive parameter
<span class="math inline">\(\lambda\)</span>,
which also represents its mean value and variance (a measure of the deviation
of the values from the mean – more on mean and variance in the next chapter).
We denote
<span class="math display">\[\begin{equation}
  X | \lambda \sim \text{Poisson}(\lambda).
\end{equation}\]</span>
This distribution is usually the default choice for modeling counts. We have
already encountered a Poisson random variable in exercise <a href="introduction.html#exr:geopoispmf">1.12</a>,
where we also sampled from this distribution.</p>
<p>The CDF of a Poisson random variable is <span class="math inline">\(P(X &lt;= x) = e^{-\lambda} \sum_{i=0}^x \frac{\lambda^{i}}{i!}\)</span>.</p>
<ol style="list-style-type: lower-alpha">
<li><span style="color:blue">R: Draw 1000 samples from the Poisson
distribution with <span class="math inline">\(\lambda = 5\)</span> and compare their empirical cumulative
distribution function with the theoretical CDF.</span></li>
</ol>
</div>

<div class="fold">
<pre class="sourceCode r"><code class="sourceCode r"><span class="kw">set.seed</span>(<span class="dv">1</span>)
pois_samp &lt;-<span class="st"> </span><span class="kw">rpois</span>(<span class="dt">n =</span> <span class="dv">1000</span>, <span class="dt">lambda =</span> <span class="dv">5</span>)
pois_samp &lt;-<span class="st"> </span><span class="kw">data.frame</span>(<span class="dt">x =</span> pois_samp)
pois_plot &lt;-<span class="st"> </span><span class="kw">ggplot</span>(<span class="dt">data =</span> pois_samp, <span class="kw">aes</span>(<span class="dt">x =</span> x, <span class="dt">colour =</span> <span class="st">&quot;ECDF&quot;</span>)) <span class="op">+</span>
<span class="st">  </span><span class="kw">stat_ecdf</span>(<span class="dt">geom =</span> <span class="st">&quot;step&quot;</span>) <span class="op">+</span>
<span class="st">  </span><span class="kw">geom_step</span>(<span class="dt">data =</span> <span class="kw">tibble</span>(<span class="dt">x =</span> <span class="dv">0</span><span class="op">:</span><span class="dv">17</span>, <span class="dt">y =</span> <span class="kw">ppois</span>(x, <span class="dv">5</span>)), <span class="kw">aes</span>(<span class="dt">x =</span> x, <span class="dt">y =</span> y, <span class="dt">colour =</span> <span class="st">&quot;CDF&quot;</span>)) <span class="op">+</span>
<span class="st">  </span><span class="kw">scale_colour_manual</span>(<span class="st">&quot;Lgend title&quot;</span>, <span class="dt">values =</span> <span class="kw">c</span>(<span class="st">&quot;black&quot;</span>, <span class="st">&quot;red&quot;</span>))
<span class="kw">plot</span>(pois_plot)</code></pre>
<p><img src="bookdown-pou_files/figure-html/unnamed-chunk-88-1.png" width="672" /></p>
</div>

<div class="exercise">
<p><span id="exr:negbinpdf" class="exercise"><strong>Exercise 4.7  (Negative binomial random variable)  </strong></span>A variable with PMF
<span class="math display">\[\begin{equation}
  p(k) = \binom{k + r - 1}{k}(1-p)^r p^k
\end{equation}\]</span>
is a negative binomial random
variable with support in non-negative integers. It has two parameters
<span class="math inline">\(r &gt; 0\)</span> and <span class="math inline">\(p \in (0,1)\)</span>. We denote
<span class="math display">\[\begin{equation}
  X | r,p \sim \text{NB}(r,p).
\end{equation}\]</span></p>
<ol style="list-style-type: lower-alpha">
<li><p>Let us reparameterize the negative binomial distribution with <span class="math inline">\(q = 1 - p\)</span>.
Find the PMF of <span class="math inline">\(X \sim \text{NB}(1, q)\)</span>. Do you recognize this distribution?</p></li>
<li><p>Show that the sum of two negative binomial random variables with the same
<span class="math inline">\(p\)</span> is also a negative binomial random variable. Hint: Use the fact that
the number of ways to place <span class="math inline">\(n\)</span> indistinct balls into <span class="math inline">\(k\)</span> boxes is
<span class="math inline">\(\binom{n + k - 1}{n}\)</span>.</p></li>
<li><p><span style="color:blue">R: Draw samples from <span class="math inline">\(X \sim \text{NB}(5, 0.4)\)</span>
and <span class="math inline">\(Y \sim \text{NB}(3, 0.4)\)</span>.
Draw samples from <span class="math inline">\(Z = X + Y\)</span>, where you use the parameters calculated in
b). Plot both distributions, their sum, and <span class="math inline">\(Z\)</span> using <em>facet_wrap</em>.
Be careful, as R uses a different
parameterization <em>size</em>=<span class="math inline">\(r\)</span> and <em>prob</em>=<span class="math inline">\(1 - p\)</span>.</span></p></li>
</ol>
</div>

<div class="fold">

<div class="solution">
<p> <span class="solution"><em>Solution. </em></span> </p>
<ol style="list-style-type: lower-alpha">
<li><p><span class="math display">\[\begin{align}
P(X = k) &amp;= \binom{k + 1 - 1}{k}q^1 (1-q)^k \\
         &amp;= q(1-q)^k.
\end{align}\]</span>
This is the geometric distribution.</p></li>
<li><p>Let <span class="math inline">\(X \sim \text{NB}(r_1, p)\)</span> and <span class="math inline">\(Y \sim \text{NB}(r_2, p)\)</span>.
Let <span class="math inline">\(Z = X + Y\)</span>.
<span class="math display">\[\begin{align}
  P(Z = z) &amp;= \sum_{k = 0}^{\infty} P(X = z - k)P(Y = k),  \text{   if k &lt; 0, then the probabilities are 0} \\
        &amp;= \sum_{k = 0}^{z} P(X = z - k)P(Y = k), \text{   if k &gt; z, then the probabilities are 0} \\
        &amp;= \sum_{k = 0}^{z} \binom{z - k + r_1 - 1}{z - k}(1 - p)^{r_1} p^{z - k} \binom{k + r_2 - 1}{k}(1 - p)^{r_2} p^{k} &amp; \\
        &amp;= \sum_{k = 0}^{z} \binom{z - k + r_1 - 1}{z - k} \binom{k + r_2 - 1}{k}(1 - p)^{r_1 + r_2} p^{z} &amp; \\
        &amp;= (1 - p)^{r_1 + r_2} p^{z} \sum_{k = 0}^{z} \binom{z - k + r_1 - 1}{z - k} \binom{k + r_2 - 1}{k}&amp;
\end{align}\]</span>
The part before the sum reminds us of the negative binomial distribution with
parameters <span class="math inline">\(r_1 + r_2\)</span> and <span class="math inline">\(p\)</span>. To complete this term to the
negative binomial PMF we need <span class="math inline">\(\binom{z + r_1 + r_2 -1}{z}\)</span>. So the
only thing we need to prove is that the sum equals this term.
Both terms in the sum can be interpreted as numbers of ways to
place a number of balls into boxes. For the left term it is
<span class="math inline">\(z-k\)</span> balls into <span class="math inline">\(r_1\)</span> boxes, and for the right <span class="math inline">\(k\)</span> balls into
<span class="math inline">\(r_2\)</span> boxes. For each <span class="math inline">\(k\)</span> we are distributing <span class="math inline">\(z\)</span> balls in total.
By summing over all <span class="math inline">\(k\)</span>, we actually get all the
possible placements of <span class="math inline">\(z\)</span> balls into <span class="math inline">\(r_1 + r_2\)</span> boxes.
Therefore
<span class="math display">\[\begin{align}
  P(Z = z) &amp;= (1 - p)^{r_1 + r_2} p^{z} \sum_{k = 0}^{z} \binom{z - k + r_1 - 1}{z - k} \binom{k + r_2 - 1}{k}&amp; \\
        &amp;= \binom{z + r_1 + r_2 -1}{z} (1 - p)^{r_1 + r_2} p^{z}.
\end{align}\]</span>
From this it also follows that the sum of geometric distributions with the same
parameter is a negative binomial distribution.</p></li>
<li><p><span class="math inline">\(Z \sim \text{NB}(8, 0.4)\)</span>.</p></li>
</ol>
</div>
<pre class="sourceCode r"><code class="sourceCode r"><span class="kw">set.seed</span>(<span class="dv">1</span>)
nsamps &lt;-<span class="st"> </span><span class="dv">10000</span>
x      &lt;-<span class="st"> </span><span class="kw">rnbinom</span>(nsamps, <span class="dt">size =</span> <span class="dv">5</span>, <span class="dt">prob =</span> <span class="fl">0.6</span>)
y      &lt;-<span class="st"> </span><span class="kw">rnbinom</span>(nsamps, <span class="dt">size =</span> <span class="dv">3</span>, <span class="dt">prob =</span> <span class="fl">0.6</span>)
xpy    &lt;-<span class="st"> </span>x <span class="op">+</span><span class="st"> </span>y
z      &lt;-<span class="st"> </span><span class="kw">rnbinom</span>(nsamps, <span class="dt">size =</span> <span class="dv">8</span>, <span class="dt">prob =</span> <span class="fl">0.6</span>)
samps  &lt;-<span class="st"> </span><span class="kw">tibble</span>(x, y, xpy, z)
samps  &lt;-<span class="st"> </span><span class="kw">melt</span>(samps)
<span class="kw">ggplot</span>(<span class="dt">data =</span> samps, <span class="kw">aes</span>(<span class="dt">x =</span> value)) <span class="op">+</span>
<span class="st">  </span><span class="kw">geom_bar</span>() <span class="op">+</span>
<span class="st">  </span><span class="kw">facet_wrap</span>(<span class="op">~</span><span class="st"> </span>variable)</code></pre>
<p><img src="bookdown-pou_files/figure-html/unnamed-chunk-90-1.png" width="672" /></p>
</div>
</div>
<div id="continuous-random-variables" class="section level2">
<h2><span class="header-section-number">4.3</span> Continuous random variables</h2>

<div class="exercise">
<p><span id="exr:expcdf" class="exercise"><strong>Exercise 4.8  (Exponential random variable)  </strong></span>A variable <span class="math inline">\(X\)</span> with PDF <span class="math inline">\(\lambda e^{-\lambda x}\)</span> is an exponential random
variable with support in non-negative real numbers. It has one positive
parameter <span class="math inline">\(\lambda\)</span>. We denote
<span class="math display">\[\begin{equation}
  X | \lambda \sim \text{Exp}(\lambda).
\end{equation}\]</span></p>
<ol style="list-style-type: lower-alpha">
<li><p>Find the CDF of an exponential random variable.</p></li>
<li><p>Find the quantile function of an exponential random variable.</p></li>
<li><p>Calculate the probability <span class="math inline">\(P(1 \leq X \leq 3)\)</span>, where <span class="math inline">\(X \sim \text{Exp(1.5)}\)</span>.</p></li>
<li><p><span style="color:blue">R: Check your answer to c) with a
simulation (<em>rexp</em>). Plot the probability in a meaningful way.</span></p></li>
<li><p><span style="color:blue">R: Implement PDF, CDF, and the quantile
function and compare their values with corresponding R
functions visually. Hint: use the <strong>size</strong> parameter to
make one of the curves wider.</span></p></li>
</ol>
</div>

<div class="fold">

<div class="solution">
<p> <span class="solution"><em>Solution. </em></span> </p>
<ol style="list-style-type: lower-alpha">
<li><p><span class="math display">\[\begin{align}
F(x) &amp;= \int_{0}^{x} \lambda e^{-\lambda t} dt \\
     &amp;= \lambda \int_{0}^{x} e^{-\lambda t} dt \\
     &amp;= \lambda (\frac{1}{-\lambda}e^{-\lambda t} |_{0}^{x}) \\
     &amp;= \lambda(\frac{1}{\lambda} - \frac{1}{\lambda} e^{-\lambda x}) \\
     &amp;= 1 - e^{-\lambda x}.
\end{align}\]</span></p></li>
<li><p><span class="math display">\[\begin{align}
F(F^{-1}(x))               &amp;= x \\
1 - e^{-\lambda F^{-1}(x)} &amp;= x \\
e^{-\lambda F^{-1}(x)}     &amp;= 1 - x \\
-\lambda F^{-1}(x)         &amp;= \ln(1 - x) \\
F^{-1}(x)                  &amp;= - \frac{ln(1 - x)}{\lambda}.
\end{align}\]</span></p></li>
<li><p><span class="math display">\[\begin{align}
  P(1 \leq X \leq 3) &amp;= P(X  \leq 3) - P(X \leq 1) \\
                  &amp;= P(X \leq 3) - P(X \leq 1) \\
                  &amp;= 1 - e^{-1.5 \times 3} - 1 + e^{-1.5 \times 1} \\
                  &amp;\approx 0.212.
\end{align}\]</span></p></li>
</ol>
</div>
<pre class="sourceCode r"><code class="sourceCode r"><span class="kw">set.seed</span>(<span class="dv">1</span>)
nsamps &lt;-<span class="st"> </span><span class="dv">1000</span>
samps  &lt;-<span class="st"> </span><span class="kw">rexp</span>(nsamps, <span class="dt">rate =</span> <span class="fl">1.5</span>)
<span class="kw">sum</span>(samps <span class="op">&gt;=</span><span class="st"> </span><span class="dv">1</span> <span class="op">&amp;</span><span class="st"> </span>samps <span class="op">&lt;=</span><span class="st"> </span><span class="dv">3</span>) <span class="op">/</span><span class="st"> </span>nsamps</code></pre>
<pre><code>## [1] 0.212</code></pre>
<pre class="sourceCode r"><code class="sourceCode r">exp_plot &lt;-<span class="st"> </span><span class="kw">ggplot</span>(<span class="kw">data.frame</span>(<span class="dt">x =</span> <span class="kw">seq</span>(<span class="dv">0</span>, <span class="dv">5</span>, <span class="dt">by =</span> <span class="fl">0.01</span>)), <span class="kw">aes</span>(<span class="dt">x =</span> x)) <span class="op">+</span>
<span class="st">  </span><span class="kw">stat_function</span>(<span class="dt">fun =</span> dexp, <span class="dt">args =</span> <span class="kw">list</span>(<span class="dt">rate =</span> <span class="fl">1.5</span>)) <span class="op">+</span>
<span class="st">  </span><span class="kw">stat_function</span>(<span class="dt">fun =</span> dexp, <span class="dt">args =</span> <span class="kw">list</span>(<span class="dt">rate =</span> <span class="fl">1.5</span>), <span class="dt">xlim =</span> <span class="kw">c</span>(<span class="dv">1</span>,<span class="dv">3</span>), <span class="dt">geom =</span> <span class="st">&quot;area&quot;</span>, <span class="dt">fill =</span> <span class="st">&quot;red&quot;</span>)
<span class="kw">plot</span>(exp_plot)</code></pre>
<p><img src="bookdown-pou_files/figure-html/unnamed-chunk-92-1.png" width="672" /></p>
<pre class="sourceCode r"><code class="sourceCode r">exp_pdf &lt;-<span class="st"> </span><span class="cf">function</span>(x, lambda) {
  <span class="kw">return</span> (lambda <span class="op">*</span><span class="st"> </span><span class="kw">exp</span>(<span class="op">-</span>lambda <span class="op">*</span><span class="st"> </span>x))
}

exp_cdf &lt;-<span class="st"> </span><span class="cf">function</span>(x, lambda) {
  <span class="kw">return</span> (<span class="dv">1</span> <span class="op">-</span><span class="st"> </span><span class="kw">exp</span>(<span class="op">-</span>lambda <span class="op">*</span><span class="st"> </span>x))
}

exp_quant &lt;-<span class="st"> </span><span class="cf">function</span>(q, lambda) {
  <span class="kw">return</span> (<span class="op">-</span>(<span class="kw">log</span>(<span class="dv">1</span> <span class="op">-</span><span class="st"> </span>q) <span class="op">/</span><span class="st"> </span>lambda))
}

<span class="kw">ggplot</span>(<span class="dt">data =</span> <span class="kw">data.frame</span>(<span class="dt">x =</span> <span class="kw">seq</span>(<span class="dv">0</span>, <span class="dv">5</span>, <span class="dt">by =</span> <span class="fl">0.01</span>)), <span class="kw">aes</span>(<span class="dt">x =</span> x)) <span class="op">+</span>
<span class="st">  </span><span class="kw">stat_function</span>(<span class="dt">fun =</span> dexp, <span class="dt">args =</span> <span class="kw">list</span>(<span class="dt">rate =</span> <span class="fl">1.5</span>), <span class="kw">aes</span>(<span class="dt">color =</span> <span class="st">&quot;R&quot;</span>), <span class="dt">size =</span> <span class="fl">2.5</span>) <span class="op">+</span>
<span class="st">  </span><span class="kw">stat_function</span>(<span class="dt">fun =</span> exp_pdf, <span class="dt">args =</span> <span class="kw">list</span>(<span class="dt">lambda =</span> <span class="fl">1.5</span>), <span class="kw">aes</span>(<span class="dt">color =</span> <span class="st">&quot;Mine&quot;</span>), <span class="dt">size =</span> <span class="fl">1.2</span>) <span class="op">+</span>
<span class="st">  </span><span class="kw">scale_color_manual</span>(<span class="dt">values =</span> <span class="kw">c</span>(<span class="st">&quot;red&quot;</span>, <span class="st">&quot;black&quot;</span>))</code></pre>
<p><img src="bookdown-pou_files/figure-html/unnamed-chunk-93-1.png" width="672" /></p>
<pre class="sourceCode r"><code class="sourceCode r"><span class="kw">ggplot</span>(<span class="dt">data =</span> <span class="kw">data.frame</span>(<span class="dt">x =</span> <span class="kw">seq</span>(<span class="dv">0</span>, <span class="dv">5</span>, <span class="dt">by =</span> <span class="fl">0.01</span>)), <span class="kw">aes</span>(<span class="dt">x =</span> x)) <span class="op">+</span>
<span class="st">  </span><span class="kw">stat_function</span>(<span class="dt">fun =</span> pexp, <span class="dt">args =</span> <span class="kw">list</span>(<span class="dt">rate =</span> <span class="fl">1.5</span>), <span class="kw">aes</span>(<span class="dt">color =</span> <span class="st">&quot;R&quot;</span>), <span class="dt">size =</span> <span class="fl">2.5</span>) <span class="op">+</span>
<span class="st">  </span><span class="kw">stat_function</span>(<span class="dt">fun =</span> exp_cdf, <span class="dt">args =</span> <span class="kw">list</span>(<span class="dt">lambda =</span> <span class="fl">1.5</span>), <span class="kw">aes</span>(<span class="dt">color =</span> <span class="st">&quot;Mine&quot;</span>), <span class="dt">size =</span> <span class="fl">1.2</span>) <span class="op">+</span>
<span class="st">  </span><span class="kw">scale_color_manual</span>(<span class="dt">values =</span> <span class="kw">c</span>(<span class="st">&quot;red&quot;</span>, <span class="st">&quot;black&quot;</span>))</code></pre>
<p><img src="bookdown-pou_files/figure-html/unnamed-chunk-93-2.png" width="672" /></p>
<pre class="sourceCode r"><code class="sourceCode r"><span class="kw">ggplot</span>(<span class="dt">data =</span> <span class="kw">data.frame</span>(<span class="dt">x =</span> <span class="kw">seq</span>(<span class="dv">0</span>, <span class="dv">1</span>, <span class="dt">by =</span> <span class="fl">0.01</span>)), <span class="kw">aes</span>(<span class="dt">x =</span> x)) <span class="op">+</span>
<span class="st">  </span><span class="kw">stat_function</span>(<span class="dt">fun =</span> qexp, <span class="dt">args =</span> <span class="kw">list</span>(<span class="dt">rate =</span> <span class="fl">1.5</span>), <span class="kw">aes</span>(<span class="dt">color =</span> <span class="st">&quot;R&quot;</span>), <span class="dt">size =</span> <span class="fl">2.5</span>) <span class="op">+</span>
<span class="st">  </span><span class="kw">stat_function</span>(<span class="dt">fun =</span> exp_quant, <span class="dt">args =</span> <span class="kw">list</span>(<span class="dt">lambda =</span> <span class="fl">1.5</span>), <span class="kw">aes</span>(<span class="dt">color =</span> <span class="st">&quot;Mine&quot;</span>), <span class="dt">size =</span> <span class="fl">1.2</span>) <span class="op">+</span>
<span class="st">  </span><span class="kw">scale_color_manual</span>(<span class="dt">values =</span> <span class="kw">c</span>(<span class="st">&quot;red&quot;</span>, <span class="st">&quot;black&quot;</span>))</code></pre>
<p><img src="bookdown-pou_files/figure-html/unnamed-chunk-93-3.png" width="672" /></p>
</div>

<div class="exercise">
<p><span id="exr:unifpdf" class="exercise"><strong>Exercise 4.9  (Uniform random variable)  </strong></span>Continuous uniform random variable with parameters <span class="math inline">\(a\)</span> and <span class="math inline">\(b\)</span> has the PDF
<span class="math display">\[\begin{equation}
  p(x) = \begin{cases}
           \frac{1}{b - a} &amp; x \in [a,b] \\
           0 &amp; \text{otherwise}.
         \end{cases}
\end{equation}\]</span></p>
<ol style="list-style-type: lower-alpha">
<li><p>Find the CDF of the uniform random variable.</p></li>
<li><p>Find the quantile function of the uniform random variable.</p></li>
<li><p>Let <span class="math inline">\(X \sim \text{Uniform}(a,b)\)</span>. Find the CDF of the variable
<span class="math inline">\(Y = \frac{X - a}{b - a}\)</span>. This is the <strong>standard uniform random variable</strong>.</p></li>
<li><p>Let <span class="math inline">\(X \sim \text{Uniform}(-1, 3)\)</span>.
Find such <span class="math inline">\(z\)</span> that <span class="math inline">\(P(X &lt; z + \mu_x) = \frac{1}{5}\)</span>.</p></li>
<li><p><span style="color:blue">R: Check your result from d) using
simulation.</span></p>
</div></li>
</ol>
<div class="fold">

<div class="solution">
<p> <span class="solution"><em>Solution. </em></span> 
a.
<span class="math display">\[\begin{align}
  F(x) &amp;= \int_{a}^x \frac{1}{b - a} dt \\
       &amp;= \frac{1}{b - a} \int_{a}^x dt \\
       &amp;= \frac{x - a}{b - a}.
\end{align}\]</span></p>
<ol start="2" style="list-style-type: lower-alpha">
<li><p><span class="math display">\[\begin{align}
F(F^{-1}(p))                &amp;= p \\
\frac{F^{-1}(p) - a}{b - a} &amp;= p \\
F^{-1}(p)                   &amp;= p(b - a) + a.
\end{align}\]</span></p></li>
<li><p><span class="math display">\[\begin{align}
F_Y(y) &amp;= P(Y &lt; y) \\
       &amp;= P(\frac{X - a}{b - a} &lt; y) \\
       &amp;= P(X &lt; y(b - a) + a) \\
       &amp;= F_X(y(b - a) + a) \\
       &amp;= \frac{(y(b - a) + a) - a}{b - a} \\
       &amp;= y.
\end{align}\]</span></p></li>
<li><p><span class="math display">\[\begin{align}
P(X &lt; z + 1) &amp;= \frac{1}{5} \\
F(z + 1)     &amp;= \frac{1}{5} \\
z + 1        &amp;= F^{-1}(\frac{1}{5}) \\
z            &amp;= \frac{1}{5}4 - 1 - 1 \\
z            &amp;= -1.2.
\end{align}\]</span></p></li>
</ol>
</div>
<pre class="sourceCode r"><code class="sourceCode r"><span class="kw">set.seed</span>(<span class="dv">1</span>)
a         &lt;-<span class="st"> </span><span class="dv">-1</span>
b         &lt;-<span class="st"> </span><span class="dv">3</span>
nsamps    &lt;-<span class="st"> </span><span class="dv">10000</span>
unif_samp &lt;-<span class="st"> </span><span class="kw">runif</span>(nsamps, a, b)
mu_x      &lt;-<span class="st"> </span><span class="kw">mean</span>(unif_samp)
new_samp  &lt;-<span class="st"> </span>unif_samp <span class="op">-</span><span class="st"> </span>mu_x
<span class="kw">quantile</span>(new_samp, <span class="dt">probs =</span> <span class="dv">1</span><span class="op">/</span><span class="dv">5</span>)</code></pre>
<pre><code>##       20% 
## -1.203192</code></pre>
<pre class="sourceCode r"><code class="sourceCode r"><span class="kw">punif</span>(<span class="op">-</span><span class="fl">0.2</span>, <span class="dv">-1</span>, <span class="dv">3</span>)</code></pre>
<pre><code>## [1] 0.2</code></pre>
</div>

<div class="exercise">
<p><span id="exr:betacdf" class="exercise"><strong>Exercise 4.10  (Beta random variable)  </strong></span>A variable <span class="math inline">\(X\)</span> with PDF
<span class="math display">\[\begin{equation}
  p(x) = \frac{x^{\alpha - 1} (1 - x)^{\beta - 1}}{\text{B}(\alpha, \beta)},
\end{equation}\]</span>
where <span class="math inline">\(\text{B}(\alpha, \beta) = \frac{\Gamma(\alpha) \Gamma(\beta)}{\Gamma(\alpha + \beta)}\)</span> and
<span class="math inline">\(\Gamma(x) = \int_0^{\infty} x^{z - 1} e^{-x} dx\)</span>
is a Beta random
variable with support on <span class="math inline">\([0,1]\)</span>. It has two positive
parameters <span class="math inline">\(\alpha\)</span> and <span class="math inline">\(\beta\)</span>. Notation:
<span class="math display">\[\begin{equation}
  X | \alpha, \beta \sim \text{Beta}(\alpha, \beta)
\end{equation}\]</span>
It is often used in modeling rates.
<!--The CDF of a Beta random variable is-->
<!--\begin{equation}-->
<!--  F(x) = \frac{\text{B}(x; \alpha, \beta)}{\text{B}(\alpha, \beta)},-->
<!--\end{equation}-->
<!--  where $\text{B}(x; \alpha, \beta) = \int_0^x t^{\alpha+1} (1 - t)^{\beta - 1} dt$.--></p>
<ol style="list-style-type: lower-alpha">
<li><p>Calculate the PDF for <span class="math inline">\(\alpha = 1\)</span> and <span class="math inline">\(\beta = 1\)</span>. What do you notice?</p></li>
<li><p><span style="color:blue">R: Plot densities of the beta distribution
for parameter pairs (2, 2), (4, 1), (1, 4), (2, 5), and (0.1, 0.1).</span></p></li>
<li><p><span style="color:blue">R: Sample from <span class="math inline">\(X \sim \text{Beta}(2, 5)\)</span> and
compare the histogram with Beta PDF.</span></p></li>
</ol>
</div>

<div class="fold">

<div class="solution">
<p> <span class="solution"><em>Solution. </em></span> </p>
<ol style="list-style-type: lower-alpha">
<li><span class="math display">\[\begin{equation}
p(x) = \frac{x^{1 - 1} (1 - x)^{1 - 1}}{\text{B}(1, 1)} = 1.
\end{equation}\]</span>
This is the standard uniform distribution.</li>
</ol>
</div>
<pre class="sourceCode r"><code class="sourceCode r"><span class="kw">set.seed</span>(<span class="dv">1</span>)
<span class="kw">ggplot</span>(<span class="dt">data =</span> <span class="kw">data.frame</span>(<span class="dt">x =</span> <span class="kw">seq</span>(<span class="dv">0</span>, <span class="dv">1</span>, <span class="dt">by =</span> <span class="fl">0.01</span>)), <span class="kw">aes</span>(<span class="dt">x =</span> x)) <span class="op">+</span>
<span class="st">  </span><span class="kw">stat_function</span>(<span class="dt">fun =</span> dbeta, <span class="dt">args =</span> <span class="kw">list</span>(<span class="dt">shape1 =</span> <span class="dv">2</span>, <span class="dt">shape2 =</span> <span class="dv">2</span>), <span class="kw">aes</span>(<span class="dt">color =</span> <span class="st">&quot;alpha = 0.5&quot;</span>)) <span class="op">+</span>
<span class="st">  </span><span class="kw">stat_function</span>(<span class="dt">fun =</span> dbeta, <span class="dt">args =</span> <span class="kw">list</span>(<span class="dt">shape1 =</span> <span class="dv">4</span>, <span class="dt">shape2 =</span> <span class="dv">1</span>), <span class="kw">aes</span>(<span class="dt">color =</span> <span class="st">&quot;alpha = 4&quot;</span>)) <span class="op">+</span>
<span class="st">  </span><span class="kw">stat_function</span>(<span class="dt">fun =</span> dbeta, <span class="dt">args =</span> <span class="kw">list</span>(<span class="dt">shape1 =</span> <span class="dv">1</span>, <span class="dt">shape2 =</span> <span class="dv">4</span>), <span class="kw">aes</span>(<span class="dt">color =</span> <span class="st">&quot;alpha = 1&quot;</span>)) <span class="op">+</span>
<span class="st">  </span><span class="kw">stat_function</span>(<span class="dt">fun =</span> dbeta, <span class="dt">args =</span> <span class="kw">list</span>(<span class="dt">shape1 =</span> <span class="dv">2</span>, <span class="dt">shape2 =</span> <span class="dv">5</span>), <span class="kw">aes</span>(<span class="dt">color =</span> <span class="st">&quot;alpha = 25&quot;</span>)) <span class="op">+</span>
<span class="st">  </span><span class="kw">stat_function</span>(<span class="dt">fun =</span> dbeta, <span class="dt">args =</span> <span class="kw">list</span>(<span class="dt">shape1 =</span> <span class="fl">0.1</span>, <span class="dt">shape2 =</span> <span class="fl">0.1</span>), <span class="kw">aes</span>(<span class="dt">color =</span> <span class="st">&quot;alpha = 0.1&quot;</span>))</code></pre>
<p><img src="bookdown-pou_files/figure-html/unnamed-chunk-97-1.png" width="672" /></p>
<pre class="sourceCode r"><code class="sourceCode r"><span class="kw">set.seed</span>(<span class="dv">1</span>)
nsamps &lt;-<span class="st"> </span><span class="dv">1000</span>
samps  &lt;-<span class="st"> </span><span class="kw">rbeta</span>(nsamps, <span class="dv">2</span>, <span class="dv">5</span>)
<span class="kw">ggplot</span>(<span class="dt">data =</span> <span class="kw">data.frame</span>(<span class="dt">x =</span> samps), <span class="kw">aes</span>(<span class="dt">x =</span> x)) <span class="op">+</span>
<span class="st">  </span><span class="kw">geom_histogram</span>(<span class="kw">aes</span>(<span class="dt">y =</span> ..density..), <span class="dt">color =</span> <span class="st">&quot;black&quot;</span>) <span class="op">+</span>
<span class="st">  </span><span class="kw">stat_function</span>(<span class="dt">data  =</span> <span class="kw">data.frame</span>(<span class="dt">x =</span> <span class="kw">seq</span>(<span class="dv">0</span>, <span class="dv">1</span>, <span class="dt">by =</span> <span class="fl">0.01</span>)), <span class="kw">aes</span>(<span class="dt">x =</span> x), 
                <span class="dt">fun   =</span> dbeta, 
                <span class="dt">args  =</span> <span class="kw">list</span>(<span class="dt">shape1 =</span> <span class="dv">2</span>, <span class="dt">shape2 =</span> <span class="dv">5</span>), 
                <span class="dt">color =</span> <span class="st">&quot;red&quot;</span>, 
                <span class="dt">size  =</span> <span class="fl">1.2</span>)</code></pre>
<p><img src="bookdown-pou_files/figure-html/unnamed-chunk-98-1.png" width="672" /></p>
</div>

<div class="exercise">
<p><span id="exr:gammapdf" class="exercise"><strong>Exercise 4.11  (Gamma random variable)  </strong></span>A random variable with PDF
<span class="math display">\[\begin{equation}
 p(x) = \frac{\beta^\alpha}{\Gamma(\alpha)} x^{\alpha - 1}e^{-\beta x}
\end{equation}\]</span>
is a Gamma random variable with support on the positive numbers and
parameters shape <span class="math inline">\(\alpha &gt; 0\)</span> and rate
<span class="math inline">\(\beta &gt; 0\)</span>.
We write
<span class="math display">\[\begin{equation}
  X | \alpha, \beta \sim \text{Gamma}(\alpha, \beta)
\end{equation}\]</span>
and it’s CDF is
<span class="math display">\[\begin{equation}
  \frac{\gamma(\alpha, \beta x)}{\Gamma(\alpha)},
\end{equation}\]</span>
where <span class="math inline">\(\gamma(s, x) = \int_0^x t^{s-1} e^{-t} dt\)</span>.
It is usually used in modeling positive phenomena (for example insurance
claims and rainfalls).</p>
<ol style="list-style-type: lower-alpha">
<li><p>Let <span class="math inline">\(X \sim \text{Gamma}(1, \beta)\)</span>. Find the PDF of <span class="math inline">\(X\)</span>.
Do you recognize this PDF?</p></li>
<li><p>Let <span class="math inline">\(k = \alpha\)</span> and <span class="math inline">\(\theta = \frac{1}{\beta}\)</span>. Find the PDF
of <span class="math inline">\(X | k, \theta \sim \text{Gamma}(k, \theta)\)</span>. Random variables can be reparameterized, and sometimes a reparameterized
distribution is more suitable for certain calculations. The first
parameterization is for example usually used in Bayesian statistics, while this
parameterization is more common in econometrics and some other applied fields.
Note that you also need to pay attention to the parameters in statistical
software, so diligently read the help files when using functions like
<em>rgamma</em> to see how the function is parameterized.</p></li>
<li><p><span style="color:blue">R: Plot gamma CDF for random variables
with shape and rate parameters (1,1), (10,1), (1,10). </span></p></li>
</ol>
</div>

<div class="fold">

<div class="solution">
<p> <span class="solution"><em>Solution. </em></span> </p>
<ol style="list-style-type: lower-alpha">
<li><p><span class="math display">\[\begin{align}
  p(x) &amp;= \frac{\beta^1}{\Gamma(1)} x^{1 - 1}e^{-\beta x} \\
    &amp;= \beta e^{-\beta x}
\end{align}\]</span>
This is the PDF of the exponential distribution with parameter <span class="math inline">\(\beta\)</span>.</p></li>
<li><p><span class="math display">\[\begin{align}
p(x) &amp;= \frac{1}{\Gamma(k)\beta^k} x^{k - 1}e^{-\frac{x}{\theta}}.
\end{align}\]</span></p></li>
</ol>
</div>
<pre class="sourceCode r"><code class="sourceCode r"><span class="kw">set.seed</span>(<span class="dv">1</span>)
<span class="kw">ggplot</span>(<span class="dt">data =</span> <span class="kw">data.frame</span>(<span class="dt">x =</span> <span class="kw">seq</span>(<span class="dv">0</span>, <span class="dv">25</span>, <span class="dt">by =</span> <span class="fl">0.01</span>)), <span class="kw">aes</span>(<span class="dt">x =</span> x)) <span class="op">+</span>
<span class="st">  </span><span class="kw">stat_function</span>(<span class="dt">fun =</span> pgamma, <span class="dt">args =</span> <span class="kw">list</span>(<span class="dt">shape =</span> <span class="dv">1</span>, <span class="dt">rate =</span> <span class="dv">1</span>), <span class="kw">aes</span>(<span class="dt">color =</span> <span class="st">&quot;Gamma(1,1)&quot;</span>)) <span class="op">+</span>
<span class="st">  </span><span class="kw">stat_function</span>(<span class="dt">fun =</span> pgamma, <span class="dt">args =</span> <span class="kw">list</span>(<span class="dt">shape =</span> <span class="dv">10</span>, <span class="dt">rate =</span> <span class="dv">1</span>), <span class="kw">aes</span>(<span class="dt">color =</span> <span class="st">&quot;Gamma(10,1)&quot;</span>)) <span class="op">+</span>
<span class="st">  </span><span class="kw">stat_function</span>(<span class="dt">fun =</span> pgamma, <span class="dt">args =</span> <span class="kw">list</span>(<span class="dt">shape =</span> <span class="dv">1</span>, <span class="dt">rate =</span> <span class="dv">10</span>), <span class="kw">aes</span>(<span class="dt">color =</span> <span class="st">&quot;Gamma(1,10)&quot;</span>))</code></pre>
<p><img src="bookdown-pou_files/figure-html/unnamed-chunk-100-1.png" width="672" /></p>
</div>

<div class="exercise">
<p><span id="exr:normalpdf" class="exercise"><strong>Exercise 4.12  (Normal random variable)  </strong></span>A random variable with PDF
<span class="math display">\[\begin{equation}
 p(x) = \frac{1}{\sqrt{2 \pi \sigma^2}} e^{-\frac{(x - \mu)^2}{2 \sigma^2}}
\end{equation}\]</span>
is a normal random variable with support on the real axis and
parameters <span class="math inline">\(\mu\)</span> in reals and <span class="math inline">\(\sigma^2 &gt; 0\)</span>.
The first is the mean parameter and the second is the variance parameter.
Many statistical methods assume a normal distribution. We denote
<span class="math display">\[\begin{equation}
  X | \mu, \sigma \sim \text{N}(\mu, \sigma^2),
\end{equation}\]</span>
and it’s CDF is
<span class="math display">\[\begin{equation}
  F(x) = \int_{-\infty}^x \frac{1}{\sqrt{2 \pi \sigma^2}} e^{-\frac{(t - \mu)^2}{2 \sigma^2}} dt,
\end{equation}\]</span>
which is intractable and is usually approximated.
Due to its flexibility
it is also one of the most researched distributions. For that reason
statisticians often use transformations of variables or approximate
distributions with the normal distribution.</p>
<ol style="list-style-type: lower-alpha">
<li><p>Show that a variable <span class="math inline">\(\frac{X - \mu}{\sigma} \sim \text{N}(0,1)\)</span>. This
transformation is called standardization, and <span class="math inline">\(\text{N}(0,1)\)</span> is
a <strong>standard normal distribution</strong>.</p></li>
<li><p><span style="color:blue">R: Plot the normal distribution with
<span class="math inline">\(\mu = 0\)</span> and different values for the <span class="math inline">\(\sigma\)</span> parameter.</span></p></li>
<li><p><span style="color:blue">R: The normal distribution provides a good
approximation for the Poisson distribution with a large <span class="math inline">\(\lambda\)</span>.
Let <span class="math inline">\(X \sim \text{Poisson}(50)\)</span>.
Approximate <span class="math inline">\(X\)</span> with the normal distribution and compare its density with
the Poisson histogram. What are the values of <span class="math inline">\(\mu\)</span> and <span class="math inline">\(\sigma^2\)</span> that
should provide the best approximation? Note that R function <em>rnorm</em> takes
standard deviation (<span class="math inline">\(\sigma\)</span>) as a parameter and not variance.</span></p>
</div></li>
</ol>
<div class="fold">

<div class="solution">
<p> <span class="solution"><em>Solution. </em></span> </p>
<ol style="list-style-type: lower-alpha">
<li><span class="math display">\[\begin{align}
P(\frac{X - \mu}{\sigma} &lt; x) &amp;= P(X &lt; \sigma x + \mu) \\
&amp;= F(\sigma x + \mu) \\
&amp;= \int_{-\infty}^{\sigma x + \mu} \frac{1}{\sqrt{2 \pi \sigma^2}} e^{-\frac{(t - \mu)^2}{2\sigma^2}} dt
\end{align}\]</span>
Now let <span class="math inline">\(s = f(t) = \frac{t - \mu}{\sigma}\)</span>, then <span class="math inline">\(ds = \frac{dt}{\sigma}\)</span> and
<span class="math inline">\(f(\sigma x + \mu) = x\)</span>, so
<span class="math display">\[\begin{align}
P(\frac{X - \mu}{\sigma} &lt; x) &amp;= \int_{-\infty}^{x} \frac{1}{\sqrt{2 \pi}} 
  e^{-\frac{s^2}{2}} ds.
\end{align}\]</span>
There is no need to evaluate this integral, as we recognize it as the CDF
of a normal distribution with <span class="math inline">\(\mu = 0\)</span> and <span class="math inline">\(\sigma^2 = 1\)</span>.</li>
</ol>
</div>
<pre class="sourceCode r"><code class="sourceCode r"><span class="kw">set.seed</span>(<span class="dv">1</span>)
<span class="co"># b</span>
<span class="kw">ggplot</span>(<span class="dt">data =</span> <span class="kw">data.frame</span>(<span class="dt">x =</span> <span class="kw">seq</span>(<span class="op">-</span><span class="dv">15</span>, <span class="dv">15</span>, <span class="dt">by =</span> <span class="fl">0.01</span>)), <span class="kw">aes</span>(<span class="dt">x =</span> x)) <span class="op">+</span>
<span class="st">  </span><span class="kw">stat_function</span>(<span class="dt">fun =</span> dnorm, <span class="dt">args =</span> <span class="kw">list</span>(<span class="dt">mean =</span> <span class="dv">0</span>, <span class="dt">sd =</span> <span class="dv">1</span>), <span class="kw">aes</span>(<span class="dt">color =</span> <span class="st">&quot;sd = 1&quot;</span>)) <span class="op">+</span>
<span class="st">  </span><span class="kw">stat_function</span>(<span class="dt">fun =</span> dnorm, <span class="dt">args =</span> <span class="kw">list</span>(<span class="dt">mean =</span> <span class="dv">0</span>, <span class="dt">sd =</span> <span class="fl">0.4</span>), <span class="kw">aes</span>(<span class="dt">color =</span> <span class="st">&quot;sd = 0.1&quot;</span>)) <span class="op">+</span>
<span class="st">  </span><span class="kw">stat_function</span>(<span class="dt">fun =</span> dnorm, <span class="dt">args =</span> <span class="kw">list</span>(<span class="dt">mean =</span> <span class="dv">0</span>, <span class="dt">sd =</span> <span class="dv">2</span>), <span class="kw">aes</span>(<span class="dt">color =</span> <span class="st">&quot;sd = 2&quot;</span>)) <span class="op">+</span>
<span class="st">  </span><span class="kw">stat_function</span>(<span class="dt">fun =</span> dnorm, <span class="dt">args =</span> <span class="kw">list</span>(<span class="dt">mean =</span> <span class="dv">0</span>, <span class="dt">sd =</span> <span class="dv">5</span>), <span class="kw">aes</span>(<span class="dt">color =</span> <span class="st">&quot;sd = 5&quot;</span>))</code></pre>
<p><img src="bookdown-pou_files/figure-html/unnamed-chunk-102-1.png" width="672" /></p>
<pre class="sourceCode r"><code class="sourceCode r"><span class="co"># c</span>
mean_par   &lt;-<span class="st"> </span><span class="dv">50</span>
nsamps     &lt;-<span class="st"> </span><span class="dv">100000</span>
pois_samps &lt;-<span class="st"> </span><span class="kw">rpois</span>(nsamps, <span class="dt">lambda =</span> mean_par)
norm_samps &lt;-<span class="st"> </span><span class="kw">rnorm</span>(nsamps, <span class="dt">mean =</span> mean_par, <span class="dt">sd =</span> <span class="kw">sqrt</span>(mean_par))
my_plot    &lt;-<span class="st"> </span><span class="kw">ggplot</span>() <span class="op">+</span>
<span class="st">  </span><span class="kw">geom_bar</span>(<span class="dt">data =</span> <span class="kw">tibble</span>(<span class="dt">x =</span> pois_samps), <span class="kw">aes</span>(<span class="dt">x =</span> x, <span class="dt">y =</span> (..count..)<span class="op">/</span><span class="kw">sum</span>(..count..))) <span class="op">+</span>
<span class="st">  </span><span class="kw">geom_density</span>(<span class="dt">data =</span> <span class="kw">tibble</span>(<span class="dt">x =</span> norm_samps), <span class="kw">aes</span>(<span class="dt">x =</span> x), <span class="dt">color =</span> <span class="st">&quot;red&quot;</span>)
<span class="kw">plot</span>(my_plot)</code></pre>
<p><img src="bookdown-pou_files/figure-html/unnamed-chunk-102-2.png" width="672" /></p>
</div>

<div class="exercise">
<p><span id="exr:logitpdf" class="exercise"><strong>Exercise 4.13  (Logistic random variable)  </strong></span>A logistic random variable has CDF
<span class="math display">\[\begin{equation}
  F(x) = \frac{1}{1 + e^{-\frac{x - \mu}{s}}},
\end{equation}\]</span>
where <span class="math inline">\(\mu\)</span> is real and <span class="math inline">\(s &gt; 0\)</span>. The support is on the real axis. We denote
<span class="math display">\[\begin{equation}
  X | \mu, s \sim \text{Logistic}(\mu, s).
\end{equation}\]</span>
The distribution of the logistic random variable resembles a normal random
variable, however it has heavier tails.</p>
<ol style="list-style-type: lower-alpha">
<li><p>Find the PDF of a logistic random variable.</p></li>
<li><p><span style="color:blue">R: Implement logistic PDF and CDF and visually
compare both for <span class="math inline">\(X \sim \text{N}(0, 1)\)</span> and <span class="math inline">\(Y \sim \text{logit}(0, \sqrt{\frac{3}{\pi^2}})\)</span>.
These distributions have the same mean and variance. Additionally, plot
the same plot on the interval [5,10], to better see the difference
in the tails. </span></p></li>
<li><p><span style="color:blue">R: For the distributions in b) find the
probability <span class="math inline">\(P(|X| &gt; 4)\)</span> and interpret the result. </span></p></li>
</ol>
</div>

<div class="fold">

<div class="solution">
<p> <span class="solution"><em>Solution. </em></span> </p>
<ol style="list-style-type: lower-alpha">
<li><span class="math display">\[\begin{align}
  p(x) &amp;= \frac{d}{dx} \frac{1}{1 + e^{-\frac{x - \mu}{s}}} \\
    &amp;= \frac{- \frac{d}{dx} (1 + e^{-\frac{x - \mu}{s}})}{(1 + e^{-\frac{x - \mu}{s}})^2} \\
    &amp;= \frac{e^{-\frac{x - \mu}{s}}}{s(1 + e^{-\frac{x - \mu}{s}})^2}.
\end{align}\]</span></li>
</ol>
</div>
<pre class="sourceCode r"><code class="sourceCode r"><span class="co"># b</span>
<span class="kw">set.seed</span>(<span class="dv">1</span>)
logit_pdf &lt;-<span class="st"> </span><span class="cf">function</span> (x, mu, s) {
  <span class="kw">return</span> ((<span class="kw">exp</span>(<span class="op">-</span>(x <span class="op">-</span><span class="st"> </span>mu)<span class="op">/</span>(s))) <span class="op">/</span><span class="st"> </span>(s <span class="op">*</span><span class="st"> </span>(<span class="dv">1</span> <span class="op">+</span><span class="st"> </span><span class="kw">exp</span>(<span class="op">-</span>(x <span class="op">-</span><span class="st"> </span>mu)<span class="op">/</span>(s)))<span class="op">^</span><span class="dv">2</span>))
}
nl_plot &lt;-<span class="st"> </span><span class="kw">ggplot</span>(<span class="dt">data =</span> <span class="kw">data.frame</span>(<span class="dt">x =</span> <span class="kw">seq</span>(<span class="op">-</span><span class="dv">12</span>, <span class="dv">12</span>, <span class="dt">by =</span> <span class="fl">0.01</span>)), <span class="kw">aes</span>(<span class="dt">x =</span> x)) <span class="op">+</span>
<span class="st">  </span><span class="kw">stat_function</span>(<span class="dt">fun =</span> dnorm, <span class="dt">args =</span> <span class="kw">list</span>(<span class="dt">mean =</span> <span class="dv">0</span>, <span class="dt">sd =</span> <span class="dv">1</span>), <span class="kw">aes</span>(<span class="dt">color =</span> <span class="st">&quot;normal&quot;</span>)) <span class="op">+</span>
<span class="st">  </span><span class="kw">stat_function</span>(<span class="dt">fun =</span> logit_pdf, <span class="dt">args =</span> <span class="kw">list</span>(<span class="dt">mu =</span> <span class="dv">0</span>, <span class="dt">s =</span> <span class="kw">sqrt</span>(<span class="dv">3</span><span class="op">/</span>pi<span class="op">^</span><span class="dv">2</span>)), <span class="kw">aes</span>(<span class="dt">color =</span> <span class="st">&quot;logit&quot;</span>))
<span class="kw">plot</span>(nl_plot)</code></pre>
<p><img src="bookdown-pou_files/figure-html/unnamed-chunk-104-1.png" width="672" /></p>
<pre class="sourceCode r"><code class="sourceCode r">nl_plot &lt;-<span class="st"> </span><span class="kw">ggplot</span>(<span class="dt">data =</span> <span class="kw">data.frame</span>(<span class="dt">x =</span> <span class="kw">seq</span>(<span class="dv">5</span>, <span class="dv">10</span>, <span class="dt">by =</span> <span class="fl">0.01</span>)), <span class="kw">aes</span>(<span class="dt">x =</span> x)) <span class="op">+</span>
<span class="st">  </span><span class="kw">stat_function</span>(<span class="dt">fun =</span> dnorm, <span class="dt">args =</span> <span class="kw">list</span>(<span class="dt">mean =</span> <span class="dv">0</span>, <span class="dt">sd =</span> <span class="dv">1</span>), <span class="kw">aes</span>(<span class="dt">color =</span> <span class="st">&quot;normal&quot;</span>)) <span class="op">+</span>
<span class="st">  </span><span class="kw">stat_function</span>(<span class="dt">fun =</span> logit_pdf, <span class="dt">args =</span> <span class="kw">list</span>(<span class="dt">mu =</span> <span class="dv">0</span>, <span class="dt">s =</span> <span class="kw">sqrt</span>(<span class="dv">3</span><span class="op">/</span>pi<span class="op">^</span><span class="dv">2</span>)), <span class="kw">aes</span>(<span class="dt">color =</span> <span class="st">&quot;logit&quot;</span>))
<span class="kw">plot</span>(nl_plot)</code></pre>
<p><img src="bookdown-pou_files/figure-html/unnamed-chunk-104-2.png" width="672" /></p>
<pre class="sourceCode r"><code class="sourceCode r"><span class="co"># c</span>
logit_cdf &lt;-<span class="st"> </span><span class="cf">function</span> (x, mu, s) {
  <span class="kw">return</span> (<span class="dv">1</span> <span class="op">/</span><span class="st"> </span>(<span class="dv">1</span> <span class="op">+</span><span class="st"> </span><span class="kw">exp</span>(<span class="op">-</span>(x <span class="op">-</span><span class="st"> </span>mu) <span class="op">/</span><span class="st"> </span>s)))
}

p_logistic &lt;-<span class="st"> </span><span class="dv">1</span> <span class="op">-</span><span class="st"> </span><span class="kw">logit_cdf</span>(<span class="dv">4</span>, <span class="dv">0</span>, <span class="kw">sqrt</span>(<span class="dv">3</span><span class="op">/</span>pi<span class="op">^</span><span class="dv">2</span>)) <span class="op">+</span><span class="st"> </span><span class="kw">logit_cdf</span>(<span class="op">-</span><span class="dv">4</span>, <span class="dv">0</span>, <span class="kw">sqrt</span>(<span class="dv">3</span><span class="op">/</span>pi<span class="op">^</span><span class="dv">2</span>))
p_norm     &lt;-<span class="st"> </span><span class="dv">1</span> <span class="op">-</span><span class="st"> </span><span class="kw">pnorm</span>(<span class="dv">4</span>, <span class="dv">0</span>, <span class="dv">1</span>) <span class="op">+</span><span class="st"> </span><span class="kw">pnorm</span>(<span class="op">-</span><span class="dv">4</span>, <span class="dv">0</span>, <span class="dv">1</span>)
p_logistic</code></pre>
<pre><code>## [1] 0.001411988</code></pre>
<pre class="sourceCode r"><code class="sourceCode r">p_norm</code></pre>
<pre><code>## [1] 6.334248e-05</code></pre>
<pre class="sourceCode r"><code class="sourceCode r"><span class="co"># Logistic distribution has wider tails, therefore the probability of larger</span>
<span class="co"># absolute values is higher.</span></code></pre>
</div>
</div>
<div id="singular-random-variables" class="section level2">
<h2><span class="header-section-number">4.4</span> Singular random variables</h2>

<div class="exercise">
<p><span id="exr:unnamed-chunk-105" class="exercise"><strong>Exercise 4.14  (Cantor distribution)  </strong></span>The Cantor set is a subset of <span class="math inline">\([0,1]\)</span>, which we create by iteratively deleting the middle third of the interval. For example, in the first iteration, we get the sets <span class="math inline">\([0,\frac{1}{3}]\)</span> and <span class="math inline">\([\frac{2}{3},1]\)</span>. In the second iteration, we get <span class="math inline">\([0,\frac{1}{9}]\)</span>, <span class="math inline">\([\frac{2}{9},\frac{1}{3}]\)</span>, <span class="math inline">\([\frac{2}{3}, \frac{7}{9}]\)</span>, and <span class="math inline">\([\frac{8}{9}, 1]\)</span>. On the <span class="math inline">\(n\)</span>-th iteration, we have
<span class="math display">\[\begin{equation}
  C_n = \frac{C_{n-1}}{3} \cup \bigg(\frac{2}{3} + \frac{C_{n-1}}{3} \bigg),
\end{equation}\]</span>
where <span class="math inline">\(C_0 = [0,1]\)</span>. The Cantor set is then defined as the intersection of these sets
<span class="math display">\[\begin{equation}
  C = \cap_{n=1}^{\infty} C_n.
\end{equation}\]</span>
It has the same cardinality as <span class="math inline">\([0,1]\)</span>. Another way to define the Cantor set is the set of all numbers on <span class="math inline">\([0,1]\)</span>, that do not have a 1 in the ternary representation <span class="math inline">\(x = \sum_{n=1}^\infty \frac{x_i}{3^i}, x_i \in \{0,1,2\}\)</span>.</p>
<p>A random variable follows the Cantor distribution, if its CDF is the Cantor function (below). You can find the implementations of random number generator, CDF, and quantile functions for the Cantor distributions at <a href="https://github.com/Henrygb/CantorDist.R" class="uri">https://github.com/Henrygb/CantorDist.R</a>.</p>
<ol style="list-style-type: lower-alpha">
<li><p>Show that the Lebesgue measure of the Cantor set is 0.</p></li>
<li><p>(<strong>Jagannathan</strong>) Let us look at an infinite sequence of independent fair-coin tosses. If the outcome is heads, let <span class="math inline">\(x_i = 2\)</span> and <span class="math inline">\(x_i = 0\)</span>, when tails. Then use these to create <span class="math inline">\(x = \sum_{n=1}^\infty \frac{x_i}{3^i}\)</span>. This is a random variable with the Cantor distribution. Show that <span class="math inline">\(X\)</span> has a singular distribution.</p></li>
</ol>
</div>

<img src="bookdown-pou_files/figure-html/unnamed-chunk-106-1.png" width="672" />
<div class="fold">

<div class="solution">
<p> <span class="solution"><em>Solution. </em></span> </p>
<ol style="list-style-type: lower-alpha">
<li><p><span class="math display">\[\begin{align}
\lambda(C) &amp;= 1 - \lambda(C^c) \\
        &amp;= 1 - \frac{1}{3}\sum_{k = 0}^\infty (\frac{2}{3})^k \\
        &amp;= 1 - \frac{\frac{1}{3}}{1 - \frac{2}{3}} \\
        &amp;= 0.
\end{align}\]</span></p></li>
<li><p>First, for every <span class="math inline">\(x\)</span>, the probability of observing it is <span class="math inline">\(\lim_{n \rightarrow \infty} \frac{1}{2^n} = 0\)</span>. Second, the probability that we observe one of all the possible sequences is 1. Therefore <span class="math inline">\(P(C) = 1\)</span>. So this is a singular variable. The CDF only increments on the elements of the Cantor set.</p></li>
</ol>
</div>
</div>
</div>
<div id="transformations" class="section level2">
<h2><span class="header-section-number">4.5</span> Transformations</h2>

<div class="exercise">
<span id="exr:unnamed-chunk-108" class="exercise"><strong>Exercise 4.15  </strong></span>Let <span class="math inline">\(X\)</span> be a random variable that is uniformly distributed on
<span class="math inline">\(\{-2, -1, 0, 1, 2\}\)</span>. Find the PMF of <span class="math inline">\(Y = X^2\)</span>.
</div>

<div class="fold">

<div class="solution">
<p> <span class="solution"><em>Solution. </em></span> 
<span class="math display">\[\begin{align}
  P_Y(y) = \sum_{x \in \sqrt(y)} P_X(x) = \begin{cases}
    0           &amp; y \notin \{0,1,4\} \\
    \frac{1}{5} &amp; y = 0 \\
    \frac{2}{5} &amp; y \in \{1,4\}
  \end{cases}
\end{align}\]</span></p>
</div>
</div>

<div class="exercise">
<p><span id="exr:lognpdf" class="exercise"><strong>Exercise 4.16  (Lognormal random variable)  </strong></span>A lognormal random variable is a variable whose logarithm is normally
distributed. In practice, we often encounter skewed data. Usually
using a log transformation on such data makes it more symmetric and therefore
more suitable for modeling with the normal distribution (more on why we wish
to model data with the normal distribution in the following chapters).</p>
<ol style="list-style-type: lower-alpha">
<li><p>Let <span class="math inline">\(X \sim \text{N}(\mu,\sigma)\)</span>. Find the PDF of <span class="math inline">\(Y: \log(Y) = X\)</span>.</p></li>
<li><p><span style="color:blue">R: Sample from the lognormal distribution with
parameters <span class="math inline">\(\mu = 5\)</span> and <span class="math inline">\(\sigma = 2\)</span>.
Plot a histogram of the samples.
Then log-transform the samples and plot a histogram along with the
theoretical normal PDF.</span></p></li>
</ol>
</div>

<div class="fold">

<div class="solution">
<p> <span class="solution"><em>Solution. </em></span> </p>
<ol style="list-style-type: lower-alpha">
<li><span class="math display">\[\begin{align}
  p_Y(y) &amp;= p_X(\log(y)) \frac{d}{dy} \log(y) \\
      &amp;= \frac{1}{\sqrt{2 \pi \sigma^2}} e^{-\frac{(\log(y) - \mu)^2}{2 \sigma^2}} \frac{1}{y} \\
      &amp;= \frac{1}{y \sqrt{2 \pi \sigma^2}} e^{-\frac{(\log(y) - \mu)^2}{2 \sigma^2}}.
\end{align}\]</span></li>
</ol>
</div>
<pre class="sourceCode r"><code class="sourceCode r"><span class="kw">set.seed</span>(<span class="dv">1</span>)
nsamps   &lt;-<span class="st"> </span><span class="dv">10000</span>
mu       &lt;-<span class="st"> </span><span class="dv">5</span>
sigma    &lt;-<span class="st"> </span><span class="dv">2</span>
ln_samps &lt;-<span class="st"> </span><span class="kw">rlnorm</span>(nsamps, mu, sigma)
ln_plot  &lt;-<span class="st"> </span><span class="kw">ggplot</span>(<span class="dt">data =</span> <span class="kw">data.frame</span>(<span class="dt">x =</span> ln_samps), <span class="kw">aes</span>(<span class="dt">x =</span> x)) <span class="op">+</span>
<span class="st">  </span><span class="kw">geom_histogram</span>(<span class="dt">color =</span> <span class="st">&quot;black&quot;</span>)
<span class="kw">plot</span>(ln_plot)</code></pre>
<p><img src="bookdown-pou_files/figure-html/unnamed-chunk-111-1.png" width="672" /></p>
<pre class="sourceCode r"><code class="sourceCode r">norm_samps &lt;-<span class="st"> </span><span class="kw">log</span>(ln_samps)
n_plot     &lt;-<span class="st"> </span><span class="kw">ggplot</span>(<span class="dt">data =</span> <span class="kw">data.frame</span>(<span class="dt">x =</span> norm_samps), <span class="kw">aes</span>(<span class="dt">x =</span> x)) <span class="op">+</span>
<span class="st">  </span><span class="kw">geom_histogram</span>(<span class="kw">aes</span>(<span class="dt">y =</span> ..density..), <span class="dt">color =</span> <span class="st">&quot;black&quot;</span>) <span class="op">+</span>
<span class="st">  </span><span class="kw">stat_function</span>(<span class="dt">fun =</span> dnorm, <span class="dt">args =</span> <span class="kw">list</span>(<span class="dt">mean =</span> mu, <span class="dt">sd =</span> sigma), <span class="dt">color =</span> <span class="st">&quot;red&quot;</span>)
<span class="kw">plot</span>(n_plot)</code></pre>
<p><img src="bookdown-pou_files/figure-html/unnamed-chunk-111-2.png" width="672" /></p>
</div>

<div class="exercise">
<p><span id="exr:unnamed-chunk-112" class="exercise"><strong>Exercise 4.17  (Probability integral transform)  </strong></span>This exercise is borrowed from Wasserman.
Let <span class="math inline">\(X\)</span> have a continuous, strictly increasing CDF <span class="math inline">\(F\)</span>. Let <span class="math inline">\(Y = F(X)\)</span>.</p>
<ol style="list-style-type: lower-alpha">
<li><p>Find the density of <span class="math inline">\(Y\)</span>. This is called the probability integral transform.</p></li>
<li><p>Let <span class="math inline">\(U \sim \text{Uniform}(0,1)\)</span> and let <span class="math inline">\(X = F^{-1}(U)\)</span>. Show that
<span class="math inline">\(X \sim F\)</span>.</p></li>
<li><p><span style="color:blue">R: Implement a program that takes Uniform(0,1)
random variables
and generates random variables from an exponential(<span class="math inline">\(\beta\)</span>) distribution.
Compare your implemented function with function <em>rexp</em> in R.</span></p></li>
</ol>
</div>

<div class="fold">

<div class="solution">
<p> <span class="solution"><em>Solution. </em></span> </p>
<ol style="list-style-type: lower-alpha">
<li><p><span class="math display">\[\begin{align}
F_Y(y) &amp;= P(Y &lt; y) \\
       &amp;= P(F(X) &lt; y) \\
       &amp;= P(X &lt; F_X^{-1}(y)) \\
       &amp;= F_X(F_X^{-1}(y)) \\
       &amp;= y.
\end{align}\]</span>
From the above it follows that <span class="math inline">\(p(y) = 1\)</span>. Note that we need to know the
inverse CDF to be able to apply this procedure.</p></li>
<li><p><span class="math display">\[\begin{align}
P(X &lt; x) &amp;= P(F^{-1}(U) &lt; x) \\
         &amp;= P(U &lt; F(x)) \\
         &amp;= F_U(F(x)) \\
         &amp;= F(x).
\end{align}\]</span></p></li>
</ol>
</div>
<pre class="sourceCode r"><code class="sourceCode r"><span class="kw">set.seed</span>(<span class="dv">1</span>)
nsamps &lt;-<span class="st"> </span><span class="dv">10000</span>
beta   &lt;-<span class="st"> </span><span class="dv">4</span>
generate_exp &lt;-<span class="st"> </span><span class="cf">function</span> (n, beta) {
  tmp &lt;-<span class="st"> </span><span class="kw">runif</span>(n)
  X   &lt;-<span class="st"> </span><span class="kw">qexp</span>(tmp, beta)
  <span class="kw">return</span> (X)
}
df &lt;-<span class="st"> </span><span class="kw">tibble</span>(<span class="st">&quot;R&quot;</span>           =<span class="st"> </span><span class="kw">rexp</span>(nsamps, beta), 
             <span class="st">&quot;myGenerator&quot;</span> =<span class="st"> </span><span class="kw">generate_exp</span>(nsamps, beta)) <span class="op">%&gt;%</span>
<span class="st">  </span><span class="kw">gather</span>()
<span class="kw">ggplot</span>(<span class="dt">data =</span> df, <span class="kw">aes</span>(<span class="dt">x =</span> value, <span class="dt">fill =</span> key)) <span class="op">+</span>
<span class="st">  </span><span class="kw">geom_histogram</span>(<span class="dt">position =</span> <span class="st">&quot;dodge&quot;</span>)</code></pre>
<p><img src="bookdown-pou_files/figure-html/unnamed-chunk-114-1.png" width="672" /></p>
</div>

</div>
</div>



</div>
            </section>

          </div>
        </div>
      </div>
<a href="condprob.html" class="navigation navigation-prev " aria-label="Previous page"><i class="fa fa-angle-left"></i></a>
<a href="A1.html" class="navigation navigation-next " aria-label="Next page"><i class="fa fa-angle-right"></i></a>
    </div>
  </div>
<script src="libs/gitbook-2.6.7/js/app.min.js"></script>
<script src="libs/gitbook-2.6.7/js/lunr.js"></script>
<script src="libs/gitbook-2.6.7/js/plugin-search.js"></script>
<script src="libs/gitbook-2.6.7/js/plugin-sharing.js"></script>
<script src="libs/gitbook-2.6.7/js/plugin-fontsettings.js"></script>
<script src="libs/gitbook-2.6.7/js/plugin-bookdown.js"></script>
<script src="libs/gitbook-2.6.7/js/jquery.highlight.js"></script>
<script>
gitbook.require(["gitbook"], function(gitbook) {
gitbook.start({
"sharing": {
"github": false,
"facebook": true,
"twitter": true,
"google": false,
"linkedin": false,
"weibo": false,
"instapaper": false,
"vk": false,
"all": ["facebook", "google", "twitter", "linkedin", "weibo", "instapaper"]
},
"fontsettings": {
"theme": "white",
"family": "sans",
"size": 2
},
"edit": {
"link": null,
"text": null
},
"history": {
"link": null,
"text": null
},
"download": null,
"toc": {
"collapse": "subsection"
}
});
});
</script>

<!-- dynamically load mathjax for compatibility with self-contained -->
<script>
  (function () {
    var script = document.createElement("script");
    script.type = "text/javascript";
    var src = "true";
    if (src === "" || src === "true") src = "https://mathjax.rstudio.com/latest/MathJax.js?config=TeX-MML-AM_CHTML";
    if (location.protocol !== "file:" && /^https?:/.test(src))
      src = src.replace(/^https?:/, '');
    script.src = src;
    document.getElementsByTagName("head")[0].appendChild(script);
  })();
</script>
</body>

</html>
