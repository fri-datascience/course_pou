<!DOCTYPE html>
<html xmlns="http://www.w3.org/1999/xhtml" lang="" xml:lang="">
<head>

  <meta charset="utf-8" />
  <meta http-equiv="X-UA-Compatible" content="IE=edge" />
  <title>Chapter 14 Bootstrap | Principles of Uncertainty – exercises</title>
  <meta name="description" content="Course notes" />
  <meta name="generator" content="bookdown 0.16 and GitBook 2.6.7" />

  <meta property="og:title" content="Chapter 14 Bootstrap | Principles of Uncertainty – exercises" />
  <meta property="og:type" content="book" />
  <meta property="og:url" content="https://fri-datascience.github.io/course_pou/" />
  
  <meta property="og:description" content="Course notes" />
  

  <meta name="twitter:card" content="summary" />
  <meta name="twitter:title" content="Chapter 14 Bootstrap | Principles of Uncertainty – exercises" />
  
  <meta name="twitter:description" content="Course notes" />
  

<meta name="author" content="Gregor Pirš and Erik Štrumbelj" />


<meta name="date" content="2020-01-06" />

  <meta name="viewport" content="width=device-width, initial-scale=1" />
  <meta name="apple-mobile-web-app-capable" content="yes" />
  <meta name="apple-mobile-web-app-status-bar-style" content="black" />
  
  
<link rel="prev" href="eb.html"/>
<link rel="next" href="ml.html"/>
<script src="libs/jquery-2.2.3/jquery.min.js"></script>
<link href="libs/gitbook-2.6.7/css/style.css" rel="stylesheet" />
<link href="libs/gitbook-2.6.7/css/plugin-table.css" rel="stylesheet" />
<link href="libs/gitbook-2.6.7/css/plugin-bookdown.css" rel="stylesheet" />
<link href="libs/gitbook-2.6.7/css/plugin-highlight.css" rel="stylesheet" />
<link href="libs/gitbook-2.6.7/css/plugin-search.css" rel="stylesheet" />
<link href="libs/gitbook-2.6.7/css/plugin-fontsettings.css" rel="stylesheet" />
<link href="libs/gitbook-2.6.7/css/plugin-clipboard.css" rel="stylesheet" />











<style type="text/css">
a.sourceLine { display: inline-block; line-height: 1.25; }
a.sourceLine { pointer-events: none; color: inherit; text-decoration: inherit; }
a.sourceLine:empty { height: 1.2em; }
.sourceCode { overflow: visible; }
code.sourceCode { white-space: pre; position: relative; }
pre.sourceCode { margin: 0; }
@media screen {
div.sourceCode { overflow: auto; }
}
@media print {
code.sourceCode { white-space: pre-wrap; }
a.sourceLine { text-indent: -1em; padding-left: 1em; }
}
pre.numberSource a.sourceLine
  { position: relative; left: -4em; }
pre.numberSource a.sourceLine::before
  { content: attr(title);
    position: relative; left: -1em; text-align: right; vertical-align: baseline;
    border: none; pointer-events: all; display: inline-block;
    -webkit-touch-callout: none; -webkit-user-select: none;
    -khtml-user-select: none; -moz-user-select: none;
    -ms-user-select: none; user-select: none;
    padding: 0 4px; width: 4em;
    color: #aaaaaa;
  }
pre.numberSource { margin-left: 3em; border-left: 1px solid #aaaaaa;  padding-left: 4px; }
div.sourceCode
  {  }
@media screen {
a.sourceLine::before { text-decoration: underline; }
}
code span.al { color: #ff0000; font-weight: bold; } /* Alert */
code span.an { color: #60a0b0; font-weight: bold; font-style: italic; } /* Annotation */
code span.at { color: #7d9029; } /* Attribute */
code span.bn { color: #40a070; } /* BaseN */
code span.bu { } /* BuiltIn */
code span.cf { color: #007020; font-weight: bold; } /* ControlFlow */
code span.ch { color: #4070a0; } /* Char */
code span.cn { color: #880000; } /* Constant */
code span.co { color: #60a0b0; font-style: italic; } /* Comment */
code span.cv { color: #60a0b0; font-weight: bold; font-style: italic; } /* CommentVar */
code span.do { color: #ba2121; font-style: italic; } /* Documentation */
code span.dt { color: #902000; } /* DataType */
code span.dv { color: #40a070; } /* DecVal */
code span.er { color: #ff0000; font-weight: bold; } /* Error */
code span.ex { } /* Extension */
code span.fl { color: #40a070; } /* Float */
code span.fu { color: #06287e; } /* Function */
code span.im { } /* Import */
code span.in { color: #60a0b0; font-weight: bold; font-style: italic; } /* Information */
code span.kw { color: #007020; font-weight: bold; } /* Keyword */
code span.op { color: #666666; } /* Operator */
code span.ot { color: #007020; } /* Other */
code span.pp { color: #bc7a00; } /* Preprocessor */
code span.sc { color: #4070a0; } /* SpecialChar */
code span.ss { color: #bb6688; } /* SpecialString */
code span.st { color: #4070a0; } /* String */
code span.va { color: #19177c; } /* Variable */
code span.vs { color: #4070a0; } /* VerbatimString */
code span.wa { color: #60a0b0; font-weight: bold; font-style: italic; } /* Warning */
</style>

<link rel="stylesheet" href="style.css" type="text/css" />
</head>

<body>



  <div class="book without-animation with-summary font-size-2 font-family-1" data-basepath=".">

    <div class="book-summary">
      <nav role="navigation">

<ul class="summary">
<li><a href="./">Principles of uncertainty</a></li>

<li class="divider"></li>
<li class="chapter" data-level="" data-path="index.html"><a href="index.html"><i class="fa fa-check"></i>Preface</a></li>
<li class="chapter" data-level="1" data-path="introduction.html"><a href="introduction.html"><i class="fa fa-check"></i><b>1</b> Probability spaces</a><ul>
<li class="chapter" data-level="1.1" data-path="introduction.html"><a href="introduction.html#measure-and-probability-spaces"><i class="fa fa-check"></i><b>1.1</b> Measure and probability spaces</a></li>
<li class="chapter" data-level="1.2" data-path="introduction.html"><a href="introduction.html#properties-of-probability-measures"><i class="fa fa-check"></i><b>1.2</b> Properties of probability measures</a></li>
<li class="chapter" data-level="1.3" data-path="introduction.html"><a href="introduction.html#discrete-probability-spaces"><i class="fa fa-check"></i><b>1.3</b> Discrete probability spaces</a></li>
</ul></li>
<li class="chapter" data-level="2" data-path="uprobspaces.html"><a href="uprobspaces.html"><i class="fa fa-check"></i><b>2</b> Uncountable probability spaces</a><ul>
<li class="chapter" data-level="2.1" data-path="uprobspaces.html"><a href="uprobspaces.html#bset"><i class="fa fa-check"></i><b>2.1</b> Borel sets</a></li>
<li class="chapter" data-level="2.2" data-path="uprobspaces.html"><a href="uprobspaces.html#lebesgue-measure"><i class="fa fa-check"></i><b>2.2</b> Lebesgue measure</a></li>
</ul></li>
<li class="chapter" data-level="3" data-path="condprob.html"><a href="condprob.html"><i class="fa fa-check"></i><b>3</b> Conditional probability</a><ul>
<li class="chapter" data-level="3.1" data-path="condprob.html"><a href="condprob.html#calculating-conditional-probabilities"><i class="fa fa-check"></i><b>3.1</b> Calculating conditional probabilities</a></li>
<li class="chapter" data-level="3.2" data-path="condprob.html"><a href="condprob.html#conditional-independence"><i class="fa fa-check"></i><b>3.2</b> Conditional independence</a></li>
<li class="chapter" data-level="3.3" data-path="condprob.html"><a href="condprob.html#monty-hall-problem"><i class="fa fa-check"></i><b>3.3</b> Monty Hall problem</a></li>
</ul></li>
<li class="chapter" data-level="4" data-path="rvs.html"><a href="rvs.html"><i class="fa fa-check"></i><b>4</b> Random variables</a><ul>
<li class="chapter" data-level="4.1" data-path="rvs.html"><a href="rvs.html#general-properties-and-calculations"><i class="fa fa-check"></i><b>4.1</b> General properties and calculations</a></li>
<li class="chapter" data-level="4.2" data-path="rvs.html"><a href="rvs.html#discrete-random-variables"><i class="fa fa-check"></i><b>4.2</b> Discrete random variables</a></li>
<li class="chapter" data-level="4.3" data-path="rvs.html"><a href="rvs.html#continuous-random-variables"><i class="fa fa-check"></i><b>4.3</b> Continuous random variables</a></li>
<li class="chapter" data-level="4.4" data-path="rvs.html"><a href="rvs.html#singular-random-variables"><i class="fa fa-check"></i><b>4.4</b> Singular random variables</a></li>
<li class="chapter" data-level="4.5" data-path="rvs.html"><a href="rvs.html#transformations"><i class="fa fa-check"></i><b>4.5</b> Transformations</a></li>
</ul></li>
<li class="chapter" data-level="5" data-path="mrvs.html"><a href="mrvs.html"><i class="fa fa-check"></i><b>5</b> Multiple random variables</a><ul>
<li class="chapter" data-level="5.1" data-path="mrvs.html"><a href="mrvs.html#general"><i class="fa fa-check"></i><b>5.1</b> General</a></li>
<li class="chapter" data-level="5.2" data-path="mrvs.html"><a href="mrvs.html#bivariate-distribution-examples"><i class="fa fa-check"></i><b>5.2</b> Bivariate distribution examples</a></li>
<li class="chapter" data-level="5.3" data-path="mrvs.html"><a href="mrvs.html#transformations-1"><i class="fa fa-check"></i><b>5.3</b> Transformations</a></li>
</ul></li>
<li class="chapter" data-level="6" data-path="integ.html"><a href="integ.html"><i class="fa fa-check"></i><b>6</b> Integration</a><ul>
<li class="chapter" data-level="6.1" data-path="integ.html"><a href="integ.html#monte-carlo-integration"><i class="fa fa-check"></i><b>6.1</b> Monte Carlo integration</a></li>
<li class="chapter" data-level="6.2" data-path="integ.html"><a href="integ.html#lebesgue-integrals"><i class="fa fa-check"></i><b>6.2</b> Lebesgue integrals</a></li>
</ul></li>
<li class="chapter" data-level="7" data-path="ev.html"><a href="ev.html"><i class="fa fa-check"></i><b>7</b> Expected value</a><ul>
<li class="chapter" data-level="7.1" data-path="ev.html"><a href="ev.html#discrete-random-variables-1"><i class="fa fa-check"></i><b>7.1</b> Discrete random variables</a></li>
<li class="chapter" data-level="7.2" data-path="ev.html"><a href="ev.html#continuous-random-variables-1"><i class="fa fa-check"></i><b>7.2</b> Continuous random variables</a></li>
<li class="chapter" data-level="7.3" data-path="ev.html"><a href="ev.html#sums-functions-conditional-expectations"><i class="fa fa-check"></i><b>7.3</b> Sums, functions, conditional expectations</a></li>
<li class="chapter" data-level="7.4" data-path="ev.html"><a href="ev.html#covariance"><i class="fa fa-check"></i><b>7.4</b> Covariance</a></li>
</ul></li>
<li class="chapter" data-level="8" data-path="mrv.html"><a href="mrv.html"><i class="fa fa-check"></i><b>8</b> Multivariate random variables</a><ul>
<li class="chapter" data-level="8.1" data-path="mrv.html"><a href="mrv.html#multinomial-random-variables"><i class="fa fa-check"></i><b>8.1</b> Multinomial random variables</a></li>
<li class="chapter" data-level="8.2" data-path="mrv.html"><a href="mrv.html#multivariate-normal-random-variables"><i class="fa fa-check"></i><b>8.2</b> Multivariate normal random variables</a></li>
<li class="chapter" data-level="8.3" data-path="mrv.html"><a href="mrv.html#transformations-2"><i class="fa fa-check"></i><b>8.3</b> Transformations</a></li>
</ul></li>
<li class="chapter" data-level="9" data-path="ard.html"><a href="ard.html"><i class="fa fa-check"></i><b>9</b> Alternative representation of distributions</a><ul>
<li class="chapter" data-level="9.1" data-path="ard.html"><a href="ard.html#probability-generating-functions-pgfs"><i class="fa fa-check"></i><b>9.1</b> Probability generating functions (PGFs)</a></li>
<li class="chapter" data-level="9.2" data-path="ard.html"><a href="ard.html#moment-generating-functions-mgfs"><i class="fa fa-check"></i><b>9.2</b> Moment generating functions (MGFs)</a></li>
</ul></li>
<li class="chapter" data-level="10" data-path="ci.html"><a href="ci.html"><i class="fa fa-check"></i><b>10</b> Concentration inequalities</a><ul>
<li class="chapter" data-level="10.1" data-path="ci.html"><a href="ci.html#comparison"><i class="fa fa-check"></i><b>10.1</b> Comparison</a></li>
<li class="chapter" data-level="10.2" data-path="ci.html"><a href="ci.html#practical"><i class="fa fa-check"></i><b>10.2</b> Practical</a></li>
</ul></li>
<li class="chapter" data-level="11" data-path="crv.html"><a href="crv.html"><i class="fa fa-check"></i><b>11</b> Convergence of random variables</a></li>
<li class="chapter" data-level="12" data-path="lt.html"><a href="lt.html"><i class="fa fa-check"></i><b>12</b> Limit theorems</a></li>
<li class="chapter" data-level="13" data-path="eb.html"><a href="eb.html"><i class="fa fa-check"></i><b>13</b> Estimation basics</a><ul>
<li class="chapter" data-level="13.1" data-path="eb.html"><a href="eb.html#ecdf"><i class="fa fa-check"></i><b>13.1</b> ECDF</a></li>
<li class="chapter" data-level="13.2" data-path="eb.html"><a href="eb.html#properties-of-estimators"><i class="fa fa-check"></i><b>13.2</b> Properties of estimators</a></li>
</ul></li>
<li class="chapter" data-level="14" data-path="boot.html"><a href="boot.html"><i class="fa fa-check"></i><b>14</b> Bootstrap</a></li>
<li class="chapter" data-level="15" data-path="ml.html"><a href="ml.html"><i class="fa fa-check"></i><b>15</b> Maximum likelihood</a><ul>
<li class="chapter" data-level="15.1" data-path="ml.html"><a href="ml.html#deriving-mle"><i class="fa fa-check"></i><b>15.1</b> Deriving MLE</a></li>
<li class="chapter" data-level="15.2" data-path="ml.html"><a href="ml.html#fisher-information"><i class="fa fa-check"></i><b>15.2</b> Fisher information</a></li>
<li class="chapter" data-level="15.3" data-path="ml.html"><a href="ml.html#the-german-tank-problem"><i class="fa fa-check"></i><b>15.3</b> The German tank problem</a></li>
</ul></li>
<li class="appendix"><span><b>Appendix</b></span></li>
<li class="chapter" data-level="A" data-path="A1.html"><a href="A1.html"><i class="fa fa-check"></i><b>A</b> R programming language</a><ul>
<li class="chapter" data-level="A.1" data-path="A1.html"><a href="A1.html#basic-characteristics"><i class="fa fa-check"></i><b>A.1</b> Basic characteristics</a></li>
<li class="chapter" data-level="A.2" data-path="A1.html"><a href="A1.html#why-r"><i class="fa fa-check"></i><b>A.2</b> Why R?</a></li>
<li class="chapter" data-level="A.3" data-path="A1.html"><a href="A1.html#setting-up"><i class="fa fa-check"></i><b>A.3</b> Setting up</a><ul>
<li class="chapter" data-level="A.3.1" data-path="A1.html"><a href="A1.html#rstudio"><i class="fa fa-check"></i><b>A.3.1</b> RStudio</a></li>
<li class="chapter" data-level="A.3.2" data-path="A1.html"><a href="A1.html#libraries-for-data-science"><i class="fa fa-check"></i><b>A.3.2</b> Libraries for data science</a></li>
</ul></li>
<li class="chapter" data-level="A.4" data-path="A1.html"><a href="A1.html#r-basics"><i class="fa fa-check"></i><b>A.4</b> R basics</a><ul>
<li class="chapter" data-level="A.4.1" data-path="A1.html"><a href="A1.html#variables-and-types"><i class="fa fa-check"></i><b>A.4.1</b> Variables and types</a></li>
<li class="chapter" data-level="A.4.2" data-path="A1.html"><a href="A1.html#basic-operations"><i class="fa fa-check"></i><b>A.4.2</b> Basic operations</a></li>
<li class="chapter" data-level="A.4.3" data-path="A1.html"><a href="A1.html#vectors"><i class="fa fa-check"></i><b>A.4.3</b> Vectors</a></li>
<li class="chapter" data-level="A.4.4" data-path="A1.html"><a href="A1.html#factors"><i class="fa fa-check"></i><b>A.4.4</b> Factors</a></li>
<li class="chapter" data-level="A.4.5" data-path="A1.html"><a href="A1.html#matrices"><i class="fa fa-check"></i><b>A.4.5</b> Matrices</a></li>
<li class="chapter" data-level="A.4.6" data-path="A1.html"><a href="A1.html#arrays"><i class="fa fa-check"></i><b>A.4.6</b> Arrays</a></li>
<li class="chapter" data-level="A.4.7" data-path="A1.html"><a href="A1.html#data-frames"><i class="fa fa-check"></i><b>A.4.7</b> Data frames</a></li>
<li class="chapter" data-level="A.4.8" data-path="A1.html"><a href="A1.html#lists"><i class="fa fa-check"></i><b>A.4.8</b> Lists</a></li>
<li class="chapter" data-level="A.4.9" data-path="A1.html"><a href="A1.html#loops"><i class="fa fa-check"></i><b>A.4.9</b> Loops</a></li>
</ul></li>
<li class="chapter" data-level="A.5" data-path="A1.html"><a href="A1.html#functions"><i class="fa fa-check"></i><b>A.5</b> Functions</a><ul>
<li class="chapter" data-level="A.5.1" data-path="A1.html"><a href="A1.html#writing-functions"><i class="fa fa-check"></i><b>A.5.1</b> Writing functions</a></li>
</ul></li>
<li class="chapter" data-level="A.6" data-path="A1.html"><a href="A1.html#other-tips"><i class="fa fa-check"></i><b>A.6</b> Other tips</a></li>
<li class="chapter" data-level="A.7" data-path="A1.html"><a href="A1.html#further-reading-and-references"><i class="fa fa-check"></i><b>A.7</b> Further reading and references</a></li>
</ul></li>
<li class="chapter" data-level="B" data-path="probability-distributions.html"><a href="probability-distributions.html"><i class="fa fa-check"></i><b>B</b> Probability distributions</a></li>
<li class="chapter" data-level="" data-path="references.html"><a href="references.html"><i class="fa fa-check"></i>References</a></li>
<li class="divider"></li>
<li><a href="https://github.com/rstudio/bookdown" target="blank">Published with bookdown</a></li>      
</ul>

      </nav>
    </div>

    <div class="book-body">
      <div class="body-inner">
        <div class="book-header" role="navigation">
          <h1>
            <i class="fa fa-circle-o-notch fa-spin"></i><a href="./">Principles of Uncertainty – exercises</a>
          </h1>
        </div>

        <div class="page-wrapper" tabindex="-1" role="main">
          <div class="page-inner">

            <section class="normal" id="section-">
<div id="boot" class="section level1">
<h1><span class="header-section-number">Chapter 14</span> Bootstrap</h1>
<p>This chapter deals with bootstrap.</p>
<p>The students are expected to acquire the following knowledge:</p>
<ul>
<li>How to use bootstrap to generate coverage intervals.</li>
</ul>
<style>
.fold-btn { 
  float: right; 
  margin: 5px 5px 0 0;
}
.fold { 
  border: 1px solid black;
  min-height: 40px;
}
</style>
<script type="text/javascript">
$(document).ready(function() {
  $folds = $(".fold");
  $folds.wrapInner("<div class=\"fold-blck\">"); // wrap a div container around content
  $folds.prepend("<button class=\"fold-btn\">Unfold</button>");  // add a button
  $(".fold-blck").toggle();  // fold all blocks
  $(".fold-btn").on("click", function() {  // add onClick event
    $(this).text($(this).text() === "Fold" ? "Unfold" : "Fold");  // if the text equals "Fold", change it to "Unfold"or else to "Fold" 
    $(this).next(".fold-blck").toggle("linear");  // "swing" is the default easing function. This can be further customized in its speed or the overall animation itself.
  })
});
</script>

<div class="exercise">
<p><span id="exr:unnamed-chunk-220" class="exercise"><strong>Exercise 14.1  </strong></span>
Ideally, a <span class="math inline">\(1-\alpha\)</span> CI would have <span class="math inline">\(1-\alpha\)</span> coverage. That is, say a 95% CI should, in the long run, contain the true value of the parameter 95% of the time. In practice, it is impossible to assess the coverage of our CI method, because we rarely know the true parameter. In simulation, however, we can. Let’s assess the coverage of bootstrap percentile intervals.</p>
<ol style="list-style-type: lower-alpha">
<li><p>Pick a univariate distribution with readily available mean and one that you can easily sample from.</p></li>
<li><p>Draw <span class="math inline">\(n = 30\)</span> random samples from the chosen distribution and use the bootstrap (with large enough m) and percentile CI method to construct 95% CI. Repeat the process many times and count how many times the CI contains the true mean. That is, compute the actual coverage probability (don’t forget to include the standard error of the coverage probability!). What can you observe?</p></li>
<li><p>Try one or two different distributions. What can you observe?</p></li>
<li><p>Repeat (b) and (c) using BCa intervals (R package boot). How does the coverage compare to percentile intervals?</p></li>
</ol>
</div>

<div class="fold">
<div class="sourceCode" id="cb183"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb183-1"><a href="boot.html#cb183-1"></a><span class="kw">library</span>(boot)</span>
<span id="cb183-2"><a href="boot.html#cb183-2"></a><span class="kw">set.seed</span>(<span class="dv">1</span>)</span>
<span id="cb183-3"><a href="boot.html#cb183-3"></a>nit   &lt;-<span class="st"> </span><span class="dv">1000</span></span>
<span id="cb183-4"><a href="boot.html#cb183-4"></a>alpha &lt;-<span class="st"> </span><span class="fl">0.05</span></span>
<span id="cb183-5"><a href="boot.html#cb183-5"></a>nboot &lt;-<span class="st"> </span><span class="dv">100</span></span>
<span id="cb183-6"><a href="boot.html#cb183-6"></a>covers     &lt;-<span class="st"> </span><span class="kw">matrix</span>(<span class="dt">nrow =</span> nit, <span class="dt">ncol =</span> <span class="dv">3</span>)</span>
<span id="cb183-7"><a href="boot.html#cb183-7"></a>covers_BCa &lt;-<span class="st"> </span><span class="kw">matrix</span>(<span class="dt">nrow =</span> nit, <span class="dt">ncol =</span> <span class="dv">3</span>)</span>
<span id="cb183-8"><a href="boot.html#cb183-8"></a><span class="cf">for</span> (j <span class="cf">in</span> <span class="dv">1</span><span class="op">:</span>nit) {</span>
<span id="cb183-9"><a href="boot.html#cb183-9"></a>  x1 &lt;-<span class="st"> </span><span class="kw">rnorm</span>(<span class="dv">30</span>)</span>
<span id="cb183-10"><a href="boot.html#cb183-10"></a>  x2 &lt;-<span class="st"> </span><span class="kw">rbeta</span>(<span class="dv">30</span>, <span class="dv">1</span>, <span class="dv">2</span>)</span>
<span id="cb183-11"><a href="boot.html#cb183-11"></a>  x3 &lt;-<span class="st"> </span><span class="kw">rpois</span>(<span class="dv">30</span>, <span class="dv">5</span>)</span>
<span id="cb183-12"><a href="boot.html#cb183-12"></a>  </span>
<span id="cb183-13"><a href="boot.html#cb183-13"></a>  X1 &lt;-<span class="st"> </span><span class="kw">matrix</span>(<span class="dt">data =</span> <span class="ot">NA</span>, <span class="dt">nrow =</span> <span class="dv">30</span>, <span class="dt">ncol =</span> nboot)</span>
<span id="cb183-14"><a href="boot.html#cb183-14"></a>  X2 &lt;-<span class="st"> </span><span class="kw">matrix</span>(<span class="dt">data =</span> <span class="ot">NA</span>, <span class="dt">nrow =</span> <span class="dv">30</span>, <span class="dt">ncol =</span> nboot)</span>
<span id="cb183-15"><a href="boot.html#cb183-15"></a>  X3 &lt;-<span class="st"> </span><span class="kw">matrix</span>(<span class="dt">data =</span> <span class="ot">NA</span>, <span class="dt">nrow =</span> <span class="dv">30</span>, <span class="dt">ncol =</span> nboot)</span>
<span id="cb183-16"><a href="boot.html#cb183-16"></a>  <span class="cf">for</span> (i <span class="cf">in</span> <span class="dv">1</span><span class="op">:</span>nboot) {</span>
<span id="cb183-17"><a href="boot.html#cb183-17"></a>    X1[ ,i] &lt;-<span class="st"> </span><span class="kw">sample</span>(x1, <span class="dv">30</span>, <span class="dt">replace =</span> T)</span>
<span id="cb183-18"><a href="boot.html#cb183-18"></a>    X2[ ,i] &lt;-<span class="st"> </span><span class="kw">sample</span>(x2, <span class="dv">30</span>, T)</span>
<span id="cb183-19"><a href="boot.html#cb183-19"></a>    X3[ ,i] &lt;-<span class="st"> </span><span class="kw">sample</span>(x3, <span class="dv">30</span>, T)</span>
<span id="cb183-20"><a href="boot.html#cb183-20"></a>  }</span>
<span id="cb183-21"><a href="boot.html#cb183-21"></a>  X1_func &lt;-<span class="st"> </span><span class="kw">apply</span>(X1, <span class="dv">2</span>, mean)</span>
<span id="cb183-22"><a href="boot.html#cb183-22"></a>  X2_func &lt;-<span class="st"> </span><span class="kw">apply</span>(X2, <span class="dv">2</span>, mean)</span>
<span id="cb183-23"><a href="boot.html#cb183-23"></a>  X3_func &lt;-<span class="st"> </span><span class="kw">apply</span>(X3, <span class="dv">2</span>, mean)</span>
<span id="cb183-24"><a href="boot.html#cb183-24"></a>  X1_quant &lt;-<span class="st"> </span><span class="kw">quantile</span>(X1_func, <span class="dt">probs =</span> <span class="kw">c</span>(alpha <span class="op">/</span><span class="st"> </span><span class="dv">2</span>, <span class="dv">1</span> <span class="op">-</span><span class="st"> </span>alpha <span class="op">/</span><span class="st"> </span><span class="dv">2</span>))</span>
<span id="cb183-25"><a href="boot.html#cb183-25"></a>  X2_quant &lt;-<span class="st"> </span><span class="kw">quantile</span>(X2_func, <span class="dt">probs =</span> <span class="kw">c</span>(alpha <span class="op">/</span><span class="st"> </span><span class="dv">2</span>, <span class="dv">1</span> <span class="op">-</span><span class="st"> </span>alpha <span class="op">/</span><span class="st"> </span><span class="dv">2</span>))</span>
<span id="cb183-26"><a href="boot.html#cb183-26"></a>  X3_quant &lt;-<span class="st"> </span><span class="kw">quantile</span>(X3_func, <span class="dt">probs =</span> <span class="kw">c</span>(alpha <span class="op">/</span><span class="st"> </span><span class="dv">2</span>, <span class="dv">1</span> <span class="op">-</span><span class="st"> </span>alpha <span class="op">/</span><span class="st"> </span><span class="dv">2</span>))</span>
<span id="cb183-27"><a href="boot.html#cb183-27"></a>  covers[j,<span class="dv">1</span>] &lt;-<span class="st"> </span>(<span class="dv">0</span> <span class="op">&gt;</span><span class="st"> </span>X1_quant[<span class="dv">1</span>]) <span class="op">&amp;</span><span class="st"> </span>(<span class="dv">0</span> <span class="op">&lt;</span><span class="st"> </span>X1_quant[<span class="dv">2</span>])</span>
<span id="cb183-28"><a href="boot.html#cb183-28"></a>  covers[j,<span class="dv">2</span>] &lt;-<span class="st"> </span>((<span class="dv">1</span> <span class="op">/</span><span class="st"> </span><span class="dv">3</span>) <span class="op">&gt;</span><span class="st"> </span>X2_quant[<span class="dv">1</span>]) <span class="op">&amp;</span><span class="st"> </span>((<span class="dv">1</span> <span class="op">/</span><span class="st"> </span><span class="dv">3</span>) <span class="op">&lt;</span><span class="st"> </span>X2_quant[<span class="dv">2</span>])</span>
<span id="cb183-29"><a href="boot.html#cb183-29"></a>  covers[j,<span class="dv">3</span>] &lt;-<span class="st"> </span>(<span class="dv">5</span> <span class="op">&gt;</span><span class="st"> </span>X3_quant[<span class="dv">1</span>]) <span class="op">&amp;</span><span class="st"> </span>(<span class="dv">5</span> <span class="op">&lt;</span><span class="st"> </span>X3_quant[<span class="dv">2</span>])</span>
<span id="cb183-30"><a href="boot.html#cb183-30"></a></span>
<span id="cb183-31"><a href="boot.html#cb183-31"></a>  mf     &lt;-<span class="st"> </span><span class="cf">function</span> (x, i) <span class="kw">return</span>(<span class="kw">mean</span>(x[i]))</span>
<span id="cb183-32"><a href="boot.html#cb183-32"></a>  bootX1 &lt;-<span class="st"> </span><span class="kw">boot</span>(x1, <span class="dt">statistic =</span> mf, <span class="dt">R =</span> nboot)</span>
<span id="cb183-33"><a href="boot.html#cb183-33"></a>  bootX2 &lt;-<span class="st"> </span><span class="kw">boot</span>(x2, <span class="dt">statistic =</span> mf, <span class="dt">R =</span> nboot)</span>
<span id="cb183-34"><a href="boot.html#cb183-34"></a>  bootX3 &lt;-<span class="st"> </span><span class="kw">boot</span>(x3, <span class="dt">statistic =</span> mf, <span class="dt">R =</span> nboot)</span>
<span id="cb183-35"><a href="boot.html#cb183-35"></a></span>
<span id="cb183-36"><a href="boot.html#cb183-36"></a>  X1_quant_BCa &lt;-<span class="st"> </span><span class="kw">boot.ci</span>(bootX1, <span class="dt">type =</span> <span class="st">&quot;bca&quot;</span>)<span class="op">$</span>bca</span>
<span id="cb183-37"><a href="boot.html#cb183-37"></a>  X2_quant_BCa &lt;-<span class="st"> </span><span class="kw">boot.ci</span>(bootX2, <span class="dt">type =</span> <span class="st">&quot;bca&quot;</span>)<span class="op">$</span>bca</span>
<span id="cb183-38"><a href="boot.html#cb183-38"></a>  X3_quant_BCa &lt;-<span class="st"> </span><span class="kw">boot.ci</span>(bootX3, <span class="dt">type =</span> <span class="st">&quot;bca&quot;</span>)<span class="op">$</span>bca</span>
<span id="cb183-39"><a href="boot.html#cb183-39"></a>  </span>
<span id="cb183-40"><a href="boot.html#cb183-40"></a>  covers_BCa[j,<span class="dv">1</span>] &lt;-<span class="st"> </span>(<span class="dv">0</span> <span class="op">&gt;</span><span class="st"> </span>X1_quant_BCa[<span class="dv">4</span>]) <span class="op">&amp;</span><span class="st"> </span>(<span class="dv">0</span> <span class="op">&lt;</span><span class="st"> </span>X1_quant_BCa[<span class="dv">5</span>])</span>
<span id="cb183-41"><a href="boot.html#cb183-41"></a>  covers_BCa[j,<span class="dv">2</span>] &lt;-<span class="st"> </span>((<span class="dv">1</span> <span class="op">/</span><span class="st"> </span><span class="dv">3</span>) <span class="op">&gt;</span><span class="st"> </span>X2_quant_BCa[<span class="dv">4</span>]) <span class="op">&amp;</span><span class="st"> </span>((<span class="dv">1</span> <span class="op">/</span><span class="st"> </span><span class="dv">3</span>) <span class="op">&lt;</span><span class="st"> </span>X2_quant_BCa[<span class="dv">5</span>])</span>
<span id="cb183-42"><a href="boot.html#cb183-42"></a>  covers_BCa[j,<span class="dv">3</span>] &lt;-<span class="st"> </span>(<span class="dv">5</span> <span class="op">&gt;</span><span class="st"> </span>X3_quant_BCa[<span class="dv">4</span>]) <span class="op">&amp;</span><span class="st"> </span>(<span class="dv">5</span> <span class="op">&lt;</span><span class="st"> </span>X3_quant_BCa[<span class="dv">5</span>])</span>
<span id="cb183-43"><a href="boot.html#cb183-43"></a></span>
<span id="cb183-44"><a href="boot.html#cb183-44"></a>}</span>
<span id="cb183-45"><a href="boot.html#cb183-45"></a><span class="kw">apply</span>(covers, <span class="dv">2</span>, mean)</span></code></pre></div>
<pre><code>## [1] 0.921 0.927 0.904</code></pre>
<div class="sourceCode" id="cb185"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb185-1"><a href="boot.html#cb185-1"></a><span class="kw">apply</span>(covers, <span class="dv">2</span>, sd) <span class="op">/</span><span class="st"> </span><span class="kw">sqrt</span>(nit)</span></code></pre></div>
<pre><code>## [1] 0.008534157 0.008230355 0.009320454</code></pre>
<div class="sourceCode" id="cb187"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb187-1"><a href="boot.html#cb187-1"></a><span class="kw">apply</span>(covers_BCa, <span class="dv">2</span>, mean)</span></code></pre></div>
<pre><code>## [1] 0.928 0.946 0.917</code></pre>
<div class="sourceCode" id="cb189"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb189-1"><a href="boot.html#cb189-1"></a><span class="kw">apply</span>(covers_BCa, <span class="dv">2</span>, sd) <span class="op">/</span><span class="st"> </span><span class="kw">sqrt</span>(nit)</span></code></pre></div>
<pre><code>## [1] 0.008178196 0.007150884 0.008728527</code></pre>
</div>

</div>
            </section>

          </div>
        </div>
      </div>
<a href="eb.html" class="navigation navigation-prev " aria-label="Previous page"><i class="fa fa-angle-left"></i></a>
<a href="ml.html" class="navigation navigation-next " aria-label="Next page"><i class="fa fa-angle-right"></i></a>
    </div>
  </div>
<script src="libs/gitbook-2.6.7/js/app.min.js"></script>
<script src="libs/gitbook-2.6.7/js/lunr.js"></script>
<script src="libs/gitbook-2.6.7/js/clipboard.min.js"></script>
<script src="libs/gitbook-2.6.7/js/plugin-search.js"></script>
<script src="libs/gitbook-2.6.7/js/plugin-sharing.js"></script>
<script src="libs/gitbook-2.6.7/js/plugin-fontsettings.js"></script>
<script src="libs/gitbook-2.6.7/js/plugin-bookdown.js"></script>
<script src="libs/gitbook-2.6.7/js/jquery.highlight.js"></script>
<script src="libs/gitbook-2.6.7/js/plugin-clipboard.js"></script>
<script>
gitbook.require(["gitbook"], function(gitbook) {
gitbook.start({
"sharing": {
"github": false,
"facebook": true,
"twitter": true,
"linkedin": false,
"weibo": false,
"instapaper": false,
"vk": false,
"all": ["facebook", "twitter", "linkedin", "weibo", "instapaper"]
},
"fontsettings": {
"theme": "white",
"family": "sans",
"size": 2
},
"edit": {
"link": null,
"text": null
},
"history": {
"link": null,
"text": null
},
"view": {
"link": null,
"text": null
},
"download": null,
"toc": {
"collapse": "subsection"
}
});
});
</script>

<!-- dynamically load mathjax for compatibility with self-contained -->
<script>
  (function () {
    var script = document.createElement("script");
    script.type = "text/javascript";
    var src = "true";
    if (src === "" || src === "true") src = "https://mathjax.rstudio.com/latest/MathJax.js?config=TeX-MML-AM_CHTML";
    if (location.protocol !== "file:")
      if (/^https?:/.test(src))
        src = src.replace(/^https?:/, '');
    script.src = src;
    document.getElementsByTagName("head")[0].appendChild(script);
  })();
</script>
</body>

</html>
